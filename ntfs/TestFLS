#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /home/scudette/projects/rekall-test/ntfs/output/TestFLS /home/scudette/projects/rekall-test/ntfs/TestFLS
elif [ "$1" == "meld" ]; then
   meld /home/scudette/projects/rekall-test/ntfs/output/TestFLS /home/scudette/projects/rekall-test/ntfs/TestFLS
elif [ "$1" == "diff" ]; then
   diff /home/scudette/projects/rekall-test/ntfs/output/TestFLS /home/scudette/projects/rekall-test/ntfs/TestFLS
elif [ "$1" == "run" ]; then
   rekall  --profile 'ntfs' --renderer 'test' --filename '/home/scudette/projects/rekall-test/ntfs/ntfs1-gen1.E01' - fls
else
   less /home/scudette/projects/rekall-test/ntfs/output/TestFLS
fi
exit 0
{
    "errors": {}, 
    "time_used": 0.8946840763092041, 
    "return_code": 0, 
    "failures": {
        "testCase (__main__.TestFLS)": "Traceback (most recent call last):\n  File \"/home/scudette/rekall/rekall/testlib.py\", line 227, in run\n    testMethod()\n  File \"/home/scudette/rekall/rekall/testlib.py\", line 277, in testCase\n    self.assertEqual(previous, current)\nAssertionError: u' MFT || Seq ||         Created         ||        File Mod         ||         M [truncated]... != u'   MFT    || Seq ||         Created         ||        File Mod         ||      [truncated]...\n-  MFT || Seq ||         Created         ||        File Mod         ||         MFT Mod         ||         Access          ||   Size   ||Filename\n+    MFT    || Seq ||         Created         ||        File Mod         ||         MFT Mod         ||         Access          ||   Size   ||Filename\n? ++     +++\n\n"
    }, 
    "output": [
        "   MFT    || Seq ||         Created         ||        File Mod         ||         MFT Mod         ||         Access          ||   Size   ||Filename", 
        "----------||-----||-------------------------||-------------------------||-------------------------||-------------------------||----------||--------", 
        "         4||    4||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||     36000||$AttrDef", 
        "         8||    8||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||         0||$BadClus", 
        "         6||    6||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||    126112||$Bitmap ", 
        "         7||    7||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||      8192||$Boot   ", 
        "        11||   11||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||         0||$Extend ", 
        "         2||    2||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||   4685824||$LogFile", 
        "         0||    1||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||     16384||$MFT    ", 
        "         1||    1||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||      4096||$MFTMirr", 
        "         9||    9||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||         0||$Secure ", 
        "        10||   10||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||    131072||$UpCase ", 
        "         3||    3||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||2008-12-31 22:44:02+0000 ||         0||$Volume ", 
        "         5||    5||2008-12-31 22:44:02+0000 ||2008-12-31 22:45:47+0000 ||2008-12-31 22:45:47+0000 ||2008-12-31 22:45:50+0000 ||         0||.       ", 
        "        28||    1||2008-12-31 22:44:33+0000 ||2008-12-31 23:09:31+0000 ||2008-12-31 23:09:31+0000 ||2008-12-31 23:09:40+0000 ||         0||Compressed", 
        "        28||    1||2008-12-31 22:44:33+0000 ||2008-12-31 23:09:31+0000 ||2008-12-31 23:09:31+0000 ||2008-12-31 23:09:40+0000 ||         0||COMPRE~1", 
        "        29||    1||2008-12-31 22:44:43+0000 ||2008-12-31 23:16:26+0000 ||2008-12-31 23:16:26+0000 ||2008-12-31 23:16:26+0000 ||         0||Encrypted", 
        "        29||    1||2008-12-31 22:44:43+0000 ||2008-12-31 23:16:26+0000 ||2008-12-31 23:16:26+0000 ||2008-12-31 23:16:26+0000 ||         0||ENCRYP~1", 
        "        27||    1||2008-12-31 22:44:17+0000 ||2008-12-31 23:09:38+0000 ||2008-12-31 23:09:38+0000 ||2008-12-31 23:09:46+0000 ||         0||RAW     ", 
        "        30||    1||2008-12-31 22:45:15+0000 ||2008-12-31 22:45:15+0000 ||2008-12-31 22:45:15+0000 ||2008-12-31 22:45:15+0000 ||         0||System Volume Information", 
        "        30||    1||2008-12-31 22:45:15+0000 ||2008-12-31 22:45:15+0000 ||2008-12-31 22:45:15+0000 ||2008-12-31 22:45:15+0000 ||         0||SYSTEM~1"
    ], 
    "options": {
        "executable": "rekall ", 
        "--filename": "/home/scudette/projects/rekall-test/ntfs/ntfs1-gen1.E01", 
        "commandline": "fls", 
        "--renderer": "test", 
        "tempdir": "/tmp/tmpop1vil/TestFLSThread-4", 
        "mfts": "42 40", 
        "test_class": "TestFLS", 
        "executed_command": "rekall  --profile 'ntfs' --renderer 'test' --filename '/home/scudette/projects/rekall-test/ntfs/ntfs1-gen1.E01' - fls", 
        "--profile": "ntfs", 
        "path": "/", 
        "testdir": "/home/scudette/projects/rekall-test/ntfs"
    }
}