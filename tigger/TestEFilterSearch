#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /home/mic/projects/rekall-test/tigger/output/TestEFilterSearch /home/mic/projects/rekall-test/tigger/TestEFilterSearch
elif [ "$1" == "meld" ]; then
   meld /home/mic/projects/rekall-test/tigger/output/TestEFilterSearch /home/mic/projects/rekall-test/tigger/TestEFilterSearch
elif [ "$1" == "diff" ]; then
   diff /home/mic/projects/rekall-test/tigger/output/TestEFilterSearch /home/mic/projects/rekall-test/tigger/TestEFilterSearch
elif [ "$1" == "run" ]; then
   rekall  -v --format 'test' --cache 'memory' --name_resolution_strategies 'Module' 'Symbol' --filename '/home/mic/projects/rekall-test/tigger/tigger.vmem.E01' --cache_dir '/home/mic/projects/rekall-test/tigger/../profile_cache/' - run --run /tmp/tmpqob8x_qo/TestEFilterSearchThread-1/script.py
else
   less /home/mic/projects/rekall-test/tigger/output/TestEFilterSearch
fi
exit 0
{
    "errors": {
        "TestEFilterSearch testCase": {}
    },
    "executed_command": "rekall  -v --format 'test' --cache 'memory' --name_resolution_strategies 'Module' 'Symbol' --filename '/home/mic/projects/rekall-test/tigger/tigger.vmem.E01' --cache_dir '/home/mic/projects/rekall-test/tigger/../profile_cache/' - run --run /tmp/tmpqob8x_qo/TestEFilterSearchThread-1/script.py",
    "failures": {
        "TestEFilterSearch testCase": {
            "TestEFilterSearch testCase": {
                "failure_info": [
                    "--- \n",
                    "+++ \n",
                    "@@ -634,3 +634,112 @@\n",
                    " ||            ||      ||USERPROFILE=C:\\Documents and Settings\\Administrator",
                    " ||            ||      ||- 28:",
                    " ||            ||      ||windir=C:\\WINDOWS",
                    "+---------------",
                    "+Ordered comparison. Should not include 216",
                    "+**********************",
                    "+select _EPROCESS as x from pslist() where x.pid < 216",
                    "+x",
                    "+--------------------------",
                    "+0x810b1660||System||     4",
                    "+---------------",
                    "+Ordered comparison. Should include 216",
                    "+**********************",
                    "+select _EPROCESS as x from pslist() where x.pid <= 216",
                    "+x",
                    "+---------------------------",
                    "+0x810b1660||System||      4",
                    "+0xff25a7e0||alg.exe||   216",
                    "+---------------",
                    "+Ordered comparison. Should not include 216",
                    "+**********************",
                    "+select _EPROCESS as x from pslist() where x.pid > 216",
                    "+x",
                    "+-----------------------------------",
                    "+0xff3667e8||VMwareTray.exe||    432",
                    "+0xff374980||VMwareUser.exe||    452",
                    "+0x80f94588||wuauclt.exe||       468",
                    "+0xff2ab020||smss.exe||          544",
                    "+0xff1ecda0||csrss.exe||         608",
                    "+0xff1ec978||winlogon.exe||      632",
                    "+0xff247020||services.exe||      676",
                    "+0xff255020||lsass.exe||         688",
                    "+0xff27d4d0||wmiprvse.exe||      828",
                    "+0xff218230||vmacthlp.exe||      844",
                    "+0x80ff88d8||svchost.exe||       856",
                    "+0xff364310||wscntfy.exe||       888",
                    "+0xff217560||svchost.exe||       936",
                    "+0x80fbf910||svchost.exe||      1028",
                    "+0xff38b5f8||TPAutoConnect.e||  1084",
                    "+0xff22d558||svchost.exe||      1088",
                    "+0xff203b80||svchost.exe||      1148",
                    "+0xff1d7da0||spoolsv.exe||      1432",
                    "+0xff1b8b28||vmtoolsd.exe||     1668",
                    "+0xff3865d0||explorer.exe||     1724",
                    "+0x80f60da0||wuauclt.exe||      1732",
                    "+0xff1fdc88||VMUpgradeHelper||  1788",
                    "+0xff143b28||TPAutoConnSvc.e||  1968",
                    "+---------------",
                    "+Ordered comparison. Should include 216",
                    "+**********************",
                    "+select _EPROCESS as x from pslist() where x.pid >= 216",
                    "+x",
                    "+-----------------------------------",
                    "+0xff25a7e0||alg.exe||           216",
                    "+0xff3667e8||VMwareTray.exe||    432",
                    "+0xff374980||VMwareUser.exe||    452",
                    "+0x80f94588||wuauclt.exe||       468",
                    "+0xff2ab020||smss.exe||          544",
                    "+0xff1ecda0||csrss.exe||         608",
                    "+0xff1ec978||winlogon.exe||      632",
                    "+0xff247020||services.exe||      676",
                    "+0xff255020||lsass.exe||         688",
                    "+0xff27d4d0||wmiprvse.exe||      828",
                    "+0xff218230||vmacthlp.exe||      844",
                    "+0x80ff88d8||svchost.exe||       856",
                    "+0xff364310||wscntfy.exe||       888",
                    "+0xff217560||svchost.exe||       936",
                    "+0x80fbf910||svchost.exe||      1028",
                    "+0xff38b5f8||TPAutoConnect.e||  1084",
                    "+0xff22d558||svchost.exe||      1088",
                    "+0xff203b80||svchost.exe||      1148",
                    "+0xff1d7da0||spoolsv.exe||      1432",
                    "+0xff1b8b28||vmtoolsd.exe||     1668",
                    "+0xff3865d0||explorer.exe||     1724",
                    "+0x80f60da0||wuauclt.exe||      1732",
                    "+0xff1fdc88||VMUpgradeHelper||  1788",
                    "+0xff143b28||TPAutoConnSvc.e||  1968",
                    "+---------------",
                    "+Ordering on timestamps",
                    "+**********************",
                    "+select * from pslist() where process_create_time < \"2010-08-11 06:07:00Z\"",
                    "+",
                    "+_EPROCESS             ||ppid ||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
                    "+-----------------------------------||-----||------------||------------||----------||------||---------------------||-----------------",
                    "+0xff25a7e0||alg.exe||           216||676  ||7           ||108         ||0         ||False ||2010-08-11 06:06:39Z ||-",
                    "+0xff2ab020||smss.exe||          544||4    ||3           ||21          ||-         ||False ||2010-08-11 06:06:21Z ||-",
                    "+0xff1ecda0||csrss.exe||         608||544  ||10          ||405         ||0         ||False ||2010-08-11 06:06:23Z ||-",
                    "+0xff1ec978||winlogon.exe||      632||544  ||22          ||519         ||0         ||False ||2010-08-11 06:06:23Z ||-",
                    "+0xff247020||services.exe||      676||632  ||16          ||269         ||0         ||False ||2010-08-11 06:06:24Z ||-",
                    "+0xff255020||lsass.exe||         688||632  ||21          ||348         ||0         ||False ||2010-08-11 06:06:24Z ||-",
                    "+0xff218230||vmacthlp.exe||      844||676  ||1           ||24          ||0         ||False ||2010-08-11 06:06:24Z ||-",
                    "+0x80ff88d8||svchost.exe||       856||676  ||18          ||202         ||0         ||False ||2010-08-11 06:06:24Z ||-",
                    "+0xff364310||wscntfy.exe||       888||1028 ||1           ||27          ||0         ||False ||2010-08-11 06:06:49Z ||-",
                    "+0xff217560||svchost.exe||       936||676  ||9           ||270         ||0         ||False ||2010-08-11 06:06:24Z ||-",
                    "+0x80fbf910||svchost.exe||      1028||676  ||88          ||1395        ||0         ||False ||2010-08-11 06:06:24Z ||-",
                    "+0xff38b5f8||TPAutoConnect.e||  1084||1968 ||1           ||61          ||0         ||False ||2010-08-11 06:06:52Z ||-",
                    "+0xff22d558||svchost.exe||      1088||676  ||7           ||80          ||0         ||False ||2010-08-11 06:06:25Z ||-",
                    "+0xff203b80||svchost.exe||      1148||676  ||15          ||210         ||0         ||False ||2010-08-11 06:06:26Z ||-",
                    "+0xff1d7da0||spoolsv.exe||      1432||676  ||14          ||137         ||0         ||False ||2010-08-11 06:06:26Z ||-",
                    "+0xff1b8b28||vmtoolsd.exe||     1668||676  ||5           ||218         ||0         ||False ||2010-08-11 06:06:35Z ||-",
                    "+0xff1fdc88||VMUpgradeHelper||  1788||676  ||5           ||100         ||0         ||False ||2010-08-11 06:06:38Z ||-",
                    "+0xff143b28||TPAutoConnSvc.e||  1968||676  ||5           ||100         ||0         ||False ||2010-08-11 06:06:39Z ||-",
                    "+---------------",
                    "+Intersection with timestamps and fancy times  (only wmiprvse.exe)",
                    "+**********************",
                    "+select * from pslist() where",
                    "+process_create_time > \"14th Aug 2010\" and",
                    "+process_create_time < \"5 years ago\"",
                    "+",
                    "+_EPROCESS            ||ppid||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
                    "+--------------------------------||----||------------||------------||----------||------||---------------------||-----------------",
                    "+0xff27d4d0||wmiprvse.exe||   828||856 ||9           ||214         ||0         ||False ||2010-08-15 19:26:08Z ||-"
                ],
                "msg": "Traceback (most recent call last):\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 302, in run\n    testMethod()\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 366, in testCase\n    self.assertListEqual(sorted(previous), sorted(current))\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 274, in assertListEqual\n    self.assertEqual(len(a), len(b))\nAssertionError: 636 != 745\n"
            }
        }
    },
    "logging": [
        "2017-11-03 17:29:01,543:DEBUG:rekall.1:Logging level set to 10",
        "2017-11-03 17:29:01,544:DEBUG:rekall.1:Running plugin (run) with args (()) kwargs ({'script': \"print 'hello!'\", 'run': '/tmp/tmpqob8x_qo/TestEFilterSearchThread-1/script.py'})",
        "2017-11-03 17:29:01,545:DEBUG:rekall.1:Running plugin (search) with args (('SELECT * FROM pslist() WHERE (\\n  _EPROCESS.pid in [4, 216, 1668]\\n  ) ORDER BY _EPROCESS.pid', None)) kwargs ({})",
        "2017-11-03 17:29:01,547:DEBUG:rekall.1:Voting round with base: None",
        "2017-11-03 17:29:01,547:DEBUG:rekall.1:Trying <class 'rekall.plugins.response.common.APIDummyPhysicalAddressSpace'> ",
        "2017-11-03 17:29:01,548:DEBUG:rekall.1:Failed instantiating APIDummyPhysicalAddressSpace: Instantiation failed for unspecified reason",
        "2017-11-03 17:29:01,548:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ",
        "2017-11-03 17:29:01,548:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Must stack on another address space",
        "2017-11-03 17:29:01,548:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ",
        "2017-11-03 17:29:01,548:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: No base address space provided",
        "2017-11-03 17:29:01,548:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ",
        "2017-11-03 17:29:01,548:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: No base address space provided",
        "2017-11-03 17:29:01,548:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Failed instantiating EWFAddressSpace: No base address space provided",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Must stack on another address space",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Must stack on another address space",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: No base address space provided",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: No base address space provided",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Must stack on another address space",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Must be layered on another address space.",
        "2017-11-03 17:29:01,550:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ",
        "2017-11-03 17:29:01,552:DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Unable to open AFF4 volume: No physical memory categories found.",
        "2017-11-03 17:29:01,552:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ",
        "2017-11-03 17:29:01,552:DEBUG:rekall.1:Succeeded instantiating FileAddressSpace",
        "2017-11-03 17:29:01,552:DEBUG:rekall.1:Voting round with base: FileAddressSpace",
        "2017-11-03 17:29:01,552:DEBUG:rekall.1:Trying <class 'rekall.plugins.response.common.APIDummyPhysicalAddressSpace'> ",
        "2017-11-03 17:29:01,552:DEBUG:rekall.1:Failed instantiating APIDummyPhysicalAddressSpace: Instantiation failed for unspecified reason",
        "2017-11-03 17:29:01,552:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ",
        "2017-11-03 17:29:01,553:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid",
        "2017-11-03 17:29:01,553:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ",
        "2017-11-03 17:29:01,553:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.",
        "2017-11-03 17:29:01,553:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ",
        "2017-11-03 17:29:01,554:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0x9465645",
        "2017-11-03 17:29:01,554:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ",
        "2017-11-03 17:29:01,558:DEBUG:rekall.1:Succeeded instantiating EWFAddressSpace",
        "2017-11-03 17:29:01,559:DEBUG:rekall.1:Voting round with base: EWFAddressSpace",
        "2017-11-03 17:29:01,559:DEBUG:rekall.1:Trying <class 'rekall.plugins.response.common.APIDummyPhysicalAddressSpace'> ",
        "2017-11-03 17:29:01,559:DEBUG:rekall.1:Failed instantiating APIDummyPhysicalAddressSpace: Instantiation failed for unspecified reason",
        "2017-11-03 17:29:01,559:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ",
        "2017-11-03 17:29:01,559:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid",
        "2017-11-03 17:29:01,559:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ",
        "2017-11-03 17:29:01,560:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.",
        "2017-11-03 17:29:01,560:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ",
        "2017-11-03 17:29:01,560:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0xf000ff53",
        "2017-11-03 17:29:01,560:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ",
        "2017-11-03 17:29:01,561:DEBUG:rekall.1:Failed instantiating EWFAddressSpace: EWF signature not present",
        "2017-11-03 17:29:01,561:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ",
        "2017-11-03 17:29:01,561:DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Header signature invalid",
        "2017-11-03 17:29:01,561:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ",
        "2017-11-03 17:29:01,561:DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Header signature invalid",
        "2017-11-03 17:29:01,561:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ",
        "2017-11-03 17:29:01,561:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: Header signature invalid",
        "2017-11-03 17:29:01,561:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ",
        "2017-11-03 17:29:01,561:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: Header signature invalid",
        "2017-11-03 17:29:01,561:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ",
        "2017-11-03 17:29:01,562:DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Header signature invalid",
        "2017-11-03 17:29:01,562:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ",
        "2017-11-03 17:29:01,562:DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Invalid Lime header signature",
        "2017-11-03 17:29:01,562:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ",
        "2017-11-03 17:29:01,562:DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Must stack on another address space",
        "2017-11-03 17:29:01,562:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ",
        "2017-11-03 17:29:01,562:DEBUG:rekall.1:Failed instantiating FileAddressSpace: Must be first Address Space",
        "2017-11-03 17:29:01,562:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.amd64.VTxPagedMemory'> ",
        "2017-11-03 17:29:01,563:DEBUG:rekall.1:Failed instantiating VTxPagedMemory: No more EPTs specified",
        "2017-11-03 17:29:01,563:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.mmap_address_space.MmapFileAddressSpace'> ",
        "2017-11-03 17:29:01,564:DEBUG:rekall.1:Failed instantiating MmapFileAddressSpace: Must be first Address Space",
        "2017-11-03 17:29:01,564:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.GlobalOffsetAddressSpace'> ",
        "2017-11-03 17:29:01,564:DEBUG:rekall.1:Failed instantiating GlobalOffsetAddressSpace: File offset not specified.",
        "2017-11-03 17:29:01,564:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pagefile.PagefilePhysicalAddressSpace'> ",
        "2017-11-03 17:29:01,564:DEBUG:rekall.1:Failed instantiating PagefilePhysicalAddressSpace: Pagefile not specified",
        "2017-11-03 17:29:01,564:INFO:rekall.1:Autodetected physical address space EWFAddressSpace",
        "2017-11-03 17:29:01,564:DEBUG:rekall.1:Will detect profile using these Detectors: nt_index,pe,rsds,windows_kernel_file,linux_index,linux,osx,ntfs,tsk",
        "2017-11-03 17:29:01,564:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-profiles/v1.0/inventory.gz",
        "2017-11-03 17:29:01,571:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/inventory.gz",
        "2017-11-03 17:29:03,138:DEBUG:rekall.1:Opened url https://github.com/google/rekall-profiles/raw/master/v1.0/inventory.gz",
        "2017-11-03 17:29:03,204:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/inventory.gz",
        "2017-11-03 17:29:03,239:DEBUG:rekall.1:Opened url http://profiles.rekall-forensic.com/v1.0/inventory.gz",
        "2017-11-03 17:29:03,300:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/inventory.gz",
        "2017-11-03 17:29:03,300:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/nt/eprocess_index.gz",
        "2017-11-03 17:29:03,312:INFO:rekall.1:Loaded profile nt/eprocess_index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.011924982070922852 sec)",
        "2017-11-03 17:29:03,312:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/nt/index.gz",
        "2017-11-03 17:29:03,366:INFO:rekall.1:Loaded profile nt/index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.05420327186584473 sec)",
        "2017-11-03 17:29:03,367:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/pe.gz",
        "2017-11-03 17:29:03,373:INFO:rekall.1:Loaded profile pe from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.0066454410552978516 sec)",
        "2017-11-03 17:29:03,374:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/Linux/index.gz",
        "2017-11-03 17:29:03,379:INFO:rekall.1:Loaded profile Linux/index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.005469799041748047 sec)",
        "2017-11-03 17:29:03,379:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/OSX/index.gz",
        "2017-11-03 17:29:03,380:INFO:rekall.1:Loaded profile OSX/index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.0004563331604003906 sec)",
        "2017-11-03 17:29:03,380:DEBUG:rekall.1:Trying method pe, offset 0",
        "2017-11-03 17:29:03,381:DEBUG:rekall.1:Trying method windows_kernel_file, offset 0",
        "2017-11-03 17:29:03,381:DEBUG:rekall.1:Trying method rsds, offset 0",
        "2017-11-03 17:29:03,382:DEBUG:rekall.1:Trying method nt_index, offset 0",
        "2017-11-03 17:29:03,382:DEBUG:rekall.1:Trying method linux_index, offset 0",
        "2017-11-03 17:29:03,382:DEBUG:rekall.1:LinuxIndexDetector:DetectFromHit(0) = None",
        "2017-11-03 17:29:03,382:DEBUG:rekall.1:Trying method ntfs, offset 0",
        "2017-11-03 17:29:03,382:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/ntfs.gz",
        "2017-11-03 17:29:03,383:INFO:rekall.1:Loaded profile ntfs from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.0010781288146972656 sec)",
        "2017-11-03 17:29:03,386:DEBUG:rekall.1:Trying method tsk, offset 0",
        "2017-11-03 17:29:04,178:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/nt/GUID/BD8F451F3E754ED8A34B50560CEB08E31.gz",
        "2017-11-03 17:29:04,272:INFO:rekall.1:Loaded profile nt/GUID/BD8F451F3E754ED8A34B50560CEB08E31 from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.09409570693969727 sec)",
        "2017-11-03 17:29:04,593:INFO:rekall.1:Detected ntkrnlpa.pdb with GUID BD8F451F3E754ED8A34B50560CEB08E31",
        "2017-11-03 17:29:04,593:DEBUG:rekall.1:Detection method rsds worked at offset 0x4e0508",
        "2017-11-03 17:29:04,685:INFO:rekall.1:Detected kernel base at 0x804D7000",
        "2017-11-03 17:29:04,696:DEBUG:rekall.1:Listed 25 processes using PsActiveProcessHead",
        "2017-11-03 17:29:05,008:DEBUG:rekall.1:Listed 22 processes using CSRSS",
        "2017-11-03 17:29:05,296:DEBUG:rekall.1:Listed 25 processes using PspCidTable",
        "2017-11-03 17:29:05,306:DEBUG:rekall.1:Listed 23 processes using Sessions",
        "2017-11-03 17:29:05,327:DEBUG:rekall.1:Listed 24 processes using Handles",
        "2017-11-03 17:29:05,407:DEBUG:rekall.1:Running plugin (search) with args (('SELECT * FROM pslist() WHERE (\\n  _EPROCESS.pid in (select _EPROCESS.pid from pslist()).pid\\n) ORDER BY _EPROCESS.pid', None)) kwargs ({})",
        "2017-11-03 17:29:07,487:DEBUG:rekall.1:Running plugin (search) with args ((\"select * from pslist()\\n   where _EPROCESS.name in 'i am a string with svchost.exe in it'\\n\", None)) kwargs ({})",
        "2017-11-03 17:29:07,635:DEBUG:rekall.1:Running plugin (search) with args (('select * from pslist() where _EPROCESS.name =~ \"SVCHOST.+\"', None)) kwargs ({})",
        "2017-11-03 17:29:07,787:DEBUG:rekall.1:Running plugin (search) with args (('select * from pslist(pids: [4, 828, 936])', None)) kwargs ({})",
        "2017-11-03 17:29:07,872:DEBUG:rekall.1:Running plugin (search) with args (('select * from pslist(pids: 936)', None)) kwargs ({})",
        "2017-11-03 17:29:07,952:DEBUG:rekall.1:Running plugin (search) with args (('select * from pslist(\\n  pids: (select _EPROCESS.pid from pslist(pids: [4])).pid\\n)', None)) kwargs ({})",
        "2017-11-03 17:29:08,037:DEBUG:rekall.1:Running plugin (search) with args (('select * from pslist(\\n  pids: select _EPROCESS.pid from pslist(pids: [4])\\n)', None)) kwargs ({})",
        "2017-11-03 17:29:08,118:DEBUG:rekall.1:Running plugin (search) with args (('select hex(offset), hexdump from dump(\\n  offset: (select _EPROCESS.obj_offset-0x20 from pslist(proc_regex: \"svchost\")),\\n  rows: 5\\n)', None)) kwargs ({})",
        "2017-11-03 17:29:08,190:DEBUG:rekall.1:Switching to Kernel context",
        "2017-11-03 17:29:09,168:DEBUG:rekall.1:Switching to Kernel context",
        "2017-11-03 17:29:09,187:DEBUG:rekall.1:Switching to Kernel context",
        "2017-11-03 17:29:09,301:DEBUG:rekall.1:Switching to Kernel context",
        "2017-11-03 17:29:09,533:DEBUG:rekall.1:Running plugin (search) with args (('select (_EPROCESS.pid + 10) from pslist(pids: 4)', None)) kwargs ({})",
        "2017-11-03 17:29:09,610:DEBUG:rekall.1:Running plugin (search) with args (('select * from pslist(proc_regex: {proc_regex})', {'proc_regex': 'svchost.exe'})) kwargs ({})",
        "2017-11-03 17:29:09,708:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS, obj_type, details AS path from handles(\\n  pids: 1968) where _EPROCESS.pid == 1968 and obj_type == \"File\"\\n', None)) kwargs ({})",
        "2017-11-03 17:29:10,018:DEBUG:rekall.1:Running plugin (search) with args (('select * from pslist() where\\n  _EPROCESS.Peb.ProcessParameters.Environment =~ \"USERNAME=Administrator\"\\n', None)) kwargs ({})",
        "2017-11-03 17:29:10,296:DEBUG:rekall.1:Running plugin (search) with args (('select * from pslist() where\\n  \"Administrator\" in _EPROCESS.Peb.ProcessParameters.Environment\\n', None)) kwargs ({})",
        "2017-11-03 17:29:10,572:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS.name, _EPROCESS.QuotaPeak from pslist() where\\n       _EPROCESS.QuotaPeak = [10048, 103556, 1594]\\n', None)) kwargs ({})",
        "2017-11-03 17:29:10,719:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS.name, _EPROCESS.QuotaPeak from pslist() where\\n       10048 in _EPROCESS.QuotaPeak\\n', None)) kwargs ({})",
        "2017-11-03 17:29:10,865:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS.name, _EPROCESS.QuotaPeak from pslist() where\\n       1004 in _EPROCESS.QuotaPeak\\n', None)) kwargs ({})",
        "2017-11-03 17:29:10,953:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS.name,\\n     hex(start / 0x1000) from vad(proc_regex: \"lsass\")\\n', None)) kwargs ({})",
        "2017-11-03 17:29:11,288:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS as proc, hex(start), hex(end), filename from vad(\\n    proc_regex: \"sys\") where substr(filename, 0, 1) == \"\\\\\\\\\"\\n', None)) kwargs ({})",
        "2017-11-03 17:29:11,377:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS, (_EPROCESS.pid + 10) as x from pslist() where x = 14', None)) kwargs ({})",
        "2017-11-03 17:29:11,518:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS, _EPROCESS.Peb.ProcessParameters.Environment as Env\\n   from pslist() where Env =~ \"USERNAME=Administrator\"\\n', None)) kwargs ({})",
        "2017-11-03 17:29:11,890:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS as x from pslist() where x.pid < 216', None)) kwargs ({})",
        "2017-11-03 17:29:12,033:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS as x from pslist() where x.pid <= 216', None)) kwargs ({})",
        "2017-11-03 17:29:12,173:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS as x from pslist() where x.pid > 216', None)) kwargs ({})",
        "2017-11-03 17:29:12,330:DEBUG:rekall.1:Running plugin (search) with args (('select _EPROCESS as x from pslist() where x.pid >= 216', None)) kwargs ({})",
        "2017-11-03 17:29:12,487:DEBUG:rekall.1:Running plugin (search) with args (('select * from pslist() where process_create_time < \"2010-08-11 06:07:00Z\"\\n', None)) kwargs ({})",
        "2017-11-03 17:29:12,516:DEBUG:parsedatetime:eval 06:07:00z with context - True, False",
        "2017-11-03 17:29:12,518:DEBUG:parsedatetime:eval :00z with context - True, True",
        "2017-11-03 17:29:12,674:DEBUG:rekall.1:Running plugin (search) with args (('select * from pslist() where\\n    process_create_time > \"14th Aug 2010\" and\\n    process_create_time < \"5 years ago\"\\n', None)) kwargs ({})"
    ],
    "options": {
        "--cache": "memory",
        "--cache_dir": "/home/mic/projects/rekall-test/tigger/../profile_cache/",
        "--filename": "/home/mic/projects/rekall-test/tigger/tigger.vmem.E01",
        "--format": "test",
        "--name_resolution_strategies": [
            "Module",
            "Symbol"
        ],
        "commandline": "run --run /tmp/tmpqob8x_qo/TestEFilterSearchThread-1/script.py",
        "debug": false,
        "executable": "rekall ",
        "pids": 1724,
        "script": [
            "def TestMe(descr, query, args=None):",
            "  print('---------------')",
            "  print(descr)",
            "  print('**********************')",
            "  print(query)",
            "  search(query, args)",
            "",
            "TestMe(\"Test Search Membership\",",
            "\"\"\"SELECT * FROM pslist() WHERE (",
            "  _EPROCESS.pid in [4, 216, 1668]",
            "  ) ORDER BY _EPROCESS.pid\"\"\")",
            "",
            "TestMe(\"Test Search Membership In Subquery\",",
            "\"\"\"SELECT * FROM pslist() WHERE (",
            "  _EPROCESS.pid in (select _EPROCESS.pid from pslist()).pid",
            ") ORDER BY _EPROCESS.pid\"\"\")",
            "",
            "TestMe(\"Membership used as substr\",",
            "\"\"\"select * from pslist()",
            "   where _EPROCESS.name in 'i am a string with svchost.exe in it'",
            "\"\"\")",
            "",
            "TestMe(\"RegEx operator is case insensitive\",",
            "'select * from pslist() where _EPROCESS.name =~ \"SVCHOST.+\"')",
            "",
            "TestMe(\"With Plugin Args As Repeatable:\",",
            "\"\"\"select * from pslist(pids: [4, 828, 936])\"\"\")",
            "",
            "TestMe(\"TestSearchWithPluginArgsAsScalars\",",
            "\"\"\"select * from pslist(pids: 936)\"\"\")",
            "",
            "TestMe(\"With Plugin Args As Subselects\", \"\"\"select * from pslist(",
            "  pids: (select _EPROCESS.pid from pslist(pids: [4])).pid",
            ")\"\"\")",
            "",
            "TestMe(\"\"\"When there is a single column we do not need to deref the",
            "column. This makes subselects more natural and less error prone.",
            "\"\"\",",
            "\"\"\"select * from pslist(",
            "  pids: select _EPROCESS.pid from pslist(pids: [4])",
            ")\"\"\")",
            "",
            "TestMe(\"\"\"Scalar (non repeating) plugin args with repeating inputs cause",
            "multiple plugin invocations. (This should show the pool tags of svchost).\"\"\",",
            "\"\"\"select hex(offset), hexdump from dump(",
            "  offset: (select _EPROCESS.obj_offset-0x20 from pslist(proc_regex: \"svchost\")),",
            "  rows: 5",
            ")\"\"\")",
            "",
            "TestMe(\"Arithmetics\", \"\"\"select (_EPROCESS.pid + 10) from pslist(pids: 4)\"\"\")",
            "",
            "TestMe(\"\"\"Substitution and interpolation (proc_regex=\"svchost.exe\").\"\"\",",
            "     \"\"\"select * from pslist(proc_regex: {proc_regex})\"\"\",",
            "     dict(proc_regex=\"svchost.exe\"))",
            "",
            "TestMe(\"\", \"\"\"select _EPROCESS, obj_type, details AS path from handles(",
            "  pids: 1968) where _EPROCESS.pid == 1968 and obj_type == \"File\"",
            "\"\"\")",
            "",
            "TestMe(\"Test regex of Array.\", \"\"\"select * from pslist() where",
            "  _EPROCESS.Peb.ProcessParameters.Environment =~ \"USERNAME=Administrator\"",
            "\"\"\")",
            "",
            "TestMe(\"Substring match of an array.\",",
            "\"\"\"select * from pslist() where",
            "  \"Administrator\" in _EPROCESS.Peb.ProcessParameters.Environment",
            "\"\"\")",
            "",
            "TestMe(\"Eq comparison with arrays.\",",
            "\"\"\"select _EPROCESS.name, _EPROCESS.QuotaPeak from pslist() where",
            "       _EPROCESS.QuotaPeak = [10048, 103556, 1594]",
            "\"\"\")",
            "",
            "TestMe(\"Exact match of an integer in an array.\",",
            "\"\"\"select _EPROCESS.name, _EPROCESS.QuotaPeak from pslist() where",
            "       10048 in _EPROCESS.QuotaPeak",
            "\"\"\")",
            "",
            "TestMe(\"No partial match of integers.\",",
            "\"\"\"select _EPROCESS.name, _EPROCESS.QuotaPeak from pslist() where",
            "       1004 in _EPROCESS.QuotaPeak",
            "\"\"\")",
            "",
            "TestMe(\"Arithmetics on pointers.\",",
            "\"\"\"select _EPROCESS.name,",
            "     hex(start / 0x1000) from vad(proc_regex: \"lsass\")",
            "\"\"\")",
            "",
            "TestMe(\"\"\"Automated column name selection. Should be proc, column_1,",
            "column_2. Should not overwrite the scope with \"hex\". Should",
            "properly match a path starting with \\WINDOWS.\"\"\",",
            "'''select _EPROCESS as proc, hex(start), hex(end), filename from vad(",
            "    proc_regex: \"sys\") where substr(filename, 0, 1) == \"\\\\\\\\\"",
            "''')",
            "",
            "TestMe(\"\"\"Aliases with 'as' allowed in filters\"\"\",",
            "\"\"\"select _EPROCESS, (_EPROCESS.pid + 10) as x from pslist() where x = 14\"\"\")",
            "",
            "TestMe(\"\"\"Aliases can be used in regex queries.\"\"\",",
            "\"\"\"select _EPROCESS, _EPROCESS.Peb.ProcessParameters.Environment as Env",
            "   from pslist() where Env =~ \"USERNAME=Administrator\"",
            "\"\"\")",
            "",
            "TestMe(\"\"\"Ordered comparison. Should not include 216\"\"\",",
            "\"\"\"select _EPROCESS as x from pslist() where x.pid < 216\"\"\")",
            "",
            "TestMe(\"\"\"Ordered comparison. Should include 216\"\"\",",
            "\"\"\"select _EPROCESS as x from pslist() where x.pid <= 216\"\"\")",
            "",
            "TestMe(\"\"\"Ordered comparison. Should not include 216\"\"\",",
            "\"\"\"select _EPROCESS as x from pslist() where x.pid > 216\"\"\")",
            "",
            "TestMe(\"\"\"Ordered comparison. Should include 216\"\"\",",
            "\"\"\"select _EPROCESS as x from pslist() where x.pid >= 216\"\"\")",
            "",
            "TestMe(\"\"\"Ordering on timestamps\"\"\",",
            "\"\"\"select * from pslist() where process_create_time < \"2010-08-11 06:07:00Z\"",
            "\"\"\")",
            "",
            "TestMe(\"\"\"Intersection with timestamps and fancy times  (only wmiprvse.exe)\"\"\",",
            "\"\"\"select * from pslist() where",
            "    process_create_time > \"14th Aug 2010\" and",
            "    process_create_time < \"5 years ago\"",
            "\"\"\")"
        ],
        "tempdir": "/tmp/tmpqob8x_qo/TestEFilterSearchThread-1",
        "test_class": "TestEFilterSearch",
        "testdir": "/home/mic/projects/rekall-test/tigger"
    },
    "output": [
        "---------------",
        "Test Search Membership",
        "**********************",
        "SELECT * FROM pslist() WHERE (",
        "  _EPROCESS.pid in [4, 216, 1668]",
        "  ) ORDER BY _EPROCESS.pid",
        "           _EPROCESS            ||ppid||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "--------------------------------||----||------------||------------||----------||------||---------------------||-----------------",
        "0x810b1660||System||           4||0   ||61          ||179         ||-         ||False ||-                    ||-                ",
        "0xff25a7e0||alg.exe||        216||676 ||7           ||108         ||0         ||False ||2010-08-11 06:06:39Z ||-                ",
        "0xff1b8b28||vmtoolsd.exe||  1668||676 ||5           ||218         ||0         ||False ||2010-08-11 06:06:35Z ||-                ",
        "---------------",
        "Test Search Membership In Subquery",
        "**********************",
        "SELECT * FROM pslist() WHERE (",
        "  _EPROCESS.pid in (select _EPROCESS.pid from pslist()).pid",
        ") ORDER BY _EPROCESS.pid",
        "             _EPROCESS             ||ppid ||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "-----------------------------------||-----||------------||------------||----------||------||---------------------||-----------------",
        "0x810b1660||System||              4||0    ||61          ||179         ||-         ||False ||-                    ||-                ",
        "0xff25a7e0||alg.exe||           216||676  ||7           ||108         ||0         ||False ||2010-08-11 06:06:39Z ||-                ",
        "0xff3667e8||VMwareTray.exe||    432||1724 ||1           ||49          ||0         ||False ||2010-08-11 06:09:31Z ||-                ",
        "0xff374980||VMwareUser.exe||    452||1724 ||8           ||204         ||0         ||False ||2010-08-11 06:09:32Z ||-                ",
        "0x80f94588||wuauclt.exe||       468||1028 ||4           ||131         ||0         ||False ||2010-08-11 06:09:37Z ||-                ",
        "0xff2ab020||smss.exe||          544||4    ||3           ||21          ||-         ||False ||2010-08-11 06:06:21Z ||-                ",
        "0xff1ecda0||csrss.exe||         608||544  ||10          ||405         ||0         ||False ||2010-08-11 06:06:23Z ||-                ",
        "0xff1ec978||winlogon.exe||      632||544  ||22          ||519         ||0         ||False ||2010-08-11 06:06:23Z ||-                ",
        "0xff247020||services.exe||      676||632  ||16          ||269         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff255020||lsass.exe||         688||632  ||21          ||348         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff27d4d0||wmiprvse.exe||      828||856  ||9           ||214         ||0         ||False ||2010-08-15 19:26:08Z ||-                ",
        "0xff218230||vmacthlp.exe||      844||676  ||1           ||24          ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0x80ff88d8||svchost.exe||       856||676  ||18          ||202         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff364310||wscntfy.exe||       888||1028 ||1           ||27          ||0         ||False ||2010-08-11 06:06:49Z ||-                ",
        "0xff217560||svchost.exe||       936||676  ||9           ||270         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0x80fbf910||svchost.exe||      1028||676  ||88          ||1395        ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff38b5f8||TPAutoConnect.e||  1084||1968 ||1           ||61          ||0         ||False ||2010-08-11 06:06:52Z ||-                ",
        "0xff22d558||svchost.exe||      1088||676  ||7           ||80          ||0         ||False ||2010-08-11 06:06:25Z ||-                ",
        "0xff203b80||svchost.exe||      1148||676  ||15          ||210         ||0         ||False ||2010-08-11 06:06:26Z ||-                ",
        "0xff1d7da0||spoolsv.exe||      1432||676  ||14          ||137         ||0         ||False ||2010-08-11 06:06:26Z ||-                ",
        "0xff1b8b28||vmtoolsd.exe||     1668||676  ||5           ||218         ||0         ||False ||2010-08-11 06:06:35Z ||-                ",
        "0xff3865d0||explorer.exe||     1724||1708 ||13          ||314         ||0         ||False ||2010-08-11 06:09:29Z ||-                ",
        "0x80f60da0||wuauclt.exe||      1732||1028 ||7           ||178         ||0         ||False ||2010-08-11 06:07:44Z ||-                ",
        "0xff1fdc88||VMUpgradeHelper||  1788||676  ||5           ||100         ||0         ||False ||2010-08-11 06:06:38Z ||-                ",
        "0xff143b28||TPAutoConnSvc.e||  1968||676  ||5           ||100         ||0         ||False ||2010-08-11 06:06:39Z ||-                ",
        "---------------",
        "Membership used as substr",
        "**********************",
        "select * from pslist()",
        "   where _EPROCESS.name in 'i am a string with svchost.exe in it'",
        "",
        "           _EPROCESS           ||ppid||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "-------------------------------||----||------------||------------||----------||------||---------------------||-----------------",
        "0x80ff88d8||svchost.exe||   856||676 ||18          ||202         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff217560||svchost.exe||   936||676 ||9           ||270         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0x80fbf910||svchost.exe||  1028||676 ||88          ||1395        ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff22d558||svchost.exe||  1088||676 ||7           ||80          ||0         ||False ||2010-08-11 06:06:25Z ||-                ",
        "0xff203b80||svchost.exe||  1148||676 ||15          ||210         ||0         ||False ||2010-08-11 06:06:26Z ||-                ",
        "---------------",
        "RegEx operator is case insensitive",
        "**********************",
        "select * from pslist() where _EPROCESS.name =~ \"SVCHOST.+\"",
        "           _EPROCESS           ||ppid||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "-------------------------------||----||------------||------------||----------||------||---------------------||-----------------",
        "0x80ff88d8||svchost.exe||   856||676 ||18          ||202         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff217560||svchost.exe||   936||676 ||9           ||270         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0x80fbf910||svchost.exe||  1028||676 ||88          ||1395        ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff22d558||svchost.exe||  1088||676 ||7           ||80          ||0         ||False ||2010-08-11 06:06:25Z ||-                ",
        "0xff203b80||svchost.exe||  1148||676 ||15          ||210         ||0         ||False ||2010-08-11 06:06:26Z ||-                ",
        "---------------",
        "With Plugin Args As Repeatable:",
        "**********************",
        "select * from pslist(pids: [4, 828, 936])",
        "           _EPROCESS            ||ppid||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "--------------------------------||----||------------||------------||----------||------||---------------------||-----------------",
        "0x810b1660||System||           4||0   ||61          ||179         ||-         ||False ||-                    ||-                ",
        "0xff27d4d0||wmiprvse.exe||   828||856 ||9           ||214         ||0         ||False ||2010-08-15 19:26:08Z ||-                ",
        "0xff217560||svchost.exe||    936||676 ||9           ||270         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "---------------",
        "TestSearchWithPluginArgsAsScalars",
        "**********************",
        "select * from pslist(pids: 936)",
        "           _EPROCESS           ||ppid||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "-------------------------------||----||------------||------------||----------||------||---------------------||-----------------",
        "0xff217560||svchost.exe||   936||676 ||9           ||270         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "---------------",
        "With Plugin Args As Subselects",
        "**********************",
        "select * from pslist(",
        "  pids: (select _EPROCESS.pid from pslist(pids: [4])).pid",
        ")",
        "        _EPROCESS         ||ppid||thread_count||handle_count||session_id||wow64 ||process_create_time||process_exit_time",
        "--------------------------||----||------------||------------||----------||------||-------------------||-----------------",
        "0x810b1660||System||     4||0   ||61          ||179         ||-         ||False ||-                  ||-                ",
        "---------------",
        "When there is a single column we do not need to deref the",
        "column. This makes subselects more natural and less error prone.",
        "",
        "**********************",
        "select * from pslist(",
        "  pids: select _EPROCESS.pid from pslist(pids: [4])",
        ")",
        "        _EPROCESS         ||ppid||thread_count||handle_count||session_id||wow64 ||process_create_time||process_exit_time",
        "--------------------------||----||------------||------------||----------||------||-------------------||-----------------",
        "0x810b1660||System||     4||0   ||61          ||179         ||-         ||False ||-                  ||-                ",
        "---------------",
        "Scalar (non repeating) plugin args with repeating inputs cause",
        "multiple plugin invocations. (This should show the pool tags of svchost).",
        "**********************",
        "select hex(offset), hexdump from dump(",
        "  offset: (select _EPROCESS.obj_offset-0x20 from pslist(proc_regex: \"svchost\")),",
        "  rows: 5",
        ")",
        " column_0  ||                             hexdump                              ",
        "-----------||------------------------------------------------------------------",
        "0x80ff88b8 ||06 00 50 0a 50 72 6f e3 77 00 00 00 05 00 00 00 ||..P.Pro.w....... ",
        "0x80ff88c8 ||a0 1c 0b 81 00 00 00 20 00 93 55 80 1b 40 00 e1 ||..........U..@.. ",
        "0x80ff88d8 ||03 00 1b 00 00 00 00 00 a8 5a 23 ff a8 5a 23 ff ||.........Z#..Z#. ",
        "0x80ff88e8 ||e8 88 ff 80 e8 88 ff 80 e0 00 cc 06 df 1d 00 00 ||................ ",
        "0x80ff88f8 ||00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ||................ ",
        "0xff217540 ||03 00 50 0a 50 72 6f e3 90 00 00 00 04 00 00 00 ||..P.Pro......... ",
        "0xff217550 ||a0 1c 0b 81 00 00 00 20 00 93 55 80 1f 20 a3 e1 ||..........U..... ",
        "0xff217560 ||03 00 1b 00 00 00 00 00 c0 5a 23 ff c0 5a 23 ff ||.........Z#..Z#. ",
        "0xff217570 ||70 75 21 ff 70 75 21 ff 00 01 cc 06 4d 1e 00 00 ||pu!.pu!.....M... ",
        "0xff217580 ||00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ||................ ",
        "0x80fbf8f0 ||4f 00 50 0a 50 72 6f e3 41 06 00 00 0d 00 00 00 ||O.P.Pro.A....... ",
        "0x80fbf900 ||a0 1c 0b 81 00 00 00 20 00 93 55 80 1e 40 00 e1 ||..........U..@.. ",
        "0x80fbf910 ||03 00 1b 00 00 00 00 00 d8 5a 23 ff 38 70 f1 80 ||.........Z#.8p.. ",
        "0x80fbf920 ||20 f9 fb 80 20 f9 fb 80 20 01 cc 06 d6 23 00 00 ||.............#.. ",
        "0x80fbf930 ||00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ||................ ",
        "0xff22d538 ||13 00 50 0a 50 72 6f e3 24 00 00 00 03 00 00 00 ||..P.Pro.$....... ",
        "0xff22d548 ||a0 1c 0b 81 00 00 00 20 00 93 55 80 1a 94 a6 e1 ||..........U..... ",
        "0xff22d558 ||03 00 1b 00 00 00 00 00 f0 5a 23 ff f0 5a 23 ff ||.........Z#..Z#. ",
        "0xff22d568 ||68 d5 22 ff 68 d5 22 ff 40 01 cc 06 ae 25 00 00 ||h.\".h.\".@....%.. ",
        "0xff22d578 ||00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ||................ ",
        "0xff203b60 ||06 00 50 0a 50 72 6f e3 70 00 00 00 04 00 00 00 ||..P.Pro.p....... ",
        "0xff203b70 ||a0 1c 0b 81 00 00 00 20 00 93 55 80 a4 e9 c3 e1 ||..........U..... ",
        "0xff203b80 ||03 00 1b 00 00 00 00 00 08 5b 23 ff 50 70 f1 80 ||.........[#.Pp.. ",
        "0xff203b90 ||90 3b 20 ff 90 3b 20 ff 60 01 cc 06 c7 40 00 00 ||.;...;..`....@.. ",
        "0xff203ba0 ||00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ||................ ",
        "---------------",
        "Arithmetics",
        "**********************",
        "select (_EPROCESS.pid + 10) from pslist(pids: 4)",
        "column_0",
        "--------",
        "14      ",
        "---------------",
        "Substitution and interpolation (proc_regex=\"svchost.exe\").",
        "**********************",
        "select * from pslist(proc_regex: {proc_regex})",
        "           _EPROCESS           ||ppid||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "-------------------------------||----||------------||------------||----------||------||---------------------||-----------------",
        "0x80ff88d8||svchost.exe||   856||676 ||18          ||202         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff217560||svchost.exe||   936||676 ||9           ||270         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0x80fbf910||svchost.exe||  1028||676 ||88          ||1395        ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff22d558||svchost.exe||  1088||676 ||7           ||80          ||0         ||False ||2010-08-11 06:06:25Z ||-                ",
        "0xff203b80||svchost.exe||  1148||676 ||15          ||210         ||0         ||False ||2010-08-11 06:06:26Z ||-                ",
        "---------------",
        "",
        "**********************",
        "select _EPROCESS, obj_type, details AS path from handles(",
        "  pids: 1968) where _EPROCESS.pid == 1968 and obj_type == \"File\"",
        "",
        "         _EPROCESS         ||obj_type||                                              path                                               ",
        "---------------------------||--------||-------------------------------------------------------------------------------------------------",
        "0xff143b28||TPAutoConnSvc.e|| 1968||File    ||\\Device\\HarddiskVolume1\\WINDOWS\\system32                                                         ",
        "0xff143b28||TPAutoConnSvc.e|| 1968||File    ||\\Device\\HarddiskVolume1\\WINDOWS\\WinSxS\\x86_Microsoft.Windows.Common-                             ",
        "          ||               ||     ||        ||Controls_6595b64144ccf1df_6.0.2600.2180_x-ww_a84f1ff9                                            ",
        "0xff143b28||TPAutoConnSvc.e|| 1968||File    ||\\Device\\KsecDD                                                                                   ",
        "0xff143b28||TPAutoConnSvc.e|| 1968||File    ||\\Device\\HarddiskVolume1\\WINDOWS\\WinSxS\\x86_Microsoft.Windows.Common-                             ",
        "          ||               ||     ||        ||Controls_6595b64144ccf1df_6.0.2600.2180_x-ww_a84f1ff9                                            ",
        "0xff143b28||TPAutoConnSvc.e|| 1968||File    ||\\Device\\NamedPipe\\net\\NtControlPipe11                                                            ",
        "0xff143b28||TPAutoConnSvc.e|| 1968||File    ||\\Device\\Tcp                                                                                      ",
        "0xff143b28||TPAutoConnSvc.e|| 1968||File    ||\\Device\\Tcp                                                                                      ",
        "0xff143b28||TPAutoConnSvc.e|| 1968||File    ||\\Device\\Ip                                                                                       ",
        "0xff143b28||TPAutoConnSvc.e|| 1968||File    ||\\Device\\Ip                                                                                       ",
        "0xff143b28||TPAutoConnSvc.e|| 1968||File    ||\\Device\\Ip                                                                                       ",
        "---------------",
        "Test regex of Array.",
        "**********************",
        "select * from pslist() where",
        "  _EPROCESS.Peb.ProcessParameters.Environment =~ \"USERNAME=Administrator\"",
        "",
        "            _EPROCESS             ||ppid ||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "----------------------------------||-----||------------||------------||----------||------||---------------------||-----------------",
        "0xff3667e8||VMwareTray.exe||   432||1724 ||1           ||49          ||0         ||False ||2010-08-11 06:09:31Z ||-                ",
        "0xff374980||VMwareUser.exe||   452||1724 ||8           ||204         ||0         ||False ||2010-08-11 06:09:32Z ||-                ",
        "0x80f94588||wuauclt.exe||      468||1028 ||4           ||131         ||0         ||False ||2010-08-11 06:09:37Z ||-                ",
        "0xff3865d0||explorer.exe||    1724||1708 ||13          ||314         ||0         ||False ||2010-08-11 06:09:29Z ||-                ",
        "---------------",
        "Substring match of an array.",
        "**********************",
        "select * from pslist() where",
        "  \"Administrator\" in _EPROCESS.Peb.ProcessParameters.Environment",
        "",
        "            _EPROCESS             ||ppid ||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "----------------------------------||-----||------------||------------||----------||------||---------------------||-----------------",
        "0xff3667e8||VMwareTray.exe||   432||1724 ||1           ||49          ||0         ||False ||2010-08-11 06:09:31Z ||-                ",
        "0xff374980||VMwareUser.exe||   452||1724 ||8           ||204         ||0         ||False ||2010-08-11 06:09:32Z ||-                ",
        "0x80f94588||wuauclt.exe||      468||1028 ||4           ||131         ||0         ||False ||2010-08-11 06:09:37Z ||-                ",
        "0xff1ec978||winlogon.exe||     632||544  ||22          ||519         ||0         ||False ||2010-08-11 06:06:23Z ||-                ",
        "0xff3865d0||explorer.exe||    1724||1708 ||13          ||314         ||0         ||False ||2010-08-11 06:09:29Z ||-                ",
        "---------------",
        "Eq comparison with arrays.",
        "**********************",
        "select _EPROCESS.name, _EPROCESS.QuotaPeak from pslist() where",
        "       _EPROCESS.QuotaPeak = [10048, 103556, 1594]",
        "",
        "    name     ||QuotaPeak",
        "-------------||---------",
        "vmtoolsd.exe ||- 0:     ",
        "             ||10048    ",
        "             ||- 1:     ",
        "             ||103556   ",
        "             ||- 2:     ",
        "             ||1594     ",
        "---------------",
        "Exact match of an integer in an array.",
        "**********************",
        "select _EPROCESS.name, _EPROCESS.QuotaPeak from pslist() where",
        "       10048 in _EPROCESS.QuotaPeak",
        "",
        "    name     ||QuotaPeak",
        "-------------||---------",
        "vmtoolsd.exe ||- 0:     ",
        "             ||10048    ",
        "             ||- 1:     ",
        "             ||103556   ",
        "             ||- 2:     ",
        "             ||1594     ",
        "---------------",
        "No partial match of integers.",
        "**********************",
        "select _EPROCESS.name, _EPROCESS.QuotaPeak from pslist() where",
        "       1004 in _EPROCESS.QuotaPeak",
        "",
        "No results.---------------",
        "Arithmetics on pointers.",
        "**********************",
        "select _EPROCESS.name,",
        "     hex(start / 0x1000) from vad(proc_regex: \"lsass\")",
        "",
        "   name   ||column_1",
        "----------||--------",
        "lsass.exe ||        ",
        "lsass.exe ||0x10    ",
        "lsass.exe ||0x20    ",
        "lsass.exe ||0x30    ",
        "lsass.exe ||0x40    ",
        "lsass.exe ||0x80    ",
        "lsass.exe ||0x90    ",
        "lsass.exe ||0x190   ",
        "lsass.exe ||0x1a0   ",
        "lsass.exe ||0x1b0   ",
        "lsass.exe ||0x1d0   ",
        "lsass.exe ||0x210   ",
        "lsass.exe ||0x260   ",
        "lsass.exe ||0x270   ",
        "lsass.exe ||0x340   ",
        "lsass.exe ||0x350   ",
        "lsass.exe ||0x360   ",
        "lsass.exe ||0x370   ",
        "lsass.exe ||0x380   ",
        "lsass.exe ||0x390   ",
        "lsass.exe ||0x3a0   ",
        "lsass.exe ||0x3b0   ",
        "lsass.exe ||0x3c0   ",
        "lsass.exe ||0x3d0   ",
        "lsass.exe ||0x410   ",
        "lsass.exe ||0x520   ",
        "lsass.exe ||0x5a0   ",
        "lsass.exe ||0x620   ",
        "lsass.exe ||0x660   ",
        "lsass.exe ||0x6a0   ",
        "lsass.exe ||0x6e0   ",
        "lsass.exe ||0x720   ",
        "lsass.exe ||0x760   ",
        "lsass.exe ||0x770   ",
        "lsass.exe ||0x7b0   ",
        "lsass.exe ||0x8b0   ",
        "lsass.exe ||0x8f0   ",
        "lsass.exe ||0x900   ",
        "lsass.exe ||0x910   ",
        "lsass.exe ||0x950   ",
        "lsass.exe ||0x990   ",
        "lsass.exe ||0x9d0   ",
        "lsass.exe ||0xa50   ",
        "lsass.exe ||0xa90   ",
        "lsass.exe ||0xb10   ",
        "lsass.exe ||0xb50   ",
        "lsass.exe ||0xbd0   ",
        "lsass.exe ||0xbe0   ",
        "lsass.exe ||0xc20   ",
        "lsass.exe ||0xc60   ",
        "lsass.exe ||0xc70   ",
        "lsass.exe ||0xd60   ",
        "lsass.exe ||0xda0   ",
        "lsass.exe ||0xde0   ",
        "lsass.exe ||0xe20   ",
        "lsass.exe ||0x1000  ",
        "lsass.exe ||0xffd0  ",
        "lsass.exe ||0x20000 ",
        "lsass.exe ||0x5ad70 ",
        "lsass.exe ||0x5b860 ",
        "lsass.exe ||0x5cb70 ",
        "lsass.exe ||0x5d090 ",
        "lsass.exe ||0x662b0 ",
        "lsass.exe ||0x68100 ",
        "lsass.exe ||0x6f880 ",
        "lsass.exe ||0x71a50 ",
        "lsass.exe ||0x71a90 ",
        "lsass.exe ||0x71aa0 ",
        "lsass.exe ||0x71ab0 ",
        "lsass.exe ||0x71b20 ",
        "lsass.exe ||0x71bf0 ",
        "lsass.exe ||0x71cf0 ",
        "lsass.exe ||0x74370 ",
        "lsass.exe ||0x74380 ",
        "lsass.exe ||0x743a0 ",
        "lsass.exe ||0x743c0 ",
        "lsass.exe ||0x743e0 ",
        "lsass.exe ||0x74410 ",
        "lsass.exe ||0x74440 ",
        "lsass.exe ||0x744b0 ",
        "lsass.exe ||0x75730 ",
        "lsass.exe ||0x75d90 ",
        "lsass.exe ||0x76080 ",
        "lsass.exe ||0x76790 ",
        "lsass.exe ||0x767a0 ",
        "lsass.exe ||0x767c0 ",
        "lsass.exe ||0x767f0 ",
        "lsass.exe ||0x769c0 ",
        "lsass.exe ||0x76b40 ",
        "lsass.exe ||0x76d60 ",
        "lsass.exe ||0x76f20 ",
        "lsass.exe ||0x76f60 ",
        "lsass.exe ||0x77120 ",
        "lsass.exe ||0x773d0 ",
        "lsass.exe ||0x774e0 ",
        "lsass.exe ||0x776c0 ",
        "lsass.exe ||0x77920 ",
        "lsass.exe ||0x77a80 ",
        "lsass.exe ||0x77b20 ",
        "lsass.exe ||0x77be0 ",
        "lsass.exe ||0x77c00 ",
        "lsass.exe ||0x77c10 ",
        "lsass.exe ||0x77c70 ",
        "lsass.exe ||0x77d40 ",
        "lsass.exe ||0x77dd0 ",
        "lsass.exe ||0x77e70 ",
        "lsass.exe ||0x77f10 ",
        "lsass.exe ||0x77f60 ",
        "lsass.exe ||0x77fe0 ",
        "lsass.exe ||0x7c800 ",
        "lsass.exe ||0x7c900 ",
        "lsass.exe ||0x7c9c0 ",
        "lsass.exe ||0x7f6f0 ",
        "lsass.exe ||0x7ffa1 ",
        "lsass.exe ||0x7ffa2 ",
        "lsass.exe ||0x7ffa3 ",
        "lsass.exe ||0x7ffa5 ",
        "lsass.exe ||0x7ffa7 ",
        "lsass.exe ||0x7ffa8 ",
        "lsass.exe ||0x7ffa9 ",
        "lsass.exe ||0x7ffaa ",
        "lsass.exe ||0x7ffac ",
        "lsass.exe ||0x7ffad ",
        "lsass.exe ||0x7ffaf ",
        "lsass.exe ||0x7ffb0 ",
        "lsass.exe ||0x7ffd4 ",
        "lsass.exe ||0x7ffd5 ",
        "lsass.exe ||0x7ffd6 ",
        "lsass.exe ||0x7ffd7 ",
        "lsass.exe ||0x7ffd8 ",
        "lsass.exe ||0x7ffd9 ",
        "lsass.exe ||0x7ffda ",
        "lsass.exe ||0x7ffdb ",
        "lsass.exe ||0x7ffdc ",
        "lsass.exe ||0x7ffdd ",
        "lsass.exe ||0x7ffde ",
        "---------------",
        "Automated column name selection. Should be proc, column_1,",
        "column_2. Should not overwrite the scope with \"hex\". Should",
        "properly match a path starting with \\WINDOWS.",
        "**********************",
        "select _EPROCESS as proc, hex(start), hex(end), filename from vad(",
        "    proc_regex: \"sys\") where substr(filename, 0, 1) == \"\\\\\"",
        "",
        "           proc           || column_1  || column_2  ||          filename          ",
        "--------------------------||-----------||-----------||----------------------------",
        "0x810b1660||System||     4||0x7c900000 ||0x7c9affff ||\\WINDOWS\\system32\\ntdll.dll ",
        "---------------",
        "Aliases with 'as' allowed in filters",
        "**********************",
        "select _EPROCESS, (_EPROCESS.pid + 10) as x from pslist() where x = 14",
        "        _EPROCESS         || x ",
        "--------------------------||---",
        "0x810b1660||System||     4||14 ",
        "---------------",
        "Aliases can be used in regex queries.",
        "**********************",
        "select _EPROCESS, _EPROCESS.Peb.ProcessParameters.Environment as Env",
        "   from pslist() where Env =~ \"USERNAME=Administrator\"",
        "",
        "           _EPROCESS            ||                                              Env                                              ",
        "--------------------------------||-----------------------------------------------------------------------------------------------",
        "0xff3667e8||VMwareTray.exe||  432||- 0:                                                                                              ",
        "          ||              ||     ||=::=::\\                                                                                           ",
        "          ||              ||     ||- 1:                                                                                              ",
        "          ||              ||     ||ALLUSERSPROFILE=C:\\Documents and Settings\\All Users                                               ",
        "          ||              ||     ||- 2:                                                                                              ",
        "          ||              ||     ||APPDATA=C:\\Documents and Settings\\Administrator\\Application Data                                  ",
        "          ||              ||     ||- 3:                                                                                              ",
        "          ||              ||     ||CLIENTNAME=Console                                                                                ",
        "          ||              ||     ||- 4:                                                                                              ",
        "          ||              ||     ||CommonProgramFiles=C:\\Program Files\\Common Files                                                  ",
        "          ||              ||     ||- 5:                                                                                              ",
        "          ||              ||     ||COMPUTERNAME=BILLY-DB5B96DD3                                                                      ",
        "          ||              ||     ||- 6:                                                                                              ",
        "          ||              ||     ||ComSpec=C:\\WINDOWS\\system32\\cmd.exe                                                               ",
        "          ||              ||     ||- 7:                                                                                              ",
        "          ||              ||     ||FP_NO_HOST_CHECK=NO                                                                               ",
        "          ||              ||     ||- 8:                                                                                              ",
        "          ||              ||     ||HOMEDRIVE=C:                                                                                      ",
        "          ||              ||     ||- 9:                                                                                              ",
        "          ||              ||     ||HOMEPATH=\\Documents and Settings\\Administrator                                                    ",
        "          ||              ||     ||- 10:                                                                                             ",
        "          ||              ||     ||LOGONSERVER=\\\\BILLY-DB5B96DD3                                                                     ",
        "          ||              ||     ||- 11:                                                                                             ",
        "          ||              ||     ||NUMBER_OF_PROCESSORS=1                                                                            ",
        "          ||              ||     ||- 12:                                                                                             ",
        "          ||              ||     ||OS=Windows_NT                                                                                     ",
        "          ||              ||     ||- 13:                                                                                             ",
        "          ||              ||     ||Path=C:\\Program Files\\VMware\\VMware Tools\\;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem",
        "          ||              ||     ||- 14:                                                                                             ",
        "          ||              ||     ||PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH                                          ",
        "          ||              ||     ||- 15:                                                                                             ",
        "          ||              ||     ||PROCESSOR_ARCHITECTURE=x86                                                                        ",
        "          ||              ||     ||- 16:                                                                                             ",
        "          ||              ||     ||PROCESSOR_IDENTIFIER=x86 Family 6 Model 23 Stepping 10, GenuineIntel                              ",
        "          ||              ||     ||- 17:                                                                                             ",
        "          ||              ||     ||PROCESSOR_LEVEL=6                                                                                 ",
        "          ||              ||     ||- 18:                                                                                             ",
        "          ||              ||     ||PROCESSOR_REVISION=170a                                                                           ",
        "          ||              ||     ||- 19:                                                                                             ",
        "          ||              ||     ||ProgramFiles=C:\\Program Files                                                                     ",
        "          ||              ||     ||- 20:                                                                                             ",
        "          ||              ||     ||SESSIONNAME=Console                                                                               ",
        "          ||              ||     ||- 21:                                                                                             ",
        "          ||              ||     ||SystemDrive=C:                                                                                    ",
        "          ||              ||     ||- 22:                                                                                             ",
        "          ||              ||     ||SystemRoot=C:\\WINDOWS                                                                             ",
        "          ||              ||     ||- 23:                                                                                             ",
        "          ||              ||     ||TEMP=C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp                                                           ",
        "          ||              ||     ||- 24:                                                                                             ",
        "          ||              ||     ||TMP=C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp                                                            ",
        "          ||              ||     ||- 25:                                                                                             ",
        "          ||              ||     ||USERDOMAIN=BILLY-DB5B96DD3                                                                        ",
        "          ||              ||     ||- 26:                                                                                             ",
        "          ||              ||     ||USERNAME=Administrator                                                                            ",
        "          ||              ||     ||- 27:                                                                                             ",
        "          ||              ||     ||USERPROFILE=C:\\Documents and Settings\\Administrator                                               ",
        "          ||              ||     ||- 28:                                                                                             ",
        "          ||              ||     ||windir=C:\\WINDOWS                                                                                 ",
        "0xff374980||VMwareUser.exe||  452||- 0:                                                                                              ",
        "          ||              ||     ||=::=::\\                                                                                           ",
        "          ||              ||     ||- 1:                                                                                              ",
        "          ||              ||     ||ALLUSERSPROFILE=C:\\Documents and Settings\\All Users                                               ",
        "          ||              ||     ||- 2:                                                                                              ",
        "          ||              ||     ||APPDATA=C:\\Documents and Settings\\Administrator\\Application Data                                  ",
        "          ||              ||     ||- 3:                                                                                              ",
        "          ||              ||     ||CLIENTNAME=Console                                                                                ",
        "          ||              ||     ||- 4:                                                                                              ",
        "          ||              ||     ||CommonProgramFiles=C:\\Program Files\\Common Files                                                  ",
        "          ||              ||     ||- 5:                                                                                              ",
        "          ||              ||     ||COMPUTERNAME=BILLY-DB5B96DD3                                                                      ",
        "          ||              ||     ||- 6:                                                                                              ",
        "          ||              ||     ||ComSpec=C:\\WINDOWS\\system32\\cmd.exe                                                               ",
        "          ||              ||     ||- 7:                                                                                              ",
        "          ||              ||     ||FP_NO_HOST_CHECK=NO                                                                               ",
        "          ||              ||     ||- 8:                                                                                              ",
        "          ||              ||     ||HOMEDRIVE=C:                                                                                      ",
        "          ||              ||     ||- 9:                                                                                              ",
        "          ||              ||     ||HOMEPATH=\\Documents and Settings\\Administrator                                                    ",
        "          ||              ||     ||- 10:                                                                                             ",
        "          ||              ||     ||LOGONSERVER=\\\\BILLY-DB5B96DD3                                                                     ",
        "          ||              ||     ||- 11:                                                                                             ",
        "          ||              ||     ||NUMBER_OF_PROCESSORS=1                                                                            ",
        "          ||              ||     ||- 12:                                                                                             ",
        "          ||              ||     ||OS=Windows_NT                                                                                     ",
        "          ||              ||     ||- 13:                                                                                             ",
        "          ||              ||     ||Path=C:\\Program Files\\VMware\\VMware Tools\\;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem",
        "          ||              ||     ||- 14:                                                                                             ",
        "          ||              ||     ||PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH                                          ",
        "          ||              ||     ||- 15:                                                                                             ",
        "          ||              ||     ||PROCESSOR_ARCHITECTURE=x86                                                                        ",
        "          ||              ||     ||- 16:                                                                                             ",
        "          ||              ||     ||PROCESSOR_IDENTIFIER=x86 Family 6 Model 23 Stepping 10, GenuineIntel                              ",
        "          ||              ||     ||- 17:                                                                                             ",
        "          ||              ||     ||PROCESSOR_LEVEL=6                                                                                 ",
        "          ||              ||     ||- 18:                                                                                             ",
        "          ||              ||     ||PROCESSOR_REVISION=170a                                                                           ",
        "          ||              ||     ||- 19:                                                                                             ",
        "          ||              ||     ||ProgramFiles=C:\\Program Files                                                                     ",
        "          ||              ||     ||- 20:                                                                                             ",
        "          ||              ||     ||SESSIONNAME=Console                                                                               ",
        "          ||              ||     ||- 21:                                                                                             ",
        "          ||              ||     ||SystemDrive=C:                                                                                    ",
        "          ||              ||     ||- 22:                                                                                             ",
        "          ||              ||     ||SystemRoot=C:\\WINDOWS                                                                             ",
        "          ||              ||     ||- 23:                                                                                             ",
        "          ||              ||     ||TEMP=C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp                                                           ",
        "          ||              ||     ||- 24:                                                                                             ",
        "          ||              ||     ||TMP=C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp                                                            ",
        "          ||              ||     ||- 25:                                                                                             ",
        "          ||              ||     ||USERDOMAIN=BILLY-DB5B96DD3                                                                        ",
        "          ||              ||     ||- 26:                                                                                             ",
        "          ||              ||     ||USERNAME=Administrator                                                                            ",
        "          ||              ||     ||- 27:                                                                                             ",
        "          ||              ||     ||USERPROFILE=C:\\Documents and Settings\\Administrator                                               ",
        "          ||              ||     ||- 28:                                                                                             ",
        "          ||              ||     ||windir=C:\\WINDOWS                                                                                 ",
        "0x80f94588||wuauclt.exe||    468||- 0:                                                                                           ",
        "          ||           ||       ||ALLUSERSPROFILE=C:\\Documents and Settings\\All Users                                            ",
        "          ||           ||       ||- 1:                                                                                           ",
        "          ||           ||       ||APPDATA=C:\\Documents and Settings\\Administrator\\Application Data                               ",
        "          ||           ||       ||- 2:                                                                                           ",
        "          ||           ||       ||CLIENTNAME=Console                                                                             ",
        "          ||           ||       ||- 3:                                                                                           ",
        "          ||           ||       ||CommonProgramFiles=C:\\Program Files\\Common Files                                               ",
        "          ||           ||       ||- 4:                                                                                           ",
        "          ||           ||       ||COMPUTERNAME=BILLY-DB5B96DD3                                                                   ",
        "          ||           ||       ||- 5:                                                                                           ",
        "          ||           ||       ||ComSpec=C:\\WINDOWS\\system32\\cmd.exe                                                            ",
        "          ||           ||       ||- 6:                                                                                           ",
        "          ||           ||       ||FP_NO_HOST_CHECK=NO                                                                            ",
        "          ||           ||       ||- 7:                                                                                           ",
        "          ||           ||       ||HOMEDRIVE=C:                                                                                   ",
        "          ||           ||       ||- 8:                                                                                           ",
        "          ||           ||       ||HOMEPATH=\\Documents and Settings\\Administrator                                                 ",
        "          ||           ||       ||- 9:                                                                                           ",
        "          ||           ||       ||LOGONSERVER=\\\\BILLY-DB5B96DD3                                                                  ",
        "          ||           ||       ||- 10:                                                                                          ",
        "          ||           ||       ||NUMBER_OF_PROCESSORS=1                                                                         ",
        "          ||           ||       ||- 11:                                                                                          ",
        "          ||           ||       ||OS=Windows_NT                                                                                  ",
        "          ||           ||       ||- 12:                                                                                          ",
        "          ||           ||       ||Path=C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem                                   ",
        "          ||           ||       ||- 13:                                                                                          ",
        "          ||           ||       ||PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH                                       ",
        "          ||           ||       ||- 14:                                                                                          ",
        "          ||           ||       ||PROCESSOR_ARCHITECTURE=x86                                                                     ",
        "          ||           ||       ||- 15:                                                                                          ",
        "          ||           ||       ||PROCESSOR_IDENTIFIER=x86 Family 6 Model 23 Stepping 10, GenuineIntel                           ",
        "          ||           ||       ||- 16:                                                                                          ",
        "          ||           ||       ||PROCESSOR_LEVEL=6                                                                              ",
        "          ||           ||       ||- 17:                                                                                          ",
        "          ||           ||       ||PROCESSOR_REVISION=170a                                                                        ",
        "          ||           ||       ||- 18:                                                                                          ",
        "          ||           ||       ||ProgramFiles=C:\\Program Files                                                                  ",
        "          ||           ||       ||- 19:                                                                                          ",
        "          ||           ||       ||SESSIONNAME=Console                                                                            ",
        "          ||           ||       ||- 20:                                                                                          ",
        "          ||           ||       ||SystemDrive=C:                                                                                 ",
        "          ||           ||       ||- 21:                                                                                          ",
        "          ||           ||       ||SystemRoot=C:\\WINDOWS                                                                          ",
        "          ||           ||       ||- 22:                                                                                          ",
        "          ||           ||       ||TEMP=C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp                                                        ",
        "          ||           ||       ||- 23:                                                                                          ",
        "          ||           ||       ||TMP=C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp                                                         ",
        "          ||           ||       ||- 24:                                                                                          ",
        "          ||           ||       ||USERDOMAIN=BILLY-DB5B96DD3                                                                     ",
        "          ||           ||       ||- 25:                                                                                          ",
        "          ||           ||       ||USERNAME=Administrator                                                                         ",
        "          ||           ||       ||- 26:                                                                                          ",
        "          ||           ||       ||USERPROFILE=C:\\Documents and Settings\\Administrator                                            ",
        "          ||           ||       ||- 27:                                                                                          ",
        "          ||           ||       ||windir=C:\\WINDOWS                                                                              ",
        "0xff3865d0||explorer.exe||  1724||- 0:                                                                                           ",
        "          ||            ||      ||=::=::\\                                                                                        ",
        "          ||            ||      ||- 1:                                                                                           ",
        "          ||            ||      ||ALLUSERSPROFILE=C:\\Documents and Settings\\All Users                                            ",
        "          ||            ||      ||- 2:                                                                                           ",
        "          ||            ||      ||APPDATA=C:\\Documents and Settings\\Administrator\\Application Data                               ",
        "          ||            ||      ||- 3:                                                                                           ",
        "          ||            ||      ||CLIENTNAME=Console                                                                             ",
        "          ||            ||      ||- 4:                                                                                           ",
        "          ||            ||      ||CommonProgramFiles=C:\\Program Files\\Common Files                                               ",
        "          ||            ||      ||- 5:                                                                                           ",
        "          ||            ||      ||COMPUTERNAME=BILLY-DB5B96DD3                                                                   ",
        "          ||            ||      ||- 6:                                                                                           ",
        "          ||            ||      ||ComSpec=C:\\WINDOWS\\system32\\cmd.exe                                                            ",
        "          ||            ||      ||- 7:                                                                                           ",
        "          ||            ||      ||FP_NO_HOST_CHECK=NO                                                                            ",
        "          ||            ||      ||- 8:                                                                                           ",
        "          ||            ||      ||HOMEDRIVE=C:                                                                                   ",
        "          ||            ||      ||- 9:                                                                                           ",
        "          ||            ||      ||HOMEPATH=\\Documents and Settings\\Administrator                                                 ",
        "          ||            ||      ||- 10:                                                                                          ",
        "          ||            ||      ||LOGONSERVER=\\\\BILLY-DB5B96DD3                                                                  ",
        "          ||            ||      ||- 11:                                                                                          ",
        "          ||            ||      ||NUMBER_OF_PROCESSORS=1                                                                         ",
        "          ||            ||      ||- 12:                                                                                          ",
        "          ||            ||      ||OS=Windows_NT                                                                                  ",
        "          ||            ||      ||- 13:                                                                                          ",
        "          ||            ||      ||Path=C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem                                   ",
        "          ||            ||      ||- 14:                                                                                          ",
        "          ||            ||      ||PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH                                       ",
        "          ||            ||      ||- 15:                                                                                          ",
        "          ||            ||      ||PROCESSOR_ARCHITECTURE=x86                                                                     ",
        "          ||            ||      ||- 16:                                                                                          ",
        "          ||            ||      ||PROCESSOR_IDENTIFIER=x86 Family 6 Model 23 Stepping 10, GenuineIntel                           ",
        "          ||            ||      ||- 17:                                                                                          ",
        "          ||            ||      ||PROCESSOR_LEVEL=6                                                                              ",
        "          ||            ||      ||- 18:                                                                                          ",
        "          ||            ||      ||PROCESSOR_REVISION=170a                                                                        ",
        "          ||            ||      ||- 19:                                                                                          ",
        "          ||            ||      ||ProgramFiles=C:\\Program Files                                                                  ",
        "          ||            ||      ||- 20:                                                                                          ",
        "          ||            ||      ||SESSIONNAME=Console                                                                            ",
        "          ||            ||      ||- 21:                                                                                          ",
        "          ||            ||      ||SystemDrive=C:                                                                                 ",
        "          ||            ||      ||- 22:                                                                                          ",
        "          ||            ||      ||SystemRoot=C:\\WINDOWS                                                                          ",
        "          ||            ||      ||- 23:                                                                                          ",
        "          ||            ||      ||TEMP=C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp                                                        ",
        "          ||            ||      ||- 24:                                                                                          ",
        "          ||            ||      ||TMP=C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp                                                         ",
        "          ||            ||      ||- 25:                                                                                          ",
        "          ||            ||      ||USERDOMAIN=BILLY-DB5B96DD3                                                                     ",
        "          ||            ||      ||- 26:                                                                                          ",
        "          ||            ||      ||USERNAME=Administrator                                                                         ",
        "          ||            ||      ||- 27:                                                                                          ",
        "          ||            ||      ||USERPROFILE=C:\\Documents and Settings\\Administrator                                            ",
        "          ||            ||      ||- 28:                                                                                          ",
        "          ||            ||      ||windir=C:\\WINDOWS                                                                              ",
        "---------------",
        "Ordered comparison. Should not include 216",
        "**********************",
        "select _EPROCESS as x from pslist() where x.pid < 216",
        "            x             ",
        "--------------------------",
        "0x810b1660||System||     4",
        "---------------",
        "Ordered comparison. Should include 216",
        "**********************",
        "select _EPROCESS as x from pslist() where x.pid <= 216",
        "             x             ",
        "---------------------------",
        "0x810b1660||System||      4",
        "0xff25a7e0||alg.exe||   216",
        "---------------",
        "Ordered comparison. Should not include 216",
        "**********************",
        "select _EPROCESS as x from pslist() where x.pid > 216",
        "                 x                 ",
        "-----------------------------------",
        "0xff3667e8||VMwareTray.exe||    432",
        "0xff374980||VMwareUser.exe||    452",
        "0x80f94588||wuauclt.exe||       468",
        "0xff2ab020||smss.exe||          544",
        "0xff1ecda0||csrss.exe||         608",
        "0xff1ec978||winlogon.exe||      632",
        "0xff247020||services.exe||      676",
        "0xff255020||lsass.exe||         688",
        "0xff27d4d0||wmiprvse.exe||      828",
        "0xff218230||vmacthlp.exe||      844",
        "0x80ff88d8||svchost.exe||       856",
        "0xff364310||wscntfy.exe||       888",
        "0xff217560||svchost.exe||       936",
        "0x80fbf910||svchost.exe||      1028",
        "0xff38b5f8||TPAutoConnect.e||  1084",
        "0xff22d558||svchost.exe||      1088",
        "0xff203b80||svchost.exe||      1148",
        "0xff1d7da0||spoolsv.exe||      1432",
        "0xff1b8b28||vmtoolsd.exe||     1668",
        "0xff3865d0||explorer.exe||     1724",
        "0x80f60da0||wuauclt.exe||      1732",
        "0xff1fdc88||VMUpgradeHelper||  1788",
        "0xff143b28||TPAutoConnSvc.e||  1968",
        "---------------",
        "Ordered comparison. Should include 216",
        "**********************",
        "select _EPROCESS as x from pslist() where x.pid >= 216",
        "                 x                 ",
        "-----------------------------------",
        "0xff25a7e0||alg.exe||           216",
        "0xff3667e8||VMwareTray.exe||    432",
        "0xff374980||VMwareUser.exe||    452",
        "0x80f94588||wuauclt.exe||       468",
        "0xff2ab020||smss.exe||          544",
        "0xff1ecda0||csrss.exe||         608",
        "0xff1ec978||winlogon.exe||      632",
        "0xff247020||services.exe||      676",
        "0xff255020||lsass.exe||         688",
        "0xff27d4d0||wmiprvse.exe||      828",
        "0xff218230||vmacthlp.exe||      844",
        "0x80ff88d8||svchost.exe||       856",
        "0xff364310||wscntfy.exe||       888",
        "0xff217560||svchost.exe||       936",
        "0x80fbf910||svchost.exe||      1028",
        "0xff38b5f8||TPAutoConnect.e||  1084",
        "0xff22d558||svchost.exe||      1088",
        "0xff203b80||svchost.exe||      1148",
        "0xff1d7da0||spoolsv.exe||      1432",
        "0xff1b8b28||vmtoolsd.exe||     1668",
        "0xff3865d0||explorer.exe||     1724",
        "0x80f60da0||wuauclt.exe||      1732",
        "0xff1fdc88||VMUpgradeHelper||  1788",
        "0xff143b28||TPAutoConnSvc.e||  1968",
        "---------------",
        "Ordering on timestamps",
        "**********************",
        "select * from pslist() where process_create_time < \"2010-08-11 06:07:00Z\"",
        "",
        "             _EPROCESS             ||ppid ||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "-----------------------------------||-----||------------||------------||----------||------||---------------------||-----------------",
        "0xff25a7e0||alg.exe||           216||676  ||7           ||108         ||0         ||False ||2010-08-11 06:06:39Z ||-                ",
        "0xff2ab020||smss.exe||          544||4    ||3           ||21          ||-         ||False ||2010-08-11 06:06:21Z ||-                ",
        "0xff1ecda0||csrss.exe||         608||544  ||10          ||405         ||0         ||False ||2010-08-11 06:06:23Z ||-                ",
        "0xff1ec978||winlogon.exe||      632||544  ||22          ||519         ||0         ||False ||2010-08-11 06:06:23Z ||-                ",
        "0xff247020||services.exe||      676||632  ||16          ||269         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff255020||lsass.exe||         688||632  ||21          ||348         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff218230||vmacthlp.exe||      844||676  ||1           ||24          ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0x80ff88d8||svchost.exe||       856||676  ||18          ||202         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff364310||wscntfy.exe||       888||1028 ||1           ||27          ||0         ||False ||2010-08-11 06:06:49Z ||-                ",
        "0xff217560||svchost.exe||       936||676  ||9           ||270         ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0x80fbf910||svchost.exe||      1028||676  ||88          ||1395        ||0         ||False ||2010-08-11 06:06:24Z ||-                ",
        "0xff38b5f8||TPAutoConnect.e||  1084||1968 ||1           ||61          ||0         ||False ||2010-08-11 06:06:52Z ||-                ",
        "0xff22d558||svchost.exe||      1088||676  ||7           ||80          ||0         ||False ||2010-08-11 06:06:25Z ||-                ",
        "0xff203b80||svchost.exe||      1148||676  ||15          ||210         ||0         ||False ||2010-08-11 06:06:26Z ||-                ",
        "0xff1d7da0||spoolsv.exe||      1432||676  ||14          ||137         ||0         ||False ||2010-08-11 06:06:26Z ||-                ",
        "0xff1b8b28||vmtoolsd.exe||     1668||676  ||5           ||218         ||0         ||False ||2010-08-11 06:06:35Z ||-                ",
        "0xff1fdc88||VMUpgradeHelper||  1788||676  ||5           ||100         ||0         ||False ||2010-08-11 06:06:38Z ||-                ",
        "0xff143b28||TPAutoConnSvc.e||  1968||676  ||5           ||100         ||0         ||False ||2010-08-11 06:06:39Z ||-                ",
        "---------------",
        "Intersection with timestamps and fancy times  (only wmiprvse.exe)",
        "**********************",
        "select * from pslist() where",
        "    process_create_time > \"14th Aug 2010\" and",
        "    process_create_time < \"5 years ago\"",
        "",
        "           _EPROCESS            ||ppid||thread_count||handle_count||session_id||wow64 || process_create_time ||process_exit_time",
        "--------------------------------||----||------------||------------||----------||------||---------------------||-----------------",
        "0xff27d4d0||wmiprvse.exe||   828||856 ||9           ||214         ||0         ||False ||2010-08-15 19:26:08Z ||-                "
    ],
    "return_code": 0,
    "time_used": 12.681154012680054
}