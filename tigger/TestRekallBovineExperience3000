#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /home/mic/projects/rekall-test/tigger/output/TestRekallBovineExperience3000 /home/mic/projects/rekall-test/tigger/TestRekallBovineExperience3000
elif [ "$1" == "meld" ]; then
   meld /home/mic/projects/rekall-test/tigger/output/TestRekallBovineExperience3000 /home/mic/projects/rekall-test/tigger/TestRekallBovineExperience3000
elif [ "$1" == "diff" ]; then
   diff /home/mic/projects/rekall-test/tigger/output/TestRekallBovineExperience3000 /home/mic/projects/rekall-test/tigger/TestRekallBovineExperience3000
elif [ "$1" == "run" ]; then
   rekall  -v --cache_dir '/home/mic/projects/rekall-test/tigger/../profile_cache/' --cache 'memory' --name_resolution_strategies 'Module' 'Symbol' --filename '/home/mic/projects/rekall-test/tigger/tigger.vmem.E01' --format 'test' - moo
else
   less /home/mic/projects/rekall-test/tigger/output/TestRekallBovineExperience3000
fi
exit 0
{
    "errors": {
        "TestRekallBovineExperience3000 testCase": {}
    },
    "executed_command": "rekall  -v --cache_dir '/home/mic/projects/rekall-test/tigger/../profile_cache/' --cache 'memory' --name_resolution_strategies 'Module' 'Symbol' --filename '/home/mic/projects/rekall-test/tigger/tigger.vmem.E01' --format 'test' - moo",
    "failures": {
        "TestRekallBovineExperience3000 testCase": {
            "TestRekallBovineExperience3000 testCase": {
                "failure_info": [
                    "--- \n",
                    "+++ \n",
                    "@@ -65,11 +65,11 @@\n",
                    " 0x0e0000  4  9  9  3  4  8  8  4  1  6  7  5  0  9  2  4  || 0x7000000  M       M       M       M       M       M       M       M           ||",
                    " 0x0f0000  4  7  6  1  4  6  0  6  6  8  0  8  2  2  6     || 0x7800000  M       M       M       M       M       M       M       M           ||",
                    " || 0x8000000  M       M       M       M       M       M       M       M           ||",
                    "-|| 0x8800000  M       M       M       M       M       EdM     Ed      Ed          ||",
                    "+|| 0x8800000  M       M       M       M       M       MEd     Ed      Ed          ||",
                    " || 0x9000000  Ed      Ed      Ed      MEd     Ed      Ed      Ed      Ed          ||",
                    " || 0x9800000  Ed      Ed      Ed      Ed      Ed      Ed      Ed      Ed          ||",
                    " || 0xa000000  Ed      Ed      Ed      Ed      Ed      Ed      Ed      Ed          ||",
                    "-|| 0xa800000  Ed      Ed      Ed      EdRcM   M       M       M       M           ||",
                    "+|| 0xa800000  Ed      Ed      Ed      RdRcM   M       M       M       M           ||",
                    " || 0xb000000  M       M       M       M       M       M       M       M           ||",
                    " || 0xb800000  M       M       M       M       M       M       M       M           ||",
                    " || 0xc000000  M       M       M       M       M       M       M       M           ||",
                    "@@ -90,11 +90,11 @@\n",
                    " ||0x13800000  M       M       M       M       M       M       M       M           ||",
                    " ||0x14000000  M       M       M       M       M       M       M       M           ||",
                    " ||0x14800000  M       M       M       M       M       M       M       M           ||",
                    "-||0x15000000  BdM     M       M       M       M       M       M       M           ||",
                    "+||0x15000000  MBd     M       M       M       M       M       M       M           ||",
                    " ||0x15800000  M       M       M       M       M       M       M       M           ||",
                    " ||0x16000000  M       M       M       M       M       M       M       M           ||",
                    "-||0x16800000  M       M       M       M       M       BdM     Bd      Bd          ||",
                    "-||0x17000000  Bd      MBd     M       MEc     EcMBd   Bd      Bd      Bd          ||",
                    "-||0x17800000  Bd      AMBd    MBd     MBd     Bd      Bd      Bd      Bd          ||",
                    "+||0x16800000  M       M       M       M       M       MBd     Bd      Bd          ||",
                    "+||0x17000000  Bd      MBd     M       MEc     MEcBd   Bd      Bd      Bd          ||",
                    "+||0x17800000  Bd      MBdA    MBd     MBd     Bd      Bd      Bd      Bd          ||",
                    " ||0x18000000  Bd      Bd      Bd      Bd      Bd      Bd      Bd      Bd          ||",
                    "-||0x18800000  Bd      MBcBd   Bc      AXMBd   Bd      Bd      Bd      MBd         ||",
                    "+||0x18800000  Bd      MBdBc   Bc      XMBdA   Bd      Bd      Bd      MBd         ||"
                ],
                "msg": "Traceback (most recent call last):\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 302, in run\n    testMethod()\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 366, in testCase\n    self.assertListEqual(sorted(previous), sorted(current))\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 277, in assertListEqual\n    self.assertEqual(x, y)\nAssertionError: '|| 0[18 chars]M       M       M       M       EdM     Ed      Ed          ||' != '|| 0[18 chars]M       M       M       M       MEd     Ed      Ed          ||'\n- || 0x8800000  M       M       M       M       M       EdM     Ed      Ed          ||\n?                                                         -\n+ || 0x8800000  M       M       M       M       M       MEd     Ed      Ed          ||\n?                                                       +\n\n"
            }
        }
    },
    "logging": [
        "2017-10-31 12:45:08,654:DEBUG:rekall.1:Logging level set to 10",
        "2017-10-31 12:45:08,655:DEBUG:rekall.1:Running plugin (moo) with args (()) kwargs ({})",
        "2017-10-31 12:45:08,656:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-profiles/v1.0/inventory.gz",
        "2017-10-31 12:45:08,709:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/inventory.gz",
        "2017-10-31 12:45:08,838:DEBUG:rekall.1:Opened url https://github.com/google/rekall-profiles/raw/master/v1.0/inventory.gz",
        "2017-10-31 12:45:08,900:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/inventory.gz",
        "2017-10-31 12:45:08,932:DEBUG:rekall.1:Opened url http://profiles.rekall-forensic.com/v1.0/inventory.gz",
        "2017-10-31 12:45:08,987:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/inventory.gz",
        "2017-10-31 12:45:09,026:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/tests/fixtures.gz",
        "2017-10-31 12:45:09,026:ERROR:rekall.1:Cannot parse profile tests/fixtures because of decoding error 'Invalid \\escape: line 7 column 32 (char 114)'.",
        "2017-10-31 12:45:09,027:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-profiles/v1.0/tests/fixtures.gz",
        "2017-10-31 12:45:09,027:DEBUG:rekall.1:Adding tests/fixtures to local cache.",
        "2017-10-31 12:45:09,030:WARNING:rekall.1:Unable to parse profile section fixtures",
        "2017-10-31 12:45:09,030:WARNING:rekall.1:Unable to parse profile section ascii_art",
        "2017-10-31 12:45:09,030:INFO:rekall.1:Loaded profile tests/fixtures from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.020541667938232422 sec)"
    ],
    "options": {
        "--cache": "memory",
        "--cache_dir": "/home/mic/projects/rekall-test/tigger/../profile_cache/",
        "--filename": "/home/mic/projects/rekall-test/tigger/tigger.vmem.E01",
        "--format": "test",
        "--name_resolution_strategies": [
            "Module",
            "Symbol"
        ],
        "commandline": "moo",
        "debug": false,
        "executable": "rekall ",
        "pids": 1724,
        "tempdir": "/tmp/tmpemccy6bm/TestRekallBovineExperience3000Thread-4",
        "test_class": "TestRekallBovineExperience3000",
        "testdir": "/home/mic/projects/rekall-test/tigger"
    },
    "output": [
        "               Dogma               ||                              Bessy                              ||                     Pilsner                      ||  Nowrap  ",
        "-----------------------------------||-----------------------------------------------------------------||--------------------------------------------------||----------",
        "This is a renderer stress-test. The||                                |############                    ||                /\\                                ||This is a fairly long line that shouldn't get wrapped.   ",
        "flags should have correct colors,  ||                                |#####  #####                    ||               / |\\                               ||The same row has another line that shouldn't get wrapped.",
        "the beer should be yellow and the  ||                                |##        ##                    ||              /  | \\                              ||                                                         ",
        "cell on the left should not bleed  ||              _                 |#####  #####                    ||             /   |  \\                             ||                                                         ",
        "into the cell on the right.        ||             / \\_               |############                    ||            /____|   \\                            ||                                                         ",
        "This is a really long column of    ||            /    \\              |                                ||           / \\    \\   \\                           ||                                                         ",
        "text with its own newlines in it!  ||           /\\/\\  /\\  _          |       /;    ;\\                 ||          /   \\    \\  /                           ||                                                         ",
        "This bovine experience has been    ||          /    \\/  \\/ \\         |   __  \\____//                  ||         /     \\    \\/                            ||                                                         ",
        "brought to you by Rekall.          ||        /\\  .-   `. \\  \\        |  /{_\\_/   `'\\____              ||        /       \\   /                             ||                                                         ",
        "                                   ||       /  `-.__ ^   /\\  \\       |  \\___ (o)  (o)   }             ||       /         \\ /                              ||                                                         ",
        "                                   ||      / _____________________________/          :--'             ||      /           v                               ||                                                         ",
        "                                   ||    ,-,'`@@@@@@@@       @@@@@@         \\_    `__\\                ||     /               ( o )o)                      ||                                                         ",
        "                                   ||   ;:(  @@@@@@@@@        @@@             \\___(o'o)               ||    /               ( o )o )o)                    ||                                                         ",
        "                                   ||   :: )  @@@@          @@@@@@        ,'@@(  `===='               ||                  (o( ~~~~~~~~o                   ||                                                         ",
        "                                   ||   :: : @@@@@:          @@@@         `@@@:                       ||                  ( )' ~~~~~~~' _                 ||                                                         ",
        "                                   ||   :: \\  @@@@@:       @@@@@@@)    (  '@@@'                       ||                    o|   o    |-. \\               ||                                                         ",
        "                                   ||   :; /\\      /      @@@@@@@@@\\   :@@@@@)                        ||                    o|     o  |  \\ \\              ||                                                         ",
        "                                   ||   ::/  )    {_----------------:  :~`,~~;                        ||                     | .      |  | |              ||                                                         ",
        "                                   ||  ;; `; :   )                  :  / `; ;                         ||                    o|   .    |  / /              ||                                                         ",
        "                                   || ;;;  : :   ;                  :  ;  ; :                         ||                     |  .  .  |._ /               ||                                                         ",
        "                                   || `'`  / :  :                   :  :  : :                         ||                     .========.                   ||                                                         ",
        "                                   ||     )_ \\__;                   :_ ;  \\_\\                         ||                                                  ||                                                         ",
        "                                   ||     :__\\  \\                   \\  \\  :  \\                        ||                                                  ||                                                         ",
        "                                   ||         `^'                    `^'  `-^-'                       ||                                                  ||                                                         ",
        "",
        "***************** Heatmap test: *****************",
        "                       Random Heatmap                       ||                      Gradual Heatmap                       ||Legend",
        "------------------------------------------------------------||------------------------------------------------------------||------",
        " Offset (p) 00 10 20 30 40 50 60 70 80 90 a0 b0 c0 d0 e0 f0 || Offset (v) 00 10 20 30 40 50 60 70 80 90 a0 b0 c0 d0 e0 f0 || 0.0 || 0.1 || 0.2 || 0.3 || 0.4 || 0.5 || 0.6 || 0.7 || 0.8 || 0.9 || 1.0 ",
        "  0x000000  2  7  1  8  2  8  1  8  2  8  4  5  9  0  4  5  ||  0x000000  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f  ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x010000  2  3  5  3  6  0  2  8  7  4  7  1  3  5  2  6  ||  0x010000  10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x020000  6  2  4  9  7  7  5  7  2  4  7  0  9  3  6  9  ||  0x020000  20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x030000  9  9  5  9  5  7  4  9  6  6  9  6  7  6  2  7  ||  0x030000  30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x040000  7  2  4  0  7  6  6  3  0  3  5  3  5  4  7  5  ||  0x040000  40 41 42 43 44 45 46 47 48 49 4a 4b 4c 4d 4e 4f ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x050000  9  4  5  7  1  3  8  2  1  7  8  5  2  5  1  6  ||  0x050000  50 51 52 53 54 55 56 57 58 59 5a 5b 5c 5d 5e 5f ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x060000  6  4  2  7  4  2  7  4  6  6  3  9  1  9  3  2  ||  0x060000  60 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x070000  0  0  3  0  5  9  9  2  1  8  1  7  4  1  3  5  ||  0x070000  70 71 72 73 74 75 76 77 78 79 7a 7b 7c 7d 7e 7f ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x080000  9  6  6  2  9  0  4  3  5  7  2  9  0  0  3  3  ||  0x080000  80 81 82 83 84 85 86 87 88 89 8a 8b 8c 8d 8e 8f ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x090000  4  2  9  5  2  6  0  5  9  5  6  3  0  7  3  8  ||  0x090000  90 91 92 93 94 95 96 97 98 99 9a 9b 9c 9d 9e 9f ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x0a0000  1  3  2  3  2  8  6  2  7  9  4  3  4  9  0  7  ||  0x0a0000  a0 a1 a2 a3 a4 a5 a6 a7 a8 a9 aa ab ac ad ae af ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x0b0000  6  3  2  3  3  8  2  9  8  8  0  7  5  3  1  9  ||  0x0b0000  b0 b1 b2 b3 b4 b5 b6 b7 b8 b9 ba bb bc bd be bf ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x0c0000  5  2  5  1  0  1  9  0  1  1  5  7  3  8  3  4  ||  0x0c0000  c0 c1 c2 c3 c4 c5 c6 c7 c8 c9 ca cb cc cd ce cf ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x0d0000  1  8  7  9  3  0  7  0  2  1  5  4  0  8  9  1  ||  0x0d0000  d0 d1 d2 d3 d4 d5 d6 d7 d8 d9 da db dc dd de df ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x0e0000  4  9  9  3  4  8  8  4  1  6  7  5  0  9  2  4  ||  0x0e0000  e0 e1 e2 e3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "  0x0f0000  4  7  6  1  4  6  0  6  6  8  0  8  2  2  6     ||  0x0f0000  f0 f1 f2 f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ||     ",
        "                      Greyscale Random                      ||                                 Memory Ranges                                  ||        Ranges Legend         ",
        "------------------------------------------------------------||--------------------------------------------------------------------------------||------------------------------",
        " Offset (p) 00 10 20 30 40 50 60 70 80 90 a0 b0 c0 d0 e0 f0 || Offset (p) +000000 +100000 +200000 +300000 +400000 +500000 +600000 +700000     || kEfiACPIMemoryNVS (A) ",
        "  0x000000  2  7  1  8  2  8  1  8  2  8  4  5  9  0  4  5  ||       0x0  M       M       M       M       M       M       M       M           || kEfiACPIReclaimMemory (A) ",
        "  0x010000  2  3  5  3  6  0  2  8  7  4  7  1  3  5  2  6  ||  0x800000  M       M       M       M       M       M       M       M           || kEfiBootServicesCode (Bc) ",
        "  0x020000  6  2  4  9  7  7  5  7  2  4  7  0  9  3  6  9  || 0x1000000  M       M       M       M       M       M       M       M           || kEfiBootServicesData (Bd) ",
        "  0x030000  9  9  5  9  5  7  4  9  6  6  9  6  7  6  2  7  || 0x1800000  M       M       M       M       M       M       M       M           || kEfiConventionalMemory (M) ",
        "  0x040000  7  2  4  0  7  6  6  3  0  3  5  3  5  4  7  5  || 0x2000000  Bd      Bd      Bd      Bd      Bd      Bd      M       M           || kEfiLoaderCode (Ec) ",
        "  0x050000  9  4  5  7  1  3  8  2  1  7  8  5  2  5  1  6  || 0x2800000  M       M       M       M       M       M       M       M           || kEfiLoaderData (Ed) ",
        "  0x060000  6  4  2  7  4  2  7  4  6  6  3  9  1  9  3  2  || 0x3000000  M       M       M       M       M       M       M       M           || kEfiReservedMemoryType (X) ",
        "  0x070000  0  0  3  0  5  9  9  2  1  8  1  7  4  1  3  5  || 0x3800000  M       M       M       M       M       M       M       M           || kEfiRuntimeServicesCode (Rc) ",
        "  0x080000  9  6  6  2  9  0  4  3  5  7  2  9  0  0  3  3  || 0x4000000  M       M       M       M       M       M       M       M           || kEfiRuntimeServicesData (Rd) ",
        "  0x090000  4  2  9  5  2  6  0  5  9  5  6  3  0  7  3  8  || 0x4800000  M       M       M       M       M       M       M       M           ||                              ",
        "  0x0a0000  1  3  2  3  2  8  6  2  7  9  4  3  4  9  0  7  || 0x5000000  M       M       M       M       M       M       M       M           ||                              ",
        "  0x0b0000  6  3  2  3  3  8  2  9  8  8  0  7  5  3  1  9  || 0x5800000  M       M       M       M       M       M       M       M           ||                              ",
        "  0x0c0000  5  2  5  1  0  1  9  0  1  1  5  7  3  8  3  4  || 0x6000000  M       M       M       M       M       M       M       M           ||                              ",
        "  0x0d0000  1  8  7  9  3  0  7  0  2  1  5  4  0  8  9  1  || 0x6800000  M       M       M       M       M       M       M       M           ||                              ",
        "  0x0e0000  4  9  9  3  4  8  8  4  1  6  7  5  0  9  2  4  || 0x7000000  M       M       M       M       M       M       M       M           ||                              ",
        "  0x0f0000  4  7  6  1  4  6  0  6  6  8  0  8  2  2  6     || 0x7800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0x8000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0x8800000  M       M       M       M       M       MEd     Ed      Ed          ||                              ",
        "                                                            || 0x9000000  Ed      Ed      Ed      MEd     Ed      Ed      Ed      Ed          ||                              ",
        "                                                            || 0x9800000  Ed      Ed      Ed      Ed      Ed      Ed      Ed      Ed          ||                              ",
        "                                                            || 0xa000000  Ed      Ed      Ed      Ed      Ed      Ed      Ed      Ed          ||                              ",
        "                                                            || 0xa800000  Ed      Ed      Ed      RdRcM   M       M       M       M           ||                              ",
        "                                                            || 0xb000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0xb800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0xc000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0xc800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0xd000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0xd800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0xe000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0xe800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0xf000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            || 0xf800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x10000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x10800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x11000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x11800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x12000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x12800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x13000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x13800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x14000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x14800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x15000000  MBd     M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x15800000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x16000000  M       M       M       M       M       M       M       M           ||                              ",
        "                                                            ||0x16800000  M       M       M       M       M       MBd     Bd      Bd          ||                              ",
        "                                                            ||0x17000000  Bd      MBd     M       MEc     MEcBd   Bd      Bd      Bd          ||                              ",
        "                                                            ||0x17800000  Bd      MBdA    MBd     MBd     Bd      Bd      Bd      Bd          ||                              ",
        "                                                            ||0x18000000  Bd      Bd      Bd      Bd      Bd      Bd      Bd      Bd          ||                              ",
        "                                                            ||0x18800000  Bd      MBdBc   Bc      XMBdA   Bd      Bd      Bd      MBd         ||                              "
    ],
    "return_code": 0,
    "time_used": 2.225865602493286
}