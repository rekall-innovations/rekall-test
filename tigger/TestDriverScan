#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /home/scudette/projects/rekall-test/tigger/output/TestDriverScan /home/scudette/projects/rekall-test/tigger/TestDriverScan
elif [ "$1" == "meld" ]; then
   meld /home/scudette/projects/rekall-test/tigger/output/TestDriverScan /home/scudette/projects/rekall-test/tigger/TestDriverScan
elif [ "$1" == "diff" ]; then
   diff /home/scudette/projects/rekall-test/tigger/output/TestDriverScan /home/scudette/projects/rekall-test/tigger/TestDriverScan
elif [ "$1" == "run" ]; then
   rekall  --cache_dir '/home/scudette/projects/rekall-test/tigger/../profile_cache/' --format 'test' --filename '/home/scudette/projects/rekall-test/tigger/tigger.vmem.E01' --name_resolution_strategies 'Module' 'Symbol' - driverscan
else
   less /home/scudette/projects/rekall-test/tigger/output/TestDriverScan
fi
exit 0
{
    "errors": {}, 
    "time_used": 4.262048006057739, 
    "return_code": 0, 
    "failures": {
        "testCase (__main__.TestDriverScan)": "Traceback (most recent call last):\n  File \"/home/scudette/rekall/rekall/testlib.py\", line 233, in run\n    testMethod()\n  File \"/home/scudette/rekall/rekall/testlib.py\", line 283, in testCase\n    self.assertEqual(previous, current)\nAssertionError: 102 != 103\n"
    }, 
    "output": [
        "-||Offset(P) ||#Ptr||#Hnd||  Start   ||   Size   ||    Service Key     ||    Name    ||Driver Name", 
        " ||----------||----||----||----------||----------||--------------------||------------||-----------", 
        " ||0x01058388||   4||   0||0xfc76b000||    0x6b00||Fdc                 ||Fdc         ||\\Driver\\Fdc", 
        " ||0x01058e28||   4||   0||0xfc93b000||    0x3c80||serenum             ||serenum     ||\\Driver\\serenum", 
        " ||0x01059258||   4||   0||0xfc54b000||    0xfd80||Serial              ||Serial      ||\\Driver\\Serial", 
        " ||0x010593e8||   4||   0||0xfc121000||   0x13900||Parport             ||Parport     ||\\Driver\\Parport", 
        " ||0x0106fca0||   3||   0||0xf3a85000||   0x20f00||IpNat               ||IpNat       ||\\Driver\\IpNat", 
        " ||0x0108ef38||   2||   0||0x00000000||       0x0||tmryqyrznr2.sys     ||tmryqyrznr2.||           ", 
        " ||          ||    ||    ||          ||          ||                    ||sys         ||           ", 
        " ||0x010ac3b0||   3||   0||0xfc4eb000||    0xa580||agp440              ||agp440      ||\\Driver\\agp440", 
        " ||0x010adf38||   5||   0||0xfbf82000||   0x30100||rdpdr               ||rdpdr       ||\\Driver\\rdpdr", 
        " ||0x010aee28||   3||   0||0xfbf4e000||   0x33200||Update              ||Update      ||\\Driver\\Update", 
        " ||0x010b2158||   7||   0||0xf3ba9000||   0x57a80||Tcpip               ||Tcpip       ||\\Driver\\Tcpip", 
        " ||0x010b6ac8||   3||   0||0xfc62b000||    0x9480||NDProxy             ||NDProxy     ||\\Driver\\NDProxy", 
        " ||0x010cd5f8||   5||   0||0xfc211000||   0x8c480||Ntfs                ||Ntfs        ||\\FileSystem\\Ntfs", 
        " ||0x010cdd28||   3||   0||0xfc29e000||   0x16780||KSecDD              ||KSecDD      ||\\Driver\\KSecDD", 
        " ||0x010cdf38||   7||   0||0xfc2b5000||   0x11f00||sr                  ||sr          ||\\FileSystem\\sr", 
        " ||0x01105718||   3||   0||0xfc5bb000||    0x8d00||intelppm            ||intelppm    ||\\Driver\\intelppm", 
        " ||0x01105ae0||   3||   0||0xfc943000||    0x3700||CmBatt              ||CmBatt      ||\\Driver\\CmBatt", 
        " ||0x01105df0||   4||   0||0xfc78b000||    0x6800||usbehci             ||usbehci     ||\\Driver\\usbehci", 
        " ||0x01106318||   4||   0||0xfc59b000||    0x9f00||es1371              ||es1371      ||\\Driver\\es1371", 
        " ||0x01106d58||   3||   0||0xfc783000||    0x7600||vmxnet              ||vmxnet      ||\\Driver\\vmxnet", 
        " ||0x011076c0||   4||   0||0xfc77b000||    0x5000||usbuhci             ||usbuhci     ||\\Driver\\usbuhci", 
        " ||0x01107918||   4||   0||0xfc773000||    0x5380||vmx_svga            ||vmx_svga    ||\\Driver\\vmx_svga", 
        " ||0x01107b78||   3||   0||0xfc58b000||    0xd600||vmci                ||vmci        ||\\Driver\\vmci", 
        " ||0x01108030||   3||   0||0xfc56b000||    0xc180||Cdrom               ||Cdrom       ||\\Driver\\Cdrom", 
        " ||0x01108db8||   4||   0||0xfc57b000||    0xe080||redbook             ||redbook     ||\\Driver\\redbook", 
        " ||0x011099a0||   3||   0||0xfc55b000||    0xa380||Imapi               ||Imapi       ||\\Driver\\Imapi", 
        " ||0x0110a790||   6||   0||0xfc763000||    0x5a00||Mouclass            ||Mouclass    ||\\Driver\\Mouclass", 
        " ||0x0110a888||   3||   0||0xfc9a3000||    0x1280||vmmouse             ||vmmouse     ||\\Driver\\vmmouse", 
        " ||0x0110b2a8||   5||   0||0xfc75b000||    0x6000||Kbdclass            ||Kbdclass    ||\\Driver\\Kbdclass", 
        " ||0x0110b940||   5||   0||0xfc53b000||    0xce00||i8042prt            ||i8042prt    ||\\Driver\\i8042prt", 
        " ||0x0110c5f0||   8||   0||0xfc9a5000||    0x1100||swenum              ||swenum      ||\\Driver\\swenum", 
        " ||0x01110b40||   3||   0||0xfc67b000||    0x8880||Fips                ||Fips        ||\\Driver\\Fips", 
        " ||0x01114f38||   4||   0||0xfbf3e000||    0x2f80||mouhid              ||mouhid      ||\\Driver\\mouhid", 
        " ||0x01129238||   9||   0||0xfc2fe000||   0x17480||atapi               ||atapi       ||\\Driver\\atapi", 
        " ||0x01129548||   5||   0||0xfc4bb000||    0xcc80||VolSnap             ||VolSnap     ||\\Driver\\VolSnap", 
        " ||0x01129640||   4||   0||0xfc723000||    0x4900||PartMgr             ||PartMgr     ||\\Driver\\PartMgr", 
        " ||0x0112a5c0||   6||   0||0xfc316000||   0x25700||dmio                ||dmio        ||\\Driver\\dmio", 
        " ||0x0112a7d8||   3||   0||0xfc9a1000||    0x1700||dmload              ||dmload      ||\\Driver\\dmload", 
        " ||0x0112aaa0||   6||   0||0xfc33c000||   0x1e880||Ftdisk              ||Ftdisk      ||\\Driver\\Ftdisk", 
        " ||0x0112c1a8||  81||   0||0xfc35b000||   0x10a80||PCI                 ||PCI         ||\\Driver\\PCI", 
        " ||0x01135670||   3||   0||0xfc7a3000||    0x4080||Raspti              ||Raspti      ||\\Driver\\Raspti", 
        " ||0x0114e3b0||   3||   0||0xfc170000||    0x2f00||WS2IFSL             ||WS2IFSL     ||\\Driver\\WS2IFSL", 
        " ||0x0114ef38||   5||   0||0xfc61b000||    0x9f00||TermDD              ||TermDD      ||\\Driver\\TermDD", 
        " ||0x011501c0||   6||   0||0xfc79b000||    0x4580||Ptilink             ||Ptilink     ||\\Driver\\Ptilink", 
        " ||0x0117b670||   4||   0||0xfc2c7000||   0x1e780||FltMgr              ||FltMgr      ||\\FileSystem\\FltMgr", 
        " ||0x0117fcc8||   6||   0||0xfc4cb000||    0x8e00||Disk                ||Disk        ||\\Driver\\Disk", 
        " ||0x01181490||   5||   0||0xfc8b7000||    0x2c00||vmscsi              ||vmscsi      ||\\Driver\\vmscsi", 
        " ||0x01185198||   4||   0||0xfc8af000||    0x2480||Compbatt            ||Compbatt    ||\u0000          ", 
        " ||0x01190ab0||   5||   0||0xfc1c9000||   0x1a580||Mup                 ||Mup         ||\\FileSystem\\Mup", 
        " ||0x01190f38||  17||   0||0xfc1e4000||   0x2ca80||NDIS                ||NDIS        ||\\Driver\\NDIS", 
        " ||0x01233af8||  63||   0||0xfc36c000||   0x2dd80||ACPI                ||ACPI        ||\\Driver\\ACPI", 
        " ||0x01233f38||   5||   0||0x00000000||       0x0||                    ||RAW         ||\\FileSystem\\RAW", 
        " ||0x01234770||   4||   0||0x00000000||       0x0||\\Driver\\WMIxWDM     ||WMIxWDM     ||\\Driver\\WMIxWDM", 
        " ||0x01234ab8||   4||   0||0x00000000||       0x0||\\Driver\\ACPI_HAL    ||ACPI_HAL    ||\\Driver\\ACPI_HAL", 
        " ||0x01238338||  57||   0||0x00000000||       0x0||\\Driver\\PnpManager  ||PnpManager  ||\\Driver\\PnpManager", 
        " ||0x020ac150||   4||   0||0xfc49b000||    0x8c00||isapnp              ||isapnp      ||\\Driver\\isapnp", 
        " ||0x020ba228||   7||   0||0xfc4ab000||    0xa500||MountMgr            ||MountMgr    ||\\Driver\\MountMgr", 
        " ||0x021216a8||   5||   0||0xfc99f000||    0x1580||IntelIde            ||IntelIde    ||\u0000          ", 
        " ||0x02e2c318||   5||   0||0xf329c000||   0x40380||HTTP                ||HTTP        ||\\Driver\\HTTP", 
        " ||0x03fc7030||   7||   0||0xfcbef000||     0xc00||audstub             ||audstub     ||\\Driver\\audstub", 
        " ||0x03fc7960||   3||   0||0xfc5cb000||    0xc880||Rasl2tp             ||Rasl2tp     ||\\Driver\\Rasl2tp", 
        " ||0x04032448||   3||   0||0xfc5db000||    0xa200||RasPppoe            ||RasPppoe    ||\\Driver\\RasPppoe", 
        " ||0x040327b0||   3||   0||0xfc967000||    0x3c80||mssmbios            ||mssmbios    ||\\Driver\\mssmbios", 
        " ||0x04032cb8||   4||   0||0xfc08c000||   0x16680||NdisWan             ||NdisWan     ||\\Driver\\NdisWan", 
        " ||0x04032ec8||   6||   0||0xfc947000||    0x2580||NdisTapi            ||NdisTapi    ||\\Driver\\NdisTapi", 
        " ||0x041643e0||   3||   0||0xfc5fb000||    0x8900||Gpc                 ||Gpc         ||\\Driver\\Gpc", 
        " ||0x04164558||   5||   0||0xfc053000||   0x10e00||PSched              ||PSched      ||\\Driver\\PSched", 
        " ||0x041647d0||   3||   0||0xfc5eb000||    0xbd00||PptpMiniport        ||PptpMiniport||\\Driver\\PptpMiniport", 
        " ||0x041ddf38||   3||   0||0xfc7c3000||    0x4a80||Msfs                ||Msfs        ||\\FileSystem\\Msfs", 
        " ||0x041ed408||   5||   0||0xf3b81000||   0x27c00||NetBT               ||NetBT       ||\\Driver\\NetBT", 
        " ||0x0438bcc0||   7||   0||0xfc9af000||    0x1f00||Fs_Rec              ||Fs_Rec      ||\\FileSystem\\Fs_Rec", 
        " ||0x0438e030||   4||   0||0xf3aa6000||   0x6e380||MRxSmb              ||MRxSmb      ||\\FileSystem\\MRxSmb", 
        " ||0x043d1030||   3||   0||0xf3b15000||   0x2b180||Rdbss               ||Rdbss       ||\\FileSystem\\Rdbss", 
        " ||0x044180e8||   3||   0||0xfc190000||    0x2980||gameenum            ||gameenum    ||\\Driver\\gameenum", 
        " ||0x0486eca8||   5||   0||0xf3147000||   0x14400||wdmaud              ||wdmaud      ||\\Driver\\wdmaud", 
        " ||0x048f8da0||   3||   0||0xf3c01000||   0x12400||IPSec               ||IPSec       ||\\Driver\\IPSec", 
        " ||0x048f9030||   4||   0||0xf3b41000||   0x1da80||vmhgfs              ||vmhgfs      ||\\FileSystem\\vmhgfs", 
        " ||0x0493f880||   3||   0||0xf337d000||    0xed80||sysaudio            ||sysaudio    ||\\Driver\\sysaudio", 
        " ||0x04a49270||   0||   0||0xf2fe0000||   0x29f00||\ub2e8\uff1e\u3c88\uff23\u61d8\u77e4              ||            ||\u0000          ", 
        " ||0x04a49880||   3||   0||0xfc174000||    0x2280||RasAcd              ||RasAcd      ||\\Driver\\RasAcd", 
        " ||0x04a96ca8||   3||   0||0xfc9b3000||    0x1080||mnmdd               ||mnmdd       ||\\Driver\\mnmdd", 
        " ||0x04b60a18||   3||   0||0xfc9b5000||    0x1080||RDPCDD              ||RDPCDD      ||\\Driver\\RDPCDD", 
        " ||0x04be4b10||   3||   0||0xfcac9000||     0xb80||Null                ||Null        ||\\Driver\\Null", 
        " ||0x04be5550||   3||   0||0xfc7bb000||    0x5200||VgaSave             ||VgaSave     ||\\Driver\\VgaSave", 
        " ||0x04be6030||   3||   0||0xf3b5f000||   0x21d00||AFD                 ||AFD         ||\\Driver\\AFD", 
        " ||0x04be65f0||   3||   0||0xfc9b1000||    0x1080||Beep                ||Beep        ||\\Driver\\Beep", 
        " ||0x04be6a18||   3||   0||0xfc7cb000||    0x7880||Npfs                ||Npfs        ||\\FileSystem\\Npfs", 
        " ||0x04bf9520||   3||   0||0xfc7ab000||    0x5000||Flpydisk            ||Flpydisk    ||\\Driver\\Flpydisk", 
        " ||0x04c2b030||   3||   0||0xfc65b000||    0x8700||NetBIOS             ||NetBIOS     ||\\FileSystem\\NetBIOS", 
        " ||0x04c2e4b0||   3||   0||0xfc6bb000||    0xf900||Cdfs                ||Cdfs        ||\\FileSystem\\Cdfs", 
        " ||0x04d699c0||   7||   0||0xfc64b000||    0xe100||usbhub              ||usbhub      ||\\Driver\\usbhub", 
        " ||0x05e36740||   5||   0||0xf2ef5000||   0x23000||Fastfat             ||Fastfat     ||\\FileSystem\\Fastfat", 
        " ||0x05f45030||   3||   0||0xf35d8000||   0x2c400||MRxDAV              ||MRxDAV      ||\\FileSystem\\MRxDAV", 
        " ||0x05f46030||   3||   0||0xfc9f7000||    0x1e00||VMMEMCTL            ||VMMEMCTL    ||\\Driver\\VMMEMCTL", 
        " ||0x05f8b030||   3||   0||0xfc9f5000||    0x1a80||ParVdm              ||ParVdm      ||\\Driver\\ParVdm", 
        " ||0x05fd22d8||   3||   0||0xf355d000||   0x52180||Srv                 ||Srv         ||\\FileSystem\\Srv", 
        " ||0x06384d18||  13||   0||0x00000000||       0x0||\\Driver\\Win32k      ||Win32k      ||\\Driver\\Win32k", 
        " ||0x065a24c8||   3||   0||0xf386d000||    0x3280||Ndisuio             ||Ndisuio     ||\\Driver\\Ndisuio", 
        " ||0x06901030||   6||   0||0xfbf42000||    0x2580||hidusb              ||hidusb      ||\\Driver\\hidusb", 
        " ||0x06944030||   5||   0||0xfc7e3000||    0x7b80||usbccgp             ||usbccgp     ||\\Driver\\usbccgp", 
        " ||0x069d4f38||   3||   0||0xfc68b000||    0x8700||Wanarp              ||Wanarp      ||\\Driver\\Wanarp"
    ], 
    "options": {
        "--name_resolution_strategies": [
            "Module", 
            "Symbol"
        ], 
        "executable": "rekall ", 
        "--filename": "/home/scudette/projects/rekall-test/tigger/tigger.vmem.E01", 
        "--format": "test", 
        "commandline": "driverscan", 
        "pid": 1724, 
        "test_class": "TestDriverScan", 
        "--cache_dir": "/home/scudette/projects/rekall-test/tigger/../profile_cache/", 
        "tempdir": "/tmp/tmpIP_zzM/TestDriverScanThread-4", 
        "executed_command": "rekall  --cache_dir '/home/scudette/projects/rekall-test/tigger/../profile_cache/' --format 'test' --filename '/home/scudette/projects/rekall-test/tigger/tigger.vmem.E01' --name_resolution_strategies 'Module' 'Symbol' - driverscan", 
        "testdir": "/home/scudette/projects/rekall-test/tigger"
    }
}