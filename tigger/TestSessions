#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /Users/scudette/projects/rekall-test/tigger/output/TestSessions /Users/scudette/projects/rekall-test/tigger/TestSessions
elif [ "$1" == "meld" ]; then
   meld /Users/scudette/projects/rekall-test/tigger/output/TestSessions /Users/scudette/projects/rekall-test/tigger/TestSessions
elif [ "$1" == "diff" ]; then
   diff /Users/scudette/projects/rekall-test/tigger/output/TestSessions /Users/scudette/projects/rekall-test/tigger/TestSessions
elif [ "$1" == "run" ]; then
   rekall  -v --cache 'memory' --cache_dir '/Users/scudette/projects/rekall-test/tigger/../profile_cache/' --format 'test' --filename '/Users/scudette/projects/rekall-test/tigger/tigger.vmem.E01' --name_resolution_strategies 'Module' 'Symbol' - sessions
else
   less /Users/scudette/projects/rekall-test/tigger/output/TestSessions
fi
exit 0
{
    "errors": {}, 
    "logging": [
        "DEBUG:rekall.1:Logging level set to 10", 
        "DEBUG:rekall.1:Voting round with base: None", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: No base address space provided", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ", 
        "DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Must stack on another address space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMemAddressSpace: No base address space provided", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating EWFAddressSpace: No base address space provided", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Must stack on another address space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Must stack on another address space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: No base address space provided", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: No base address space provided", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ", 
        "DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Must stack on another address space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Must be layered on another address space.", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Unable to open AFF4 volume", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pmem.MacPmemAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating MacPmemAddressSpace: MacPmem would declare a YML device at /Users/scudette/projects/rekall-test/tigger/tigger.vmem.E01_info", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ", 
        "DEBUG:rekall.1:Succeeded instantiating FileAddressSpace", 
        "DEBUG:rekall.1:Voting round with base: FileAddressSpace", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0x9465645", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ", 
        "DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ", 
        "DEBUG:rekall.1:Succeeded instantiating EWFAddressSpace", 
        "DEBUG:rekall.1:Voting round with base: EWFAddressSpace", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0xf000ff53", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ", 
        "DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating EWFAddressSpace: EWF signature not present", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ", 
        "DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Invalid Lime header signature", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Must stack on another address space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pmem.MacPmemAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating MacPmemAddressSpace: Must be mapped directly over a raw device.", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating FileAddressSpace: Must be first Address Space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.mmap_address_space.MmapFileAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating MmapFileAddressSpace: Must be first Address Space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.amd64.VTxPagedMemory'> ", 
        "DEBUG:rekall.1:Failed instantiating VTxPagedMemory: No more EPTs specified", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.GlobalOffsetAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating GlobalOffsetAddressSpace: File offset not specified.", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pagefile.PagefilePhysicalAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating PagefilePhysicalAddressSpace: Pagefile not specified", 
        "INFO:rekall.1:Autodetected physical address space EWFAddressSpace", 
        "DEBUG:rekall.1:Will detect profile using these Detectors: nt_index,osx,pe,windows_kernel_file,rsds,ntfs,linux", 
        "DEBUG:rekall.1:Opened url https://raw.githubusercontent.com/google/rekall-profiles/master/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Opened url http://profiles.rekall-forensic.com/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/nt/eprocess_index.gz", 
        "INFO:rekall.1:Loaded profile nt/eprocess_index from Local Cache Directory:/Users/scudette/projects/rekall-test/profile_cache (in 0.0100250244141 sec)", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/nt/index.gz", 
        "INFO:rekall.1:Loaded profile nt/index from Local Cache Directory:/Users/scudette/projects/rekall-test/profile_cache (in 0.0172319412231 sec)", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/OSX/index.gz", 
        "INFO:rekall.1:Loaded profile OSX/index from Local Cache Directory:/Users/scudette/projects/rekall-test/profile_cache (in 0.000864028930664 sec)", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/pe.gz", 
        "INFO:rekall.1:Loaded profile pe from Local Cache Directory:/Users/scudette/projects/rekall-test/profile_cache (in 0.030711889267 sec)", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/ntfs.gz", 
        "INFO:rekall.1:Loaded profile ntfs from Local Cache Directory:/Users/scudette/projects/rekall-test/profile_cache (in 0.00221395492554 sec)", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/nt/GUID/BD8F451F3E754ED8A34B50560CEB08E31.gz", 
        "INFO:rekall.1:Loaded profile nt/GUID/BD8F451F3E754ED8A34B50560CEB08E31 from Local Cache Directory:/Users/scudette/projects/rekall-test/profile_cache (in 0.388835906982 sec)", 
        "DEBUG:rekall.1:Found _EPROCESS @ 0x551B80 (DTB: 0x319000)", 
        "INFO:rekall.1:Detected ntkrnlpa.pdb with GUID BD8F451F3E754ED8A34B50560CEB08E31", 
        "DEBUG:rekall.1:Detection method rsds worked at offset 0x4e0508", 
        "DEBUG:rekall.1:Running plugin (sessions) with args (()) kwargs ({'profile': None, 'proc_regex': None, 'phys_eprocess': None, 'pid': None, 'eprocess': None, 'method': ['PsActiveProcessHead', 'CSRSS', 'PspCidTable', 'Sessions', 'Handles']})", 
        "INFO:rekall.1:Detected kernel base at 0x804D7000", 
        "DEBUG:rekall.1:Listed 25 processes using PsActiveProcessHead", 
        "DEBUG:rekall.1:Listed 22 processes using CSRSS", 
        "DEBUG:rekall.1:Listed 25 processes using PspCidTable", 
        "DEBUG:rekall.1:Listed 23 processes using Sessions", 
        "DEBUG:rekall.1:Listed 24 processes using Handles", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/win32k/index.gz", 
        "INFO:rekall.1:Loaded profile win32k/index from Local Cache Directory:/Users/scudette/projects/rekall-test/profile_cache (in 0.00409698486328 sec)", 
        "DEBUG:rekall.1:Switching to process context: csrss.exe (Pid 608@0xff1ecda0)", 
        "DEBUG:rekall.1:win32k/GUID/9509CA346604482B953315CE274C97B32 matched offset 0x8f3ce+0xbf800000=0xbf88f3ce ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/5E69D40C6D5143E28432DF63F9EFDE642 matched offset 0xe8064+0xbf800000=0xbf8e8064 ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/4C91F239497447FE9E2940EADACFEDA52 matched offset 0x10b8cf+0xbf800000=0xbf90b8cf ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/BC9E46EC04C04CDB9C991B9DCE40B7732 matched offset 0xfe243+0xbf800000=0xbf8fe243 ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/0CB72202690148749C06F6B71DB56A952 matched offset 0xe860b+0xbf800000=0xbf8e860b ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/D48935A134F249CDA985C45051FBF0462 matched offset 0x190a2c+0xbf800000=0xbf990a2c ('EngMapFile')", 
        "DEBUG:rekall.1:win32k/GUID/D48935A134F249CDA985C45051FBF0462 matched offset 0xe3357+0xbf800000=0xbf8e3357 ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/D48935A134F249CDA985C45051FBF0462 matched offset 0x5a2c5+0xbf800000=0xbf85a2c5 ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/D48935A134F249CDA985C45051FBF0462 matched offset 0xf454+0xbf800000=0xbf80f454 ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/D48935A134F249CDA985C45051FBF0462 matches 4/5 comparison points", 
        "DEBUG:rekall.1:win32k/GUID/2D647ACE60874BB190928443C9663B8D2 matched offset 0xbd9e0+0xbf800000=0xbf8bd9e0 ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/58A4CD28386B438EB472AAF58791EE072 matched offset 0xe866b+0xbf800000=0xbf8e866b ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/54FAC8D3E1714990B814C1E866AF35A62 matched offset 0x567e4+0xbf800000=0xbf8567e4 ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/FF84AE9473A94DC3944B18A3366DB0672 matched offset 0x89036+0xbf800000=0xbf889036 ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/FF84AE9473A94DC3944B18A3366DB0672 matched offset 0xed8d+0xbf800000=0xbf80ed8d ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/347A2D68D0384F859E48208492E454DA2 matched offset 0xfdb07+0xbf800000=0xbf8fdb07 ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/5B12542E197C4B18B34A14C0229B80A62 matched offset 0xcb8af+0xbf800000=0xbf8cb8af ('\\x90')", 
        "DEBUG:rekall.1:win32k/GUID/B73D5FDB757E4CA6A4E3A446A1EBFEA22 matched offset 0xfd90f+0xbf800000=0xbf8fd90f ('\\x90')", 
        "DEBUG:rekall.1:Switching to Kernel context", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/win32k/GUID/D48935A134F249CDA985C45051FBF0462.gz", 
        "INFO:rekall.1:Loaded profile win32k/GUID/D48935A134F249CDA985C45051FBF0462 from Local Cache Directory:/Users/scudette/projects/rekall-test/profile_cache (in 0.202466011047 sec)", 
        "DEBUG:rekall.1:Skipped profile dxg/index from https://raw.githubusercontent.com/google/rekall-profiles/master (Not in inventory)", 
        "DEBUG:rekall.1:Skipped profile dxg/index from http://profiles.rekall-forensic.com (Not in inventory)", 
        "DEBUG:rekall.1:Building profile from PE Exports for dxg", 
        "DEBUG:rekall.1:Skipped profile vmx_fb/index from https://raw.githubusercontent.com/google/rekall-profiles/master (Not in inventory)", 
        "DEBUG:rekall.1:Skipped profile vmx_fb/index from http://profiles.rekall-forensic.com (Not in inventory)", 
        "DEBUG:rekall.1:Building profile from PE Exports for vmx_fb"
    ], 
    "time_used": 7.778566837310791, 
    "return_code": 0, 
    "failures": {
        "testCase (__main__.TestSessions)": "Traceback (most recent call last):\n  File \"/Users/scudette/projects/rekall/rekall-core/rekall/testlib.py\", line 234, in run\n    testMethod()\n  File \"/Users/scudette/projects/rekall/rekall-core/rekall/testlib.py\", line 284, in testCase\n    self.assertEqual(previous, current)\nAssertionError: u' Process: 0xff1ecda0||csrss.exe||  608 @ 2010-08-11 06:06:23+0000' != u' Process: 0xff1ecda0||csrss.exe||  608 @ 2010-08-11 06:06:23Z'\n-  Process: 0xff1ecda0||csrss.exe||  608 @ 2010-08-11 06:06:23+0000\n?                                                             ^^^^^\n+  Process: 0xff1ecda0||csrss.exe||  608 @ 2010-08-11 06:06:23Z\n?                                                             ^\n\n"
    }, 
    "output": [
        "**************************************************", 
        "Session(V): 0xfc9bd000 ID: 0 Processes: 23", 
        "PagedPoolStart: 0xbc000000 PagedPoolEnd 0xbc3fffff", 
        " Process: 0xff1ecda0||csrss.exe||  608 @ 2010-08-11 06:06:23Z", 
        " Process: 0xff1ec978||winlogon.exe||  632 @ 2010-08-11 06:06:23Z", 
        " Process: 0xff247020||services.exe||  676 @ 2010-08-11 06:06:24Z", 
        " Process: 0xff255020||lsass.exe||  688 @ 2010-08-11 06:06:24Z", 
        " Process: 0xff218230||vmacthlp.exe||  844 @ 2010-08-11 06:06:24Z", 
        " Process: 0x80ff88d8||svchost.exe||  856 @ 2010-08-11 06:06:24Z", 
        " Process: 0xff217560||svchost.exe||  936 @ 2010-08-11 06:06:24Z", 
        " Process: 0x80fbf910||svchost.exe|| 1028 @ 2010-08-11 06:06:24Z", 
        " Process: 0xff22d558||svchost.exe|| 1088 @ 2010-08-11 06:06:25Z", 
        " Process: 0xff203b80||svchost.exe|| 1148 @ 2010-08-11 06:06:26Z", 
        " Process: 0xff1d7da0||spoolsv.exe|| 1432 @ 2010-08-11 06:06:26Z", 
        " Process: 0xff1b8b28||vmtoolsd.exe|| 1668 @ 2010-08-11 06:06:35Z", 
        " Process: 0xff1fdc88||VMUpgradeHelper|| 1788 @ 2010-08-11 06:06:38Z", 
        " Process: 0xff143b28||TPAutoConnSvc.e|| 1968 @ 2010-08-11 06:06:39Z", 
        " Process: 0xff25a7e0||alg.exe||  216 @ 2010-08-11 06:06:39Z", 
        " Process: 0xff364310||wscntfy.exe||  888 @ 2010-08-11 06:06:49Z", 
        " Process: 0xff38b5f8||TPAutoConnect.e|| 1084 @ 2010-08-11 06:06:52Z", 
        " Process: 0x80f60da0||wuauclt.exe|| 1732 @ 2010-08-11 06:07:44Z", 
        " Process: 0xff3865d0||explorer.exe|| 1724 @ 2010-08-11 06:09:29Z", 
        " Process: 0xff3667e8||VMwareTray.exe||  432 @ 2010-08-11 06:09:31Z", 
        " Process: 0xff374980||VMwareUser.exe||  452 @ 2010-08-11 06:09:32Z", 
        " Process: 0x80f94588||wuauclt.exe||  468 @ 2010-08-11 06:09:37Z", 
        " Process: 0xff27d4d0||wmiprvse.exe||  828 @ 2010-08-15 19:26:08Z", 
        " Image: 0xff384348, Address 0xbf800000, Name: win32k", 
        " Image: 0x80f04f08, Address 0xbf9c1000, Name: dxg", 
        " Image: 0x80f54ae8, Address 0xbf9d3000, Name: vmx_fb", 
        " Image: 0xbf7f009c, Address 0xc07e4de8, Name: "
    ], 
    "options": {
        "--name_resolution_strategies": [
            "Module", 
            "Symbol"
        ], 
        "executable": "rekall ", 
        "--filename": "/Users/scudette/projects/rekall-test/tigger/tigger.vmem.E01", 
        "--format": "test", 
        "commandline": "sessions", 
        "pid": 1724, 
        "test_class": "TestSessions", 
        "--cache_dir": "/Users/scudette/projects/rekall-test/tigger/../profile_cache/", 
        "--cache": "memory", 
        "tempdir": "/var/folders/y8/670pn1dx55x01z5fs_6r2gnh003jp1/T/tmpxodq6M/TestSessionsThread-7", 
        "executed_command": "rekall  -v --cache 'memory' --cache_dir '/Users/scudette/projects/rekall-test/tigger/../profile_cache/' --format 'test' --filename '/Users/scudette/projects/rekall-test/tigger/tigger.vmem.E01' --name_resolution_strategies 'Module' 'Symbol' - sessions", 
        "testdir": "/Users/scudette/projects/rekall-test/tigger"
    }
}