#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /home/scudette/projects/test_data/tigger/output/TestSvcScan /home/scudette/projects/test_data/tigger/TestSvcScan
elif [ "$1" == "meld" ]; then
   meld /home/scudette/projects/test_data/tigger/output/TestSvcScan /home/scudette/projects/test_data/tigger/TestSvcScan
elif [ "$1" == "diff" ]; then
   diff /home/scudette/projects/test_data/tigger/output/TestSvcScan /home/scudette/projects/test_data/tigger/TestSvcScan
elif [ "$1" == "run" ]; then
   rekall  --renderer 'test' --filename '/home/scudette/projects/test_data/tigger/tigger.vmem' --name_resolution_strategies 'Module,Symbol' - svcscan
else
   less /home/scudette/projects/test_data/tigger/output/TestSvcScan
fi
exit 0
{
    "time_used": 3.4773471355438232, 
    "output": [
        "  Offset  ||Order||PID ||Service Name                  ||Display Name                            ||Service Type                  || Service State ||Binary Path", 
        "----------||-----||----||------------------------------||----------------------------------------||------------------------------||---------------||-----------", 
        "0x006eabb0||253  ||1028||WZCSVC                        ||Wireless Zero Configuration             ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e3d18||56   ||1028||ERSvc                         ||Error Reporting Service                 ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e3ec0||59   ||1028||EventSystem                   ||COM+ Event System                       ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e3fe8||61   ||1028||FastUserSwitchingCompatibility||Fast User Switching Compatibility       ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e3548||42   ||1028||CryptSvc                      ||Cryptographic Services                  ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e3668||44   ||856 ||DcomLaunch                    ||DCOM Server Process Launcher            ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\svchost -k DcomLaunch", 
        "0x006ea200||236  ||844 ||VMware Physical Disk Helper   ||VMware Physical Disk Helper Service     ||SERVICE_WIN32_OWN_PROCESS     ||SERVICE_RUNNING||\"C:\\Program Files\\VMware\\VMware Tools\\vmacthlp.exe\"", 
        "          ||     ||    ||Service                       ||                                        ||                              ||               ||                                                   ", 
        "0x006e3e30||58   ||676 ||Eventlog                      ||Event Log                               ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\services.exe", 
        "0x006e8058||176  ||688 ||SamSs                         ||Security Accounts Manager               ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\lsass.exe", 
        "0x006e7f48||174  ||936 ||RpcSs                         ||Remote Procedure Call (RPC)             ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\svchost -k rpcss", 
        "0x006e93f0||211  ||1028||Themes                        ||Themes                                  ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e53b0||96   ||1148||LmHosts                       ||TCP/IP NetBIOS Helper                   ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\svchost.exe -k LocalService", 
        "0x006e3b68||53   ||1088||Dnscache                      ||DNS Client                              ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\svchost.exe -k NetworkService", 
        "0x006e7080||148  ||676 ||PlugPlay                      ||Plug and Play                           ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\services.exe", 
        "0x006e3700||45   ||1028||Dhcp                          ||DHCP Client                             ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e85f0||186  ||1028||ShellHWDetection              ||Shell Hardware Detection                ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e8840||190  ||1432||Spooler                       ||Print Spooler                           ||SERVICE_INTERACTIVE_PROCESS,  ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\spoolsv.exe", 
        "          ||     ||    ||                              ||                                        ||SERVICE_WIN32_OWN_PROCESS     ||               ||                               ", 
        "0x006e8170||178  ||1028||Schedule                      ||Task Scheduler                          ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e5280||94   ||1028||lanmanworkstation             ||Workstation                             ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e2b50||24   ||1028||AudioSrv                      ||Windows Audio                           ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006ea738||245  ||1148||WebClient                     ||WebClient                               ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\svchost.exe -k LocalService", 
        "0x006ea7c8||246  ||1028||winmgmt                       ||Windows Management Instrumentation      ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e3a48||51   ||1028||dmserver                      ||Logical Disk Manager                    ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e4480||69   ||1028||helpsvc                       ||Help and Support                        ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e51e8||93   ||1028||lanmanserver                  ||Server                                  ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e63c8||125  ||1028||Netman                        ||Network Connections                     ||SERVICE_INTERACTIVE_PROCESS,  ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "          ||     ||    ||                              ||                                        ||SERVICE_WIN32_SHARE_PROCESS   ||               ||                                          ", 
        "0x006e7e10||172  ||1148||RemoteRegistry                ||Remote Registry                         ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\svchost.exe -k LocalService", 
        "0x006ea500||241  ||1028||W32Time                       ||Windows Time                            ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e7110||149  ||688 ||PolicyAgent                   ||IPSEC Services                          ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\lsass.exe", 
        "0x006e7240||151  ||688 ||ProtectedStorage              ||Protected Storage                       ||SERVICE_INTERACTIVE_PROCESS,  ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\lsass.exe", 
        "          ||     ||    ||                              ||                                        ||SERVICE_WIN32_SHARE_PROCESS   ||               ||                             ", 
        "0x006e8320||181  ||1028||SENS                          ||System Event Notification               ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e8290||180  ||1028||seclogon                      ||Secondary Logon                         ||SERVICE_INTERACTIVE_PROCESS,  ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "          ||     ||    ||                              ||                                        ||SERVICE_WIN32_SHARE_PROCESS   ||               ||                                          ", 
        "0x006eab20||252  ||1028||wuauserv                      ||Automatic Updates                       ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e8958||192  ||1028||srservice                     ||System Restore Service                  ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e96d0||216  ||1028||TrkWks                        ||Distributed Link Tracking Client        ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006ea0d0||234  ||1668||VMTools                       ||VMware Tools Service                    ||SERVICE_INTERACTIVE_PROCESS,  ||SERVICE_RUNNING||\"C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe\"", 
        "          ||     ||    ||                              ||                                        ||SERVICE_WIN32_OWN_PROCESS     ||               ||                                                   ", 
        "0x006e2538||13   ||216 ||ALG                           ||Application Layer Gateway Service       ||SERVICE_WIN32_OWN_PROCESS     ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\alg.exe", 
        "0x006ea160||235  ||1788||VMUpgradeHelper               ||VMware Upgrade Helper                   ||SERVICE_WIN32_OWN_PROCESS     ||SERVICE_RUNNING||\"C:\\Program Files\\VMware\\VMware Tools\\VMUpgradeHelper.exe\" /service", 
        "0x006e9098||205  ||1028||TapiSrv                       ||Telephony                               ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006eaa90||251  ||1028||wscsvc                        ||Security Center                         ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e8558||185  ||1028||SharedAccess                  ||Windows Firewall/Internet Connection    ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "          ||     ||    ||                              ||Sharing (ICS)                           ||                              ||               ||                                          ", 
        "0x006e95a0||214  ||1968||TPAutoConnSvc                 ||TP AutoConnect Service                  ||SERVICE_WIN32_OWN_PROCESS     ||SERVICE_RUNNING||\"C:\\Program Files\\VMware\\VMware Tools\\TPAutoConnSvc.exe\"", 
        "0x006e6458||126  ||1028||Nla                           ||Network Location Awareness (NLA)        ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x006e9358||210  ||856 ||TermService                   ||Terminal Services                       ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\svchost -k DcomLaunch", 
        "0x006e8a70||194  ||1148||SSDPSRV                       ||SSDP Discovery Service                  ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\system32\\svchost.exe -k LocalService", 
        "0x006e7880||162  ||1028||RasMan                        ||Remote Access Connection Manager        ||SERVICE_WIN32_SHARE_PROCESS   ||SERVICE_RUNNING||C:\\WINDOWS\\System32\\svchost.exe -k netsvcs", 
        "0x000bb330||1    ||-   ||C:\\WINDOWS\\System32\\alg.exe   ||                                        ||                              ||UNKNOWN (1044) ||-          ", 
        "0x000c3640||27   ||-   ||C:\\WINDOWS\\System32\\svchost.ex||                                        ||                              ||UNKNOWN (0)    ||-          ", 
        "          ||     ||    ||e -k netsvcs                  ||                                        ||                              ||               ||           ", 
        "0x000aab80||2    ||-   ||C:\\WINDOWS\\system32\\svchost -k||                                        ||                              ||UNKNOWN (0)    ||-          ", 
        "          ||     ||    ||DcomLaunch                    ||                                        ||                              ||               ||           ", 
        "0x000b5f10||1    ||-   ||C:\\WINDOWS\\system32\\svchost.ex||                                        ||                              ||UNKNOWN (860)  ||-          ", 
        "          ||     ||    ||e -k NetworkService           ||                                        ||                              ||               ||           ", 
        "0x00098a70||3    ||-   ||C:\\WINDOWS\\system32\\services.e||                                        ||                              ||UNKNOWN (0)    ||-          ", 
        "          ||     ||    ||xe                            ||                                        ||                              ||               ||           ", 
        "0x000a8990||4    ||-   ||C:\\WINDOWS\\system32\\svchost.ex||                                        ||                              ||UNKNOWN (912)  ||-          ", 
        "          ||     ||    ||e -k LocalService             ||                                        ||                              ||               ||           ", 
        "0x000c3960||4    ||-   ||C:\\WINDOWS\\system32\\lsass.exe ||                                        ||                              ||UNKNOWN (0)    ||-          ", 
        "0x000c2ff0||1    ||-   ||C:\\WINDOWS\\system32\\svchost -k||                                        ||                              ||UNKNOWN (812)  ||-          ", 
        "          ||     ||    ||rpcss                         ||                                        ||                              ||               ||           ", 
        "0x000c4e10||1    ||-   ||C:\\WINDOWS\\system32\\spoolsv.ex||                                        ||                              ||UNKNOWN (0)    ||-          ", 
        "          ||     ||    ||e                             ||                                        ||                              ||               ||           ", 
        "0x000b8c10||1    ||-   ||\"C:\\Program                   ||                                        ||                              ||UNKNOWN (0)    ||-          ", 
        "          ||     ||    ||Files\\VMware\\VMware           ||                                        ||                              ||               ||           ", 
        "          ||     ||    ||Tools\\TPAutoConnSvc.exe\"      ||                                        ||                              ||               ||           ", 
        "0x000ba570||1    ||-   ||\"C:\\Program                   ||                                        ||                              ||UNKNOWN (0)    ||-          ", 
        "          ||     ||    ||Files\\VMware\\VMware           ||                                        ||                              ||               ||           ", 
        "          ||     ||    ||Tools\\vmtoolsd.exe\"           ||                                        ||                              ||               ||           ", 
        "0x000cdac0||1    ||-   ||\"C:\\Program                   ||                                        ||                              ||UNKNOWN (0)    ||-          ", 
        "          ||     ||    ||Files\\VMware\\VMware           ||                                        ||                              ||               ||           ", 
        "          ||     ||    ||Tools\\VMUpgradeHelper.exe\"    ||                                        ||                              ||               ||           ", 
        "          ||     ||    ||/service                      ||                                        ||                              ||               ||           ", 
        "0x000a9170||1    ||-   ||\"C:\\Program                   ||                                        ||                              ||UNKNOWN (0)    ||-          ", 
        "          ||     ||    ||Files\\VMware\\VMware           ||                                        ||                              ||               ||           ", 
        "          ||     ||    ||Tools\\vmacthlp.exe\"           ||                                        ||                              ||               ||           "
    ], 
    "errors": {}, 
    "return_code": 0, 
    "options": {
        "--name_resolution_strategies": "Module,Symbol", 
        "executable": "rekall ", 
        "--filename": "/home/scudette/projects/test_data/tigger/tigger.vmem", 
        "commandline": "svcscan", 
        "pid": "1724", 
        "--renderer": "test", 
        "test_class": "TestSvcScan", 
        "tempdir": "/tmp/tmpvMnKhz/TestSvcScanThread-4", 
        "executed_command": "rekall  --renderer 'test' --filename '/home/scudette/projects/test_data/tigger/tigger.vmem' --name_resolution_strategies 'Module,Symbol' - svcscan", 
        "testdir": "/home/scudette/projects/test_data/tigger"
    }
}