#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /home/mic/projects/rekall-test/tigger/output/TestArtifactsList /home/mic/projects/rekall-test/tigger/TestArtifactsList
elif [ "$1" == "meld" ]; then
   meld /home/mic/projects/rekall-test/tigger/output/TestArtifactsList /home/mic/projects/rekall-test/tigger/TestArtifactsList
elif [ "$1" == "diff" ]; then
   diff /home/mic/projects/rekall-test/tigger/output/TestArtifactsList /home/mic/projects/rekall-test/tigger/TestArtifactsList
elif [ "$1" == "run" ]; then
   rekall  -v --cache 'memory' --format 'test' --filename '/home/mic/projects/rekall-test/tigger/tigger.vmem.E01' --cache_dir '/home/mic/projects/rekall-test/tigger/../profile_cache/' --name_resolution_strategies 'Module' 'Symbol' - artifact_list --regex WindowsDriverIRPKeyLogger
else
   less /home/mic/projects/rekall-test/tigger/output/TestArtifactsList
fi
exit 0
{
    "errors": {
        "TestArtifactsList testCase": {}
    },
    "executed_command": "rekall  -v --cache 'memory' --format 'test' --filename '/home/mic/projects/rekall-test/tigger/tigger.vmem.E01' --cache_dir '/home/mic/projects/rekall-test/tigger/../profile_cache/' --name_resolution_strategies 'Module' 'Symbol' - artifact_list --regex WindowsDriverIRPKeyLogger",
    "failours": {
        "TestArtifactsList testCase": {
            "TestArtifactsList testCase": "Traceback (most recent call last):\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 300, in run\n    testMethod()\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 354, in testCase\n    self.assertListEqual(previous, current)\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 275, in assertListEqual\n    self.assertEqual(x, y)\nAssertionError: 'Wind[23 chars]   ||- 0:    ||                    ||- 0:     [59 chars]dows' != 'Wind[23 chars]   ||Windows ||                    ||REKALL_EF[59 chars]dows'\n- WindowsDriverIRPKeyLogger     ||- 0:    ||                    ||- 0:                ||One technique of installing a keylogger in windows\n?                                 ^^^^^^^                         ^^^^^^^^^^^^^^\n+ WindowsDriverIRPKeyLogger     ||Windows ||                    ||REKALL_EFILTER      ||One technique of installing a keylogger in windows\n?                                 ^^^^^^^                         ^^^^^^^^^^^^^^\n\n"
        }
    },
    "logging": [
        "2017-10-01 22:05:25,302:DEBUG:rekall.1:Logging level set to 10",
        "2017-10-01 22:05:25,303:DEBUG:rekall.1:Running plugin (artifact_list) with args (()) kwargs ({'labels': None, 'supported_os': None, 'verbosity': 1, 'all': None, 'regex': 'WindowsDriverIRPKeyLogger'})",
        "2017-10-01 22:05:25,304:DEBUG:rekall.1:Voting round with base: None",
        "2017-10-01 22:05:25,304:DEBUG:rekall.1:Trying <class 'rekall.plugins.response.common.APIDummyPhysicalAddressSpace'> ",
        "2017-10-01 22:05:25,305:DEBUG:rekall.1:Failed instantiating APIDummyPhysicalAddressSpace: Instantiation failed for unspecified reason",
        "2017-10-01 22:05:25,305:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ",
        "2017-10-01 22:05:25,305:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: No base address space provided",
        "2017-10-01 22:05:25,305:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ",
        "2017-10-01 22:05:25,305:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Must stack on another address space",
        "2017-10-01 22:05:25,305:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ",
        "2017-10-01 22:05:25,305:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: No base address space provided",
        "2017-10-01 22:05:25,305:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ",
        "2017-10-01 22:05:25,306:DEBUG:rekall.1:Failed instantiating EWFAddressSpace: No base address space provided",
        "2017-10-01 22:05:25,306:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ",
        "2017-10-01 22:05:25,306:DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Must stack on another address space",
        "2017-10-01 22:05:25,306:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ",
        "2017-10-01 22:05:25,306:DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Must stack on another address space",
        "2017-10-01 22:05:25,306:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ",
        "2017-10-01 22:05:25,306:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: No base address space provided",
        "2017-10-01 22:05:25,306:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ",
        "2017-10-01 22:05:25,306:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: No base address space provided",
        "2017-10-01 22:05:25,306:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ",
        "2017-10-01 22:05:25,307:DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Must stack on another address space",
        "2017-10-01 22:05:25,307:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ",
        "2017-10-01 22:05:25,307:DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Must be layered on another address space.",
        "2017-10-01 22:05:25,307:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ",
        "2017-10-01 22:05:25,308:DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Unable to open AFF4 volume: No physical memory categories found.",
        "2017-10-01 22:05:25,308:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pmem.MacPmemAddressSpace'> ",
        "2017-10-01 22:05:25,308:DEBUG:rekall.1:Failed instantiating MacPmemAddressSpace: MacPmem would declare a YML device at /home/mic/projects/rekall-test/tigger/tigger.vmem.E01_info",
        "2017-10-01 22:05:25,308:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ",
        "2017-10-01 22:05:25,308:DEBUG:rekall.1:Succeeded instantiating FileAddressSpace",
        "2017-10-01 22:05:25,309:DEBUG:rekall.1:Voting round with base: FileAddressSpace",
        "2017-10-01 22:05:25,309:DEBUG:rekall.1:Trying <class 'rekall.plugins.response.common.APIDummyPhysicalAddressSpace'> ",
        "2017-10-01 22:05:25,309:DEBUG:rekall.1:Failed instantiating APIDummyPhysicalAddressSpace: Instantiation failed for unspecified reason",
        "2017-10-01 22:05:25,309:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ",
        "2017-10-01 22:05:25,309:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0x9465645",
        "2017-10-01 22:05:25,310:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ",
        "2017-10-01 22:05:25,310:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid",
        "2017-10-01 22:05:25,310:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ",
        "2017-10-01 22:05:25,310:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.",
        "2017-10-01 22:05:25,310:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ",
        "2017-10-01 22:05:25,314:DEBUG:rekall.1:Succeeded instantiating EWFAddressSpace",
        "2017-10-01 22:05:25,314:DEBUG:rekall.1:Voting round with base: EWFAddressSpace",
        "2017-10-01 22:05:25,314:DEBUG:rekall.1:Trying <class 'rekall.plugins.response.common.APIDummyPhysicalAddressSpace'> ",
        "2017-10-01 22:05:25,314:DEBUG:rekall.1:Failed instantiating APIDummyPhysicalAddressSpace: Instantiation failed for unspecified reason",
        "2017-10-01 22:05:25,314:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ",
        "2017-10-01 22:05:25,315:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0xf000ff53",
        "2017-10-01 22:05:25,315:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ",
        "2017-10-01 22:05:25,315:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid",
        "2017-10-01 22:05:25,315:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Failed instantiating EWFAddressSpace: EWF signature not present",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Header signature invalid",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Header signature invalid",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: Header signature invalid",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: Header signature invalid",
        "2017-10-01 22:05:25,316:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ",
        "2017-10-01 22:05:25,317:DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Header signature invalid",
        "2017-10-01 22:05:25,317:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ",
        "2017-10-01 22:05:25,317:DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Invalid Lime header signature",
        "2017-10-01 22:05:25,317:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ",
        "2017-10-01 22:05:25,317:DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Must stack on another address space",
        "2017-10-01 22:05:25,317:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pmem.MacPmemAddressSpace'> ",
        "2017-10-01 22:05:25,317:DEBUG:rekall.1:Failed instantiating MacPmemAddressSpace: Must be mapped directly over a raw device.",
        "2017-10-01 22:05:25,317:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ",
        "2017-10-01 22:05:25,317:DEBUG:rekall.1:Failed instantiating FileAddressSpace: Must be first Address Space",
        "2017-10-01 22:05:25,317:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.amd64.VTxPagedMemory'> ",
        "2017-10-01 22:05:25,318:DEBUG:rekall.1:Failed instantiating VTxPagedMemory: No more EPTs specified",
        "2017-10-01 22:05:25,318:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.mmap_address_space.MmapFileAddressSpace'> ",
        "2017-10-01 22:05:25,318:DEBUG:rekall.1:Failed instantiating MmapFileAddressSpace: Must be first Address Space",
        "2017-10-01 22:05:25,318:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.GlobalOffsetAddressSpace'> ",
        "2017-10-01 22:05:25,318:DEBUG:rekall.1:Failed instantiating GlobalOffsetAddressSpace: File offset not specified.",
        "2017-10-01 22:05:25,318:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pagefile.PagefilePhysicalAddressSpace'> ",
        "2017-10-01 22:05:25,318:DEBUG:rekall.1:Failed instantiating PagefilePhysicalAddressSpace: Pagefile not specified",
        "2017-10-01 22:05:25,318:INFO:rekall.1:Autodetected physical address space EWFAddressSpace",
        "2017-10-01 22:05:25,319:DEBUG:rekall.1:Will detect profile using these Detectors: osx,tsk,ntfs,linux_index,nt_index,rsds,linux,windows_kernel_file,pe",
        "2017-10-01 22:05:25,960:DEBUG:rekall.1:Opened url https://github.com/google/rekall-profiles/raw/master/v1.0/inventory.gz",
        "2017-10-01 22:05:26,583:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/inventory.gz",
        "2017-10-01 22:05:26,727:DEBUG:rekall.1:Opened url http://profiles.rekall-forensic.com/v1.0/inventory.gz",
        "2017-10-01 22:05:27,037:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/inventory.gz",
        "2017-10-01 22:05:27,037:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/OSX/index.gz",
        "2017-10-01 22:05:27,038:INFO:rekall.1:Loaded profile OSX/index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.0008018016815185547 sec)",
        "2017-10-01 22:05:27,038:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/Linux/index.gz",
        "2017-10-01 22:05:27,050:INFO:rekall.1:Loaded profile Linux/index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.011307716369628906 sec)",
        "2017-10-01 22:05:27,050:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/nt/eprocess_index.gz",
        "2017-10-01 22:05:27,073:INFO:rekall.1:Loaded profile nt/eprocess_index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.02337646484375 sec)",
        "2017-10-01 22:05:27,074:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/nt/index.gz",
        "2017-10-01 22:05:27,149:INFO:rekall.1:Loaded profile nt/index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.07570075988769531 sec)",
        "2017-10-01 22:05:27,150:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/pe.gz",
        "2017-10-01 22:05:27,157:INFO:rekall.1:Loaded profile pe from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.0077724456787109375 sec)",
        "2017-10-01 22:05:27,158:DEBUG:rekall.1:Trying method windows_kernel_file, offset 0",
        "2017-10-01 22:05:27,158:DEBUG:rekall.1:Trying method pe, offset 0",
        "2017-10-01 22:05:27,160:DEBUG:rekall.1:Trying method rsds, offset 0",
        "2017-10-01 22:05:27,160:DEBUG:rekall.1:Trying method tsk, offset 0",
        "2017-10-01 22:05:27,162:DEBUG:rekall.1:Trying method ntfs, offset 0",
        "2017-10-01 22:05:27,162:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/ntfs.gz",
        "2017-10-01 22:05:27,163:INFO:rekall.1:Loaded profile ntfs from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.0013027191162109375 sec)",
        "2017-10-01 22:05:27,166:DEBUG:rekall.1:Trying method linux_index, offset 0",
        "2017-10-01 22:05:27,166:DEBUG:rekall.1:LinuxIndexDetector:DetectFromHit(0) = None",
        "2017-10-01 22:05:27,167:DEBUG:rekall.1:Trying method nt_index, offset 0",
        "2017-10-01 22:05:27,793:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/nt/GUID/BD8F451F3E754ED8A34B50560CEB08E31.gz",
        "2017-10-01 22:05:27,881:INFO:rekall.1:Loaded profile nt/GUID/BD8F451F3E754ED8A34B50560CEB08E31 from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.08824014663696289 sec)",
        "2017-10-01 22:05:28,200:DEBUG:rekall.1:Found _EPROCESS @ 0x551B80 (DTB: 0x319000)",
        "2017-10-01 22:05:28,206:INFO:rekall.1:Detected ntkrnlpa.pdb with GUID BD8F451F3E754ED8A34B50560CEB08E31",
        "2017-10-01 22:05:28,206:DEBUG:rekall.1:Detection method rsds worked at offset 0x4e0508",
        "2017-10-01 22:05:28,206:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/artifacts.gz",
        "2017-10-01 22:05:28,207:INFO:rekall.1:Loaded profile artifacts from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.0004878044128417969 sec)"
    ],
    "options": {
        "--cache": "memory",
        "--cache_dir": "/home/mic/projects/rekall-test/tigger/../profile_cache/",
        "--filename": "/home/mic/projects/rekall-test/tigger/tigger.vmem.E01",
        "--format": "test",
        "--name_resolution_strategies": [
            "Module",
            "Symbol"
        ],
        "commandline": "artifact_list --regex WindowsDriverIRPKeyLogger",
        "debug": false,
        "executable": "rekall ",
        "pids": 1724,
        "tempdir": "/tmp/tmpmzowpt2s/TestArtifactsListThread-1",
        "test_class": "TestArtifactsList",
        "testdir": "/home/mic/projects/rekall-test/tigger"
    },
    "output": [
        "             Name             ||   OS   ||       Labels       ||       Types        ||                   Description                    ",
        "------------------------------||--------||--------------------||--------------------||--------------------------------------------------",
        "WindowsDriverIRPKeyLogger     ||Windows ||                    ||REKALL_EFILTER      ||One technique of installing a keylogger in windows",
        "                              ||        ||                    ||                    ||is to hook the IRP handler                        ",
        "                              ||        ||                    ||                    ||routine of the kbd driver. This artifact dumps the",
        "                              ||        ||                    ||                    ||entire IRP handler table                          ",
        "                              ||        ||                    ||                    ||for the kbdclass (Keyboard Class) driver, if any  ",
        "                              ||        ||                    ||                    ||of the functions do not                           ",
        "                              ||        ||                    ||                    ||reside within the driver itself (i.e. it is       ",
        "                              ||        ||                    ||                    ||hooked).                                          "
    ],
    "return_code": 0,
    "time_used": 4.227521896362305
}