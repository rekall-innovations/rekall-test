#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /Users/adamsh/Projects/rekall-test/tigger/output/TestEntityDescribe /Users/adamsh/Projects/rekall-test/tigger/TestEntityDescribe
elif [ "$1" == "meld" ]; then
   meld /Users/adamsh/Projects/rekall-test/tigger/output/TestEntityDescribe /Users/adamsh/Projects/rekall-test/tigger/TestEntityDescribe
elif [ "$1" == "diff" ]; then
   diff /Users/adamsh/Projects/rekall-test/tigger/output/TestEntityDescribe /Users/adamsh/Projects/rekall-test/tigger/TestEntityDescribe
elif [ "$1" == "run" ]; then
   rekall  --renderer 'test' --filename '/Users/adamsh/Projects/rekall-test/tigger/tigger.vmem.E01' --name_resolution_strategies 'Module,Symbol' - describe
else
   less /Users/adamsh/Projects/rekall-test/tigger/output/TestEntityDescribe
fi
exit 0
{
    "time_used": 3.1805880069732666, 
    "output": [
        "", 
        "********************************************* AllocationZone: Zone as used by zone allocators. *********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "allows_foreign  ||bool (Field)        ||Does the zone allow pages from outside zalloc.              ||True            ||-                             ", 
        "count_active    ||int (Field)         ||Count of allocated elements.                                ||True            ||-                             ", 
        "count_free      ||int (Field)         ||Count of freed elements.                                    ||True            ||-                             ", 
        "element_size    ||int (Field)         ||Size per element.                                           ||True            ||-                             ", 
        "is_collectable  ||bool (Field)        ||Can this zone be garbage-collected.                         ||True            ||-                             ", 
        "is_exhaustible  ||bool (Field)        ||Whether the zone can be exhausted/filled up.                ||True            ||-                             ", 
        "is_expandable   ||bool (Field)        ||Whether the zone can grow.                                  ||True            ||-                             ", 
        "max_size        ||int (Field)         ||Maximum size the zone can grow to, if any.                  ||True            ||-                             ", 
        "name            ||str (Field)         ||Name of the zone as used by kernel.                         ||True            ||-                             ", 
        "page_count      ||int (Field)         ||Count of memory pages used by the zone.                     ||True            ||-                             ", 
        "tracks_pages    ||bool (Field)        ||Whether the zone tracks the pages it used.                  ||True            ||-                             ", 
        "type            ||str (Field)         ||Type of thing found in the zone.                            ||True            ||-                             ", 
        "", 
        "****************************************** Buffer: Stores raw memory contents at a given address. ******************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "contents        ||str (Field)         ||Raw contents (contains unprintable characters).             ||True            ||-                             ", 
        "context         ||Identity (Field)    ||Owner of the buffer, e.g. a zone, terminal...               ||True            ||-                             ", 
        "end             ||BaseObject (Field)  ||Pointer to end of the buffer.                               ||True            ||-                             ", 
        "kind            ||str (Field)         ||Ring buffer's end can be lower than its start.              ||True            ||-                             ", 
        "purpose         ||str (Field)         ||Use of the buffer, e.g. pipe, tty, mmap...                  ||True            ||-                             ", 
        "size            ||int (Field)         ||Size of the buffer (in bytes).                              ||True            ||-                             ", 
        "start           ||BaseObject (Field)  ||Pointer to start of the buffer.                             ||True            ||-                             ", 
        "state           ||str (Field)         ||Allocation state (freed or not).                            ||True            ||-                             ", 
        "", 
        "*************************************************** Connection: A connection or socket. ***************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "active          ||bool (Field)        ||Human-readable state.                                       ||True            ||-                             ", 
        "bytes_received  ||int (Field)         ||Bytes in.                                                   ||True            ||-                             ", 
        "bytes_sent      ||int (Field)         ||Bytes out.                                                  ||True            ||-                             ", 
        "handles         ||Identity (Alias)    ||Handles by processes on this file.                          ||False           ||Aliased to &Handle/resource   ", 
        "packets_received||int (Field)         ||Packets in.                                                 ||True            ||-                             ", 
        "packets_sent    ||int (Field)         ||Packets out.                                                ||True            ||-                             ", 
        "protocol_family ||str (Field)         ||Protocol family determines addressing.                      ||True            ||-                             ", 
        "", 
        "******************************************** Entity: A special component that's always present. ********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "collectors      ||list (Field)        ||The collectors that contributed to this entity.             ||True            ||-                             ", 
        "identity        ||Identity (Field)    ||The identity.                                               ||True            ||-                             ", 
        "", 
        "******************************** Event: Something that happened, e.g. 'User/name=h4x0r', 'pwned', 'local/*' ********************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "action          ||str (Field)         ||One word action, such as 'created' or 'pwned'.              ||True            ||-                             ", 
        "actor           ||Identity (Field)    ||Who done it.                                                ||True            ||-                             ", 
        "category        ||str (Field)         ||In lieu of timestamp, approximate timing, e.g. recent.      ||True            ||-                             ", 
        "description     ||str (Field)         ||What happened. Did Timmy fall down the well?                ||True            ||-                             ", 
        "native_id       ||str (Field)         ||Native event ID, such as Windows Event ID, etc.             ||True            ||-                             ", 
        "target          ||Identity (Field)    ||Unwitting (or is it) victim.                                ||True            ||-                             ", 
        "timestamp       ||datetime (Field)    ||When did this go down?                                      ||True            ||-                             ", 
        "", 
        "********************************************** File: A file/directory/socket with a FS path. **********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "handles         ||Identity (Alias)    ||Handles by processes on this file.                          ||False           ||Aliased to &Handle/resource   ", 
        "mount           ||Identity (Field)    ||The volume this file is on.                                 ||True            ||-                             ", 
        "parent          ||Identity (Field)    ||Parent file (directory, ZIP archive, etc.)                  ||True            ||-                             ", 
        "path            ||str (Field)         ||The filesystem path to this file.                           ||True            ||-                             ", 
        "type            ||str (Field)         ||Is this a directory, normal file, etc.                      ||True            ||-                             ", 
        "", 
        "****************************************** Handle: A handle from process to file/connection/etc. ******************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "fd              ||int (Field)         ||File descriptor as known to the process.                    ||True            ||-                             ", 
        "flags           ||None (Field)        ||Arbitrary OS-level flags.                                   ||True            ||-                             ", 
        "process         ||Identity (Field)    ||The process that owns this handle.                          ||True            ||-                             ", 
        "resource        ||Identity (Field)    ||The object of the handle, e.g. file or socket               ||True            ||-                             ", 
        "", 
        "******************************************** MemoryObject: Stores base objects, mostly structs. ********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "base_object     ||BaseObject (Field)  ||An instance of BaseObject.                                  ||True            ||-                             ", 
        "state           ||str (Field)         ||Allocation state (freed or not).                            ||True            ||-                             ", 
        "type            ||str (Field)         ||Class name of the base object.                              ||True            ||-                             ", 
        "", 
        "********************************************** Named: Human-readable identifying information. **********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "kind            ||str (Field)         ||Human-readable type                                         ||True            ||-                             ", 
        "name            ||str (Field)         ||Human-readable name                                         ||True            ||-                             ", 
        "", 
        "************************************************** NetworkInterface: A network interface. **************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "addresses       ||list (Field)        ||List of (protocol family, address).                         ||True            ||-                             ", 
        "name            ||str (Field)         ||E.g. en01, tunnel, etc.                                     ||True            ||-                             ", 
        "", 
        "***************************************** OSIDataLayer: OSI layers 5-7 constitute the data layer. *****************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "protocol        ||str (Field)         ||Highest-layer protocol (usually layer 7).                   ||True            ||-                             ", 
        "", 
        "*************************************************** OSILayer3: Network-layer connection. ***************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "dst_addr        ||str (Field)         ||Address of destination                                      ||True            ||-                             ", 
        "protocol        ||str (Field)         ||Layer 3 protocol.                                           ||True            ||-                             ", 
        "src_addr        ||str (Field)         ||Address of source.                                          ||True            ||-                             ", 
        "", 
        "************************************************** OSILayer4: Transport-layer connection. **************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "dst_port        ||int (Field)         ||Port at destination.                                        ||True            ||-                             ", 
        "protocol        ||str (Field)         ||Layer 4 protocol.                                           ||True            ||-                             ", 
        "src_port        ||int (Field)         ||Port at source.                                             ||True            ||-                             ", 
        "state           ||str (Field)         ||State of the connection, if stateful.                       ||True            ||-                             ", 
        "", 
        "********************************************** Permissions: Basic permissions and ownership. **********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "acl             ||list (Field)        ||Arbitrary access control list.                              ||True            ||-                             ", 
        "chmod           ||int (Field)         ||UNIX-like permissions integer.                              ||True            ||-                             ", 
        "group           ||Identity (Field)    ||Group who owns this.                                        ||True            ||-                             ", 
        "owner           ||Identity (Field)    ||User who owns this.                                         ||True            ||-                             ", 
        "", 
        "*********************************************************** Process: A process. ***********************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "arguments       ||list (Field)        ||List of arguments.                                          ||False           ||-                             ", 
        "children        ||Identity (Alias)    ||Children of this process.                                   ||False           ||Aliased to &Process/parent    ", 
        "command         ||str (Field)         ||The path to the binary or the command that executed.        ||True            ||-                             ", 
        "cr3             ||Pointer (Field)     ||Saved CR3 value (DTB location).                             ||True            ||-                             ", 
        "env             ||str (Field)         ||Process env variables.                                      ||False           ||-                             ", 
        "handles         ||Identity (Alias)    ||Handles owned by this process.                              ||False           ||Aliased to &Handle/process    ", 
        "image_file      ||Identity (Field)    ||The file where the process was loaded from.                 ||False           ||-                             ", 
        "is_64bit        ||bool (Field)        ||Is the process running in 64bit.                            ||True            ||-                             ", 
        "parent          ||Identity (Field)    ||Process that spawned this process.                          ||True            ||-                             ", 
        "pid             ||int (Field)         ||PID, on systems that have one.                              ||True            ||-                             ", 
        "priority        ||int (Field)         ||Priority of this process.                                   ||False           ||-                             ", 
        "session         ||Identity (Field)    ||The session this process belongs to.                        ||True            ||-                             ", 
        "user            ||Identity (Field)    ||The user with whose credentials this is running.            ||True            ||-                             ", 
        "", 
        "********************************************************* Session: A user session. *********************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "sid             ||int (Field)         ||Session ID.                                                 ||True            ||-                             ", 
        "user            ||Identity (Field)    ||The user.                                                   ||True            ||-                             ", 
        "", 
        "************************************** SignatureMatch: Stores a successful string or signature match. **************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "matched_object  ||Identity (Field)    ||The object containing the match.                            ||True            ||-                             ", 
        "method          ||str (Field)         ||How was the scan done?                                      ||True            ||-                             ", 
        "signature       ||str (Field)         ||The signature used in the search.                           ||True            ||-                             ", 
        "", 
        "******************************************************* Socket: A UNIX domain socket *******************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "address         ||str (Field)         ||Memory address of the socket.                               ||True            ||-                             ", 
        "connected       ||str (Field)         ||Memory address of other socket in pair.                     ||True            ||-                             ", 
        "file            ||Identity (Field)    ||The file this socket binds to.                              ||True            ||-                             ", 
        "type            ||str (Field)         ||Type in AF_UNIX/AF_LOCAL family.                            ||True            ||-                             ", 
        "", 
        "*************************************************** Terminal: A terminal (tty) session. ***************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "file            ||Identity (Field)    ||The file for this TTY.                                      ||True            ||-                             ", 
        "session         ||Identity (Field)    ||The login session of this TTY.                              ||True            ||-                             ", 
        "", 
        "*************************************** Timestamps: Standard times, such as ctime, atime, mtime, ... ***************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "accessed_at     ||datetime (Field)    ||Access time.                                                ||True            ||-                             ", 
        "backup_at       ||datetime (Field)    ||Backup time.                                                ||False           ||-                             ", 
        "created_at      ||datetime (Field)    ||Creation/start time.                                        ||True            ||-                             ", 
        "destroyed_at    ||datetime (Field)    ||Deletion/destruction/stop time.                             ||True            ||-                             ", 
        "modified_at     ||datetime (Field)    ||Modification time.                                          ||True            ||-                             ", 
        "", 
        "********************************************************** User: A user account. **********************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "home_dir        ||Identity (Field)    ||File that represents the user's home dir.                   ||True            ||-                             ", 
        "processes       ||Identity (Alias)    ||Processes running as this user.                             ||False           ||Aliased to &Process/user      ", 
        "real_name       ||str (Field)         ||User's real name.                                           ||True            ||-                             ", 
        "uid             ||int (Field)         ||A unique user id, if any.                                   ||True            ||-                             ", 
        "username        ||str (Field)         ||System username.                                            ||True            ||-                             "
    ], 
    "errors": {}, 
    "return_code": 0, 
    "options": {
        "--name_resolution_strategies": "Module,Symbol", 
        "executable": "rekall ", 
        "--filename": "/Users/adamsh/Projects/rekall-test/tigger/tigger.vmem.E01", 
        "commandline": "describe", 
        "pid": 1724, 
        "--renderer": "test", 
        "test_class": "TestEntityDescribe", 
        "tempdir": "/var/folders/yc/4zng19655k37kyxgskb3vvf0006t70/T/tmpZrt2hH/TestEntityDescribeThread-3", 
        "executed_command": "rekall  --renderer 'test' --filename '/Users/adamsh/Projects/rekall-test/tigger/tigger.vmem.E01' --name_resolution_strategies 'Module,Symbol' - describe", 
        "testdir": "/Users/adamsh/Projects/rekall-test/tigger"
    }
}