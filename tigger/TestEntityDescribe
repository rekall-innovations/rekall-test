#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /home/scudette/projects/test_data/tigger/output/TestEntityDescribe /home/scudette/projects/test_data/tigger/TestEntityDescribe
elif [ "$1" == "meld" ]; then
   meld /home/scudette/projects/test_data/tigger/output/TestEntityDescribe /home/scudette/projects/test_data/tigger/TestEntityDescribe
elif [ "$1" == "diff" ]; then
   diff /home/scudette/projects/test_data/tigger/output/TestEntityDescribe /home/scudette/projects/test_data/tigger/TestEntityDescribe
elif [ "$1" == "run" ]; then
   rekall  --renderer 'test' --filename '/home/scudette/projects/test_data/tigger/tigger.vmem' --name_resolution_strategies 'Module,Symbol' - describe
else
   less /home/scudette/projects/test_data/tigger/output/TestEntityDescribe
fi
exit 0
{
    "time_used": 2.0885260105133057, 
    "output": [
        "", 
        "************************** Named: Human-readable identifying information. **************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "name                ||str                 ||Human-readable name                               ", 
        "kind                ||str                 ||Human-readable type                               ", 
        "", 
        "************************ MemoryObject: Stores base objects, mostly structs. ************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "base_object         ||BaseObject          ||An instance of BaseObject.                        ", 
        "type                ||str                 ||Class name of the base object.                    ", 
        "state               ||str                 ||Allocation state (freed or not).                  ", 
        "", 
        "********************** Buffer: Stores raw memory contents at a given address. **********************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "start               ||Pointer             ||Pointer to start of the buffer.                   ", 
        "end                 ||Pointer             ||Pointer to end of the buffer.                     ", 
        "kind                ||str                 ||Ring buffer's end can be lower than its start.    ", 
        "size                ||int                 ||Size of the buffer (in bytes).                    ", 
        "state               ||str                 ||Allocation state (freed or not).                  ", 
        "contents            ||str                 ||Raw contents (contains unprintable characters).   ", 
        "purpose             ||str                 ||Use of the buffer, e.g. pipe, tty, mmap...        ", 
        "context             ||Identity            ||Owner of the buffer, e.g. a zone, terminal...     ", 
        "", 
        "************************* AllocationZone: Zone as used by zone allocators. *************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "name                ||str                 ||Name of the zone as used by kernel.               ", 
        "type                ||str                 ||Type of thing found in the zone.                  ", 
        "count_active        ||int                 ||Count of allocated elements.                      ", 
        "count_free          ||int                 ||Count of freed elements.                          ", 
        "element_size        ||int                 ||Size per element.                                 ", 
        "tracks_pages        ||bool                ||Whether the zone tracks the pages it used.        ", 
        "max_size            ||int                 ||Maximum size the zone can grow to, if any.        ", 
        "page_count          ||int                 ||Count of memory pages used by the zone.           ", 
        "is_exhaustible      ||bool                ||Whether the zone can be exhausted/filled up.      ", 
        "is_expandable       ||bool                ||Whether the zone can grow.                        ", 
        "allows_foreign      ||bool                ||Does the zone allow pages from outside zalloc.    ", 
        "is_collectable      ||bool                ||Can this zone be garbage-collected.               ", 
        "", 
        "****************************** NetworkInterface: A network interface. ******************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "name                ||str                 ||E.g. en01, tunnel, etc.                           ", 
        "addresses           ||list                ||List of (protocol family, address).               ", 
        "", 
        "******************************* Terminal: A terminal (tty) session. *******************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "session             ||Identity            ||The login session of this TTY.                    ", 
        "file                ||Identity            ||The file for this TTY.                            ", 
        "", 
        "*************************************** Process: A process. ***************************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "pid                 ||int                 ||PID, on systems that have one.                    ", 
        "parent              ||Identity            ||Process that spawned this process.                ", 
        "user                ||Identity            ||The user with whose credentials this is running.  ", 
        "command             ||str                 ||The path to the binary or the command that executed.", 
        "arguments           ||list                ||List of arguments.                                ", 
        "is_64bit            ||bool                ||Is the process running in 64bit.                  ", 
        "session             ||Identity            ||The session this process belongs to.              ", 
        "", 
        "************************** Connection: A network connection or a socket. **************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "src_addr            ||str                 ||Source address, e.g. offset of local socket or IP.", 
        "dst_addr            ||str                 ||Destination address.                              ", 
        "protocols           ||list                ||List of protocols in order (e.g. [IP, TCP])       ", 
        "addressing_family   ||str                 ||Addressing protocol (e.g INET, or UNIX)           ", 
        "state               ||str                 ||State of the connection, if meaningful.           ", 
        "src_bind            ||str                 ||The bind at source, such as port, or offset.      ", 
        "dst_bind            ||str                 ||The bind at destination, such as port, or offset. ", 
        "interface           ||Identity            ||The network interface handling this, if any.      ", 
        "file_bind           ||Identity            ||UNIX sockets can bind to a file.                  ", 
        "", 
        "************************************* Session: A user session. *************************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "user                ||Identity            ||The user.                                         ", 
        "sid                 ||int                 ||Session ID.                                       ", 
        "", 
        "************************************** User: A user account. **************************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "uid                 ||int                 ||A unique user id, if any.                         ", 
        "username            ||str                 ||System username.                                  ", 
        "home_dir            ||Identity            ||File that represents the user's home dir.         ", 
        "real_name           ||str                 ||User's real name.                                 ", 
        "", 
        "************************** File: A file/directory/socket with a FS path. **************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "path                ||str                 ||The filesystem path to this file.                 ", 
        "parent              ||Identity            ||Parent file (directory, ZIP archive, etc.)        ", 
        "mount               ||Identity            ||The volume this file is on.                       ", 
        "type                ||str                 ||Is this a directory, normal file, etc.            ", 
        "", 
        "******************* Timestamps: Standard times, such as ctime, atime, mtime, ... *******************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "created_at          ||int                 ||Creation/start time.                              ", 
        "destroyed_at        ||int                 ||Deletion/destruction/stop time.                   ", 
        "accessed_at         ||int                 ||Access time.                                      ", 
        "modified_at         ||int                 ||Modification time.                                ", 
        "backup_at           ||int                 ||Backup time.                                      ", 
        "", 
        "********************** Handle: A handle from process to file/connection/etc. **********************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "resource            ||Identity            ||The object of the handle, e.g. file or socket     ", 
        "process             ||Identity            ||The process that owns this handle.                ", 
        "fd                  ||int                 ||File descriptor as known to the process.          ", 
        "flags               ||-                   ||Arbitrary OS-level flags.                         ", 
        "", 
        "************************ Entity: A special component that's always present. ************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "identity            ||Identity            ||The identity.                                     ", 
        "collectors          ||list                ||The collectors that contributed to this entity.   ", 
        "", 
        "************ Event: Something that happened, e.g. 'User/name=h4x0r', 'pwned', 'local/*' ************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "actor               ||Identity            ||Who done it.                                      ", 
        "action              ||str                 ||One word action, such as 'created' or 'pwned'.    ", 
        "target              ||Identity            ||Unwitting (or is it) victim.                      ", 
        "description         ||str                 ||What happened. Did Timmy fall down the well?      ", 
        "native_id           ||str                 ||Native event ID, such as Windows Event ID, etc.   ", 
        "timestamp           ||int                 ||When did this go down?                            ", 
        "category            ||str                 ||In lieu of timestamp, approximate timing, e.g. recent.", 
        "", 
        "************************** Permissions: Basic permissions and ownership. **************************", 
        "Field               ||Type                ||Description                                       ", 
        "--------------------||--------------------||--------------------------------------------------", 
        "owner               ||Identity            ||User who owns this.                               ", 
        "group               ||Identity            ||Group who owns this.                              ", 
        "chmod               ||int                 ||UNIX-like permissions integer.                    ", 
        "acl                 ||list                ||Arbitrary access control list.                    "
    ], 
    "errors": {}, 
    "return_code": 0, 
    "options": {
        "--name_resolution_strategies": "Module,Symbol", 
        "executable": "rekall ", 
        "--filename": "/home/scudette/projects/test_data/tigger/tigger.vmem", 
        "commandline": "describe", 
        "pid": "1724", 
        "--renderer": "test", 
        "test_class": "TestEntityDescribe", 
        "tempdir": "/tmp/tmphC_JwZ/TestEntityDescribeThread-2", 
        "executed_command": "rekall  --renderer 'test' --filename '/home/scudette/projects/test_data/tigger/tigger.vmem' --name_resolution_strategies 'Module,Symbol' - describe", 
        "testdir": "/home/scudette/projects/test_data/tigger"
    }
}