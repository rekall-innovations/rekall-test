#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /Users/adamsh/Projects/test/tigger/output/TestEntityDescribe /Users/adamsh/Projects/test/tigger/TestEntityDescribe
elif [ "$1" == "meld" ]; then
   meld /Users/adamsh/Projects/test/tigger/output/TestEntityDescribe /Users/adamsh/Projects/test/tigger/TestEntityDescribe
elif [ "$1" == "diff" ]; then
   diff /Users/adamsh/Projects/test/tigger/output/TestEntityDescribe /Users/adamsh/Projects/test/tigger/TestEntityDescribe
elif [ "$1" == "run" ]; then
   rekall  --renderer 'test' --cache_dir '/Users/adamsh/Projects/test/tigger/../profile_cache/' --filename '/Users/adamsh/Projects/test/tigger/tigger.vmem.E01' --name_resolution_strategies 'Module' 'Symbol' - describe
else
   less /Users/adamsh/Projects/test/tigger/output/TestEntityDescribe
fi
exit 0
{
    "errors": {}, 
    "time_used": 2.9218060970306396, 
    "return_code": 0, 
    "failures": {
        "testCase (__main__.TestEntityDescribe)": "Traceback (most recent call last):\n  File \"/Users/adamsh/Projects/rekall/rekall/testlib.py\", line 233, in run\n    testMethod()\n  File \"/Users/adamsh/Projects/rekall/rekall/testlib.py\", line 283, in testCase\n    self.assertEqual(previous, current)\nAssertionError: 198 != 210\n"
    }, 
    "output": [
        "", 
        "********************************************* AllocationZone: Zone as used by zone allocators. *********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "allows_foreign  ||bool (Field)        ||Does the zone allow pages from outside zalloc.              ||True            ||-                             ", 
        "count_active    ||int (Field)         ||Count of allocated elements.                                ||True            ||-                             ", 
        "count_free      ||int (Field)         ||Count of freed elements.                                    ||True            ||-                             ", 
        "element_size    ||int (Field)         ||Size per element.                                           ||True            ||-                             ", 
        "is_collectable  ||bool (Field)        ||Can this zone be garbage-collected.                         ||True            ||-                             ", 
        "is_exhaustible  ||bool (Field)        ||Whether the zone can be exhausted/filled up.                ||True            ||-                             ", 
        "is_expandable   ||bool (Field)        ||Whether the zone can grow.                                  ||True            ||-                             ", 
        "max_size        ||int (Field)         ||Maximum size the zone can grow to, if any.                  ||True            ||-                             ", 
        "name            ||unicode (Field)     ||Name of the zone as used by kernel.                         ||True            ||-                             ", 
        "page_count      ||int (Field)         ||Count of memory pages used by the zone.                     ||True            ||-                             ", 
        "tracks_pages    ||bool (Field)        ||Whether the zone tracks the pages it used.                  ||True            ||-                             ", 
        "type            ||unicode (Field)     ||Type of thing found in the zone.                            ||True            ||-                             ", 
        "", 
        "****************************************** Buffer: Stores raw memory contents at a given address. ******************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "contents        ||unicode (Field)     ||Raw contents (contains unprintable characters).             ||True            ||-                             ", 
        "context         ||Identity (Field)    ||Owner of the buffer, e.g. a zone, terminal...               ||True            ||-                             ", 
        "end             ||BaseObject (Field)  ||Pointer to end of the buffer.                               ||True            ||-                             ", 
        "kind            ||str (Field)         ||Ring buffer's end can be lower than its start.              ||True            ||-                             ", 
        "purpose         ||str (Field)         ||Use of the buffer, e.g. pipe, tty, mmap...                  ||True            ||-                             ", 
        "size            ||int (Field)         ||Size of the buffer (in bytes).                              ||True            ||-                             ", 
        "start           ||BaseObject (Field)  ||Pointer to start of the buffer.                             ||True            ||-                             ", 
        "state           ||str (Field)         ||Allocation state (freed or not).                            ||True            ||-                             ", 
        "", 
        "************************************ Connection: Connection (TCP) or datagram, if connectionless (UDP). ************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "active          ||bool (Field)        ||Human-readable state.                                       ||True            ||-                             ", 
        "bytes_received  ||int (Field)         ||Bytes in.                                                   ||True            ||-                             ", 
        "bytes_sent      ||int (Field)         ||Bytes out.                                                  ||True            ||-                             ", 
        "destination     ||Identity (Field)    ||Destination of TCP connection or of UDP datagram.           ||True            ||-                             ", 
        "handles         ||Identity (Alias)    ||Handles by processes on this socket.                        ||False           ||Aliased to &Handle/resource   ", 
        "packets_received||int (Field)         ||Packets in.                                                 ||True            ||-                             ", 
        "packets_sent    ||int (Field)         ||Packets out.                                                ||True            ||-                             ", 
        "protocol_family ||unicode (Field)     ||Protocol family determines addressing.                      ||True            ||-                             ", 
        "source          ||Identity (Field)    ||Source of TCP connection or of UDP datagram.                ||True            ||-                             ", 
        "", 
        "******************************** Endpoint: One side of a connection - source/client or server/destination. ********************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "addressing_famil||str (Field)         ||Addressing family determines L3 protocol.                   ||True            ||-                             ", 
        "y               ||                    ||                                                            ||                ||                              ", 
        "inbound         ||Identity (Alias)    ||Connections that have this endpoint as dest.                ||False           ||Aliased to                    ", 
        "                ||                    ||                                                            ||                ||&Connection/destination       ", 
        "interface       ||Identity (Field)    ||Associated network interface, if known.                     ||True            ||-                             ", 
        "local           ||bool (Field)        ||Is this endpoint on this system.                            ||True            ||-                             ", 
        "outbound        ||Identity (Alias)    ||Connection from this endpoint to others.                    ||False           ||Aliased to &Connection/source ", 
        "", 
        "******************************************** Entity: A special component that's always present. ********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "collectors      ||list (Field)        ||The collectors that contributed to this entity.             ||True            ||-                             ", 
        "identity        ||Identity (Field)    ||The identity.                                               ||True            ||-                             ", 
        "", 
        "******************************** Event: Something that happened, e.g. 'User/name=h4x0r', 'pwned', 'local/*' ********************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "action          ||unicode (Field)     ||One word action, such as 'created' or 'pwned'.              ||True            ||-                             ", 
        "actor           ||Identity (Field)    ||Who done it.                                                ||True            ||-                             ", 
        "category        ||str (Field)         ||In lieu of timestamp, approximate timing, e.g. recent.      ||True            ||-                             ", 
        "description     ||unicode (Field)     ||What happened. Did Timmy fall down the well?                ||True            ||-                             ", 
        "native_id       ||unicode (Field)     ||Native event ID, such as Windows Event ID, etc.             ||True            ||-                             ", 
        "target          ||Identity (Field)    ||Unwitting (or is it) victim.                                ||True            ||-                             ", 
        "timestamp       ||datetime (Field)    ||When did this go down?                                      ||True            ||-                             ", 
        "", 
        "******************************************************* ExperimentalSocket: A socket *******************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "bytes_received  ||int (Field)         ||Bytes in.                                                   ||True            ||-                             ", 
        "bytes_sent      ||int (Field)         ||Bytes out.                                                  ||True            ||-                             ", 
        "endpoint        ||Identity (Field)    ||The endpoint this socket is attached to.                    ||True            ||-                             ", 
        "packets_received||int (Field)         ||Packets in.                                                 ||True            ||-                             ", 
        "packets_sent    ||int (Field)         ||Packets out.                                                ||True            ||-                             ", 
        "state           ||str (Field)         ||State the socket is in.                                     ||True            ||-                             ", 
        "", 
        "********************************************** File: A file/directory/socket with a FS path. **********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "handles         ||Identity (Alias)    ||Handles by processes on this file.                          ||False           ||Aliased to &Handle/resource   ", 
        "mount           ||Identity (Field)    ||The volume this file is on.                                 ||True            ||-                             ", 
        "parent          ||Identity (Field)    ||Parent file (directory, ZIP archive, etc.)                  ||True            ||-                             ", 
        "path            ||unicode (Field)     ||The filesystem path to this file.                           ||True            ||-                             ", 
        "type            ||str (Field)         ||Is this a directory, normal file, etc.                      ||True            ||-                             ", 
        "", 
        "****************************************** Handle: A handle from process to file/connection/etc. ******************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "fd              ||int (Field)         ||File descriptor as known to the process.                    ||True            ||-                             ", 
        "flags           ||None (Field)        ||Arbitrary OS-level flags.                                   ||True            ||-                             ", 
        "process         ||Identity (Field)    ||The process that owns this handle.                          ||True            ||-                             ", 
        "resource        ||Identity (Field)    ||The object of the handle, e.g. file or socket               ||True            ||-                             ", 
        "", 
        "********************************************** Named: Human-readable identifying information. **********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "kind            ||unicode (Field)     ||Human-readable type                                         ||True            ||-                             ", 
        "name            ||unicode (Field)     ||Human-readable name                                         ||True            ||-                             ", 
        "", 
        "************************************************** NetworkInterface: A network interface. **************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "endpoints       ||Identity (Alias)    ||Endpoints of this interface (IP/MAC/etc.)                   ||False           ||Aliased to &Endpoint/interface", 
        "name            ||unicode (Field)     ||E.g. en01, tunnel, etc.                                     ||True            ||-                             ", 
        "state           ||str (Field)         ||State of the inteface.                                      ||True            ||-                             ", 
        "", 
        "***************************************** OSIDataLayer: OSI layers 5-7 constitute the data layer. *****************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "protocol        ||unicode (Field)     ||Highest-layer protocol (usually layer 7).                   ||True            ||-                             ", 
        "", 
        "****************************************************** OSILayer2: MAC-layer endpoint. ******************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "address         ||unicode (Field)     ||Address at layer 2.                                         ||True            ||-                             ", 
        "protocol        ||unicode (Field)     ||Layer 2 protocol.                                           ||True            ||-                             ", 
        "", 
        "**************************************************** OSILayer3: Network-layer endpoint. ****************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "address         ||unicode (Field)     ||Address at layer 3.                                         ||True            ||-                             ", 
        "protocol        ||unicode (Field)     ||Layer 3 protocol.                                           ||True            ||-                             ", 
        "", 
        "*************************************************** OSILayer4: Transport-layer endpoint. ***************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "port            ||int (Field)         ||TCP/UDP port.                                               ||True            ||-                             ", 
        "protocol        ||unicode (Field)     ||Layer 4 protocol.                                           ||True            ||-                             ", 
        "state           ||unicode (Field)     ||State if stateful.                                          ||True            ||-                             ", 
        "", 
        "********************************************** Permissions: Basic permissions and ownership. **********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "acl             ||list (Field)        ||Arbitrary access control list.                              ||True            ||-                             ", 
        "chmod           ||int (Field)         ||UNIX-like permissions integer.                              ||True            ||-                             ", 
        "group           ||Identity (Field)    ||Group who owns this.                                        ||True            ||-                             ", 
        "owner           ||Identity (Field)    ||User who owns this.                                         ||True            ||-                             ", 
        "", 
        "*********************************************************** Process: A process. ***********************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "arguments       ||list (Field)        ||List of arguments.                                          ||False           ||-                             ", 
        "children        ||Identity (Alias)    ||Children of this process.                                   ||False           ||Aliased to &Process/parent    ", 
        "command         ||unicode (Field)     ||The path to the binary or the command that executed.        ||True            ||-                             ", 
        "cr3             ||Pointer (Field)     ||Saved CR3 value (DTB location).                             ||True            ||-                             ", 
        "env             ||unicode (Field)     ||Process env variables.                                      ||False           ||-                             ", 
        "handles         ||Identity (Alias)    ||Handles owned by this process.                              ||False           ||Aliased to &Handle/process    ", 
        "image_file      ||Identity (Field)    ||The file where the process was loaded from.                 ||False           ||-                             ", 
        "is_64bit        ||bool (Field)        ||Is the process running in 64bit.                            ||True            ||-                             ", 
        "parent          ||Identity (Field)    ||Process that spawned this process.                          ||True            ||-                             ", 
        "pid             ||int (Field)         ||PID, on systems that have one.                              ||True            ||-                             ", 
        "priority        ||int (Field)         ||Priority of this process.                                   ||False           ||-                             ", 
        "session         ||Identity (Field)    ||The session this process belongs to.                        ||True            ||-                             ", 
        "user            ||Identity (Field)    ||The user with whose credentials this is running.            ||True            ||-                             ", 
        "", 
        "********************************************************* Session: A user session. *********************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "sid             ||int (Field)         ||Session ID.                                                 ||True            ||-                             ", 
        "user            ||Identity (Field)    ||The user.                                                   ||True            ||-                             ", 
        "", 
        "************************************** SignatureMatch: Stores a successful string or signature match. **************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "matched_object  ||Identity (Field)    ||The object containing the match.                            ||True            ||-                             ", 
        "method          ||str (Field)         ||How was the scan done?                                      ||True            ||-                             ", 
        "signature       ||unicode (Field)     ||The signature used in the search.                           ||True            ||-                             ", 
        "", 
        "************************************************************* Socket: A socket *************************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "address         ||unicode (Field)     ||Memory address of the socket.                               ||True            ||-                             ", 
        "connected       ||unicode (Field)     ||Memory address of other socket in pair.                     ||True            ||-                             ", 
        "file            ||Identity (Field)    ||The file this socket binds to.                              ||True            ||-                             ", 
        "type            ||str (Field)         ||Type in AF_UNIX/AF_LOCAL family.                            ||True            ||-                             ", 
        "", 
        "*********************************************** Struct: Stores base objects, mostly structs. ***********************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "base            ||BaseObject (Field)  ||An instance of BaseObject.                                  ||True            ||-                             ", 
        "state           ||str (Field)         ||Allocation state (freed or not).                            ||True            ||-                             ", 
        "type            ||unicode (Field)     ||Class name of the base object.                              ||True            ||-                             ", 
        "", 
        "*************************************************** Terminal: A terminal (tty) session. ***************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "file            ||Identity (Field)    ||The file for this TTY.                                      ||True            ||-                             ", 
        "session         ||Identity (Field)    ||The login session of this TTY.                              ||True            ||-                             ", 
        "", 
        "*************************************** Timestamps: Standard times, such as ctime, atime, mtime, ... ***************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "accessed_at     ||datetime (Field)    ||Access time.                                                ||True            ||-                             ", 
        "backup_at       ||datetime (Field)    ||Backup time.                                                ||False           ||-                             ", 
        "created_at      ||datetime (Field)    ||Creation/start time.                                        ||True            ||-                             ", 
        "destroyed_at    ||datetime (Field)    ||Deletion/destruction/stop time.                             ||True            ||-                             ", 
        "modified_at     ||datetime (Field)    ||Modification time.                                          ||True            ||-                             ", 
        "", 
        "********************************************************** User: A user account. **********************************************************", 
        "     Field      ||        Type        ||                        Description                         ||Show by default ||            Notes             ", 
        "----------------||--------------------||------------------------------------------------------------||----------------||------------------------------", 
        "home_dir        ||Identity (Field)    ||File that represents the user's home dir.                   ||True            ||-                             ", 
        "processes       ||Identity (Alias)    ||Processes running as this user.                             ||False           ||Aliased to &Process/user      ", 
        "real_name       ||unicode (Field)     ||User's real name.                                           ||True            ||-                             ", 
        "uid             ||int (Field)         ||A unique user id, if any.                                   ||True            ||-                             ", 
        "username        ||unicode (Field)     ||System username.                                            ||True            ||-                             "
    ], 
    "options": {
        "--name_resolution_strategies": [
            "Module", 
            "Symbol"
        ], 
        "executable": "rekall ", 
        "--filename": "/Users/adamsh/Projects/test/tigger/tigger.vmem.E01", 
        "--cache_dir": "/Users/adamsh/Projects/test/tigger/../profile_cache/", 
        "commandline": "describe", 
        "pid": 1724, 
        "--renderer": "test", 
        "test_class": "TestEntityDescribe", 
        "tempdir": "/var/folders/00/1pjr0000h01000cxqpysvccm006t70/T/tmp8y1vEC/TestEntityDescribeThread-1", 
        "executed_command": "rekall  --renderer 'test' --cache_dir '/Users/adamsh/Projects/test/tigger/../profile_cache/' --filename '/Users/adamsh/Projects/test/tigger/tigger.vmem.E01' --name_resolution_strategies 'Module' 'Symbol' - describe", 
        "testdir": "/Users/adamsh/Projects/test/tigger"
    }
}