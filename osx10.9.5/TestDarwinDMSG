#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestDarwinDMSG /Users/adamsh/Projects/rekall-test/osx10.9.5/TestDarwinDMSG
elif [ "$1" == "meld" ]; then
   meld /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestDarwinDMSG /Users/adamsh/Projects/rekall-test/osx10.9.5/TestDarwinDMSG
elif [ "$1" == "diff" ]; then
   diff /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestDarwinDMSG /Users/adamsh/Projects/rekall-test/osx10.9.5/TestDarwinDMSG
elif [ "$1" == "run" ]; then
   rekall  --renderer 'test' --filename '/Users/adamsh/Projects/rekall-test/osx10.9.5/vmem.e01' --name_resolution_strategies 'Module,Symbol' - dmesg
else
   less /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestDarwinDMSG
fi
exit 0
{
    "errors": {}, 
    "time_used": 8.738728046417236, 
    "return_code": 0, 
    "failures": {
        "testCase (__main__.TestDarwinDMSG)": "Traceback (most recent call last):\n  File \"/Users/adamsh/Projects/rekall/rekall/testlib.py\", line 221, in run\n    testMethod()\n  File \"/Users/adamsh/Projects/rekall/rekall/testlib.py\", line 271, in testCase\n    self.assertEqual(previous, current)\nAssertionError: 86 != 88\n"
    }, 
    "output": [
        "                                    Message                                     ", 
        "--------------------------------------------------------------------------------", 
        "Longterm timer threshold: 1000 ms                                               ", 
        "Darwin Kernel Version 13.4.0: Sun Aug 17 19:50:11 PDT 2014;                     ", 
        "root:xnu-2422.115.4~1/RELEASE_X86_64                                            ", 
        "vm_page_bootstrap: 55688 free pages and 75384 wired pages                       ", 
        "kext submap [0xffffff7f807a9000 - 0xffffff8000000000], kernel text              ", 
        "[0xffffff8000200000 - 0xffffff80007a9000]                                       ", 
        "zone leak detection enabled                                                     ", 
        "\"vm_compressor_mode\" is 4                                                       ", 
        "standard timeslicing quantum is 10000 us                                        ", 
        "standard background quantum is 2500 us                                          ", 
        "mig_table_max_displ = 74                                                        ", 
        "AppleACPICPU: ProcessorId=0 LocalApicId=0 Enabled                               ", 
        "calling mpo_policy_init for TMSafetyNet                                         ", 
        "Security policy loaded: Safety net for Time Machine (TMSafetyNet)               ", 
        "calling mpo_policy_init for Sandbox                                             ", 
        "Security policy loaded: Seatbelt sandbox policy (Sandbox)                       ", 
        "calling mpo_policy_init for Quarantine                                          ", 
        "Security policy loaded: Quarantine policy (Quarantine)                          ", 
        "Copyright (c) 1982, 1986, 1989, 1991, 1993                                      ", 
        "        The Regents of the University of California. All rights reserved.       ", 
        "MAC Framework successfully initialized                                          ", 
        "using 2621 buffer headers and 2621 cluster IO buffer headers                    ", 
        "AppleKeyStore starting (BUILT: Aug 17 2014 20:21:39)                            ", 
        "IOAPIC: Version 0x11 Vectors 64:87                                              ", 
        "ACPI: sleep states S5                                                           ", 
        "pci (build 20:04:33 Aug 17 2014), flags 0x63008, pfm64 (36 cpu) 0xf80000000,    ", 
        "0x80000000                                                                      ", 
        "[ PCI configuration begin ]                                                     ", 
        "console relocated to 0x80000000                                                 ", 
        "[ PCI configuration end, bridges 3, devices 8 ]                                 ", 
        "RTC: Only single RAM bank (128 bytes)                                           ", 
        "USBF:    0.612    We could not find a corresponding USB EHCI controller for our ", 
        "OHCI controller at PCI device number31                                          ", 
        "mcache: 1 CPU(s), 64 bytes CPU cache line size                                  ", 
        "mbinit: done [64 MB total pool size, (42/21) split]                             ", 
        "Pthread support ABORTS when sync kernel primitives misused                      ", 
        "rooting via boot-uuid from /chosen: 4C7CF0C0-FB3A-3372-B8EB-30F4FCB23BD3        ", 
        "Waiting on <dict ID=\"0\"><key>IOProviderClass</key><string                       ", 
        "ID=\"1\">IOResources</string><key>IOResourceMatch</key><string ID=\"2\">boot-uuid-  ", 
        "media</string></dict>                                                           ", 
        "com.apple.AppleFSCompressionTypeZlib kmod start                                 ", 
        "com.apple.AppleFSCompressionTypeLZVN kmod start                                 ", 
        "com.apple.AppleFSCompressionTypeDataless kmod start                             ", 
        "com.apple.AppleFSCompressionTypeZlib load succeeded                             ", 
        "com.apple.AppleFSCompressionTypeLZVN load succeeded                             ", 
        "com.apple.AppleFSCompressionTypeDataless load succeeded                         ", 
        "USBF:    0.703    AppleUSBOHCI::CheckSleepCapability - controller will be       ", 
        "unloaded across sleep                                                           ", 
        "USBF:    0.708    AppleUSBOHCI::CheckSleepCapability - controller will be       ", 
        "unloaded across sleep                                                           ", 
        "Got boot device = IOService:/AppleACPIPlatformExpert/PCI0@1e0000/AppleACPIPCI/pc", 
        "i8086,2829@1F,2/AppleICH8AHCI/PRT0@0/IOAHCIDevice@0/AppleAHCIDiskDriver/IOAHCIBl", 
        "ockStorageDevice/IOBlockStorageDriver/VBOX HARDDISK                             ", 
        "Media/IOGUIDPartitionScheme/Untitled 1@2                                        ", 
        "BSD root: disk0s2, major 1, minor 2                                             ", 
        "jnl: b(1, 2): replay_journal: from: 9620992 to: 10668544 (joffset 0x53c000)     ", 
        "jnl: b(1, 2): journal replay done.                                              ", 
        "hfs: mounted Untitled 1 on device root_device                                   ", 
        "hfs: Removed 10 orphaned / unlinked files and 0 directories                     ", 
        "BootCache: cache size (441450496 bytes) too large for physical memory (536870912", 
        "bytes), capping at 268435456 bytes                                              ", 
        "VM Swap Subsystem is ON                                                         ", 
        "Waiting for DSMOS...                                                            ", 
        "flow_divert_kctl_disconnect (0): disconnecting group 1                          ", 
        "init                                                                            ", 
        "probe                                                                           ", 
        "start                                                                           ", 
        "[IOBluetoothHCIController][start] -- completed                                  ", 
        "SMC::smcReadKeyAction ERROR: smcReadData8 failed for key LsNM (kSMCKeyNotFound) ", 
        "SMC::smcReadKeyAction ERROR LsNM kSMCKeyNotFound(0x84) fKeyHashTable=0x0        ", 
        "SMC::smcGetLightshowVers ERROR: smcReadKey LsNM failed (kSMCKeyNotFound)        ", 
        "SMC::smcPublishLightshowVersion ERROR: smcGetLightshowVers failed               ", 
        "(kSMCKeyNotFound)                                                               ", 
        "SMC::smcInitHelper ERROR: smcPublishLightshowVersion failed (kSMCKeyNotFound)   ", 
        "Previous Shutdown Cause: 3                                                      ", 
        "SMC::smcInitHelper ERROR: MMIO regMap == NULL - fall back to old SMC mode       ", 
        "DSMOS has arrived                                                               ", 
        "Ethernet [Intel8254x]: Link up on en0, 10-Megabit, Half-duplex, No flow-control,", 
        "Debug [796d,bc08,0de1,1e00,01e0,3c00]                                           ", 
        "ACPI_SMC_PlatformPlugin::start -                                                ", 
        "waitForService(resourceMatching(AppleIntelCPUPowerManagement) timed out         ", 
        "[AGPM Controller] unknownPlatform                                               ", 
        "Sound assertion in AppleHDAEngine at line 578                                   ", 
        "**** [IOBluetoothHCIController][SearchForTransportEventTimeOutHandler] --       ", 
        "Missing Bluetooth Controller Transport!                                         ", 
        "AppleKeyStore:Sending lock change 0                                             "
    ], 
    "options": {
        "--name_resolution_strategies": "Module,Symbol", 
        "executable": "rekall ", 
        "--filename": "/Users/adamsh/Projects/rekall-test/osx10.9.5/vmem.e01", 
        "commandline": "dmesg", 
        "--renderer": "test", 
        "test_class": "TestDarwinDMSG", 
        "tempdir": "/var/folders/yc/4zng19655k37kyxgskb3vvf0006t70/T/tmpB0dT24/TestDarwinDMSGThread-3", 
        "executed_command": "rekall  --renderer 'test' --filename '/Users/adamsh/Projects/rekall-test/osx10.9.5/vmem.e01' --name_resolution_strategies 'Module,Symbol' - dmesg", 
        "testdir": "/Users/adamsh/Projects/rekall-test/osx10.9.5"
    }
}