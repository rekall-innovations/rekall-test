#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /Users/adamsh/Projects/test/osx10.9.5/output/TestListZones /Users/adamsh/Projects/test/osx10.9.5/TestListZones
elif [ "$1" == "meld" ]; then
   meld /Users/adamsh/Projects/test/osx10.9.5/output/TestListZones /Users/adamsh/Projects/test/osx10.9.5/TestListZones
elif [ "$1" == "diff" ]; then
   diff /Users/adamsh/Projects/test/osx10.9.5/output/TestListZones /Users/adamsh/Projects/test/osx10.9.5/TestListZones
elif [ "$1" == "run" ]; then
   rekall  --renderer 'test' --filename '/Users/adamsh/Projects/test/osx10.9.5/vmem.e01' --name_resolution_strategies 'Module' 'Symbol' - zones
else
   less /Users/adamsh/Projects/test/osx10.9.5/output/TestListZones
fi
exit 0
{
    "errors": {}, 
    "time_used": 8.346229076385498, 
    "return_code": 0, 
    "failures": {
        "testCase (__main__.TestListZones)": "Traceback (most recent call last):\n  File \"/Users/adamsh/Projects/rekall/rekall/testlib.py\", line 227, in run\n    testMethod()\n  File \"/Users/adamsh/Projects/rekall/rekall/testlib.py\", line 277, in testCase\n    self.assertEqual(previous, current)\nAssertionError: 2 != 193\n"
    }, 
    "output": [
        "        name        ||    count_active    ||     count_free     ||    element_size    ||    tracks_pages    ||   allows_foreign   ", 
        "--------------------||--------------------||--------------------||--------------------||--------------------||--------------------", 
        "HFS dirhint         ||44                  ||9792                ||56                  ||True                ||False               ", 
        "HFS fork            ||5014                ||422                 ||128                 ||False               ||False               ", 
        "HFS node            ||8431                ||5293                ||328                 ||False               ||False               ", 
        "Journal             ||1                   ||0                   ||416                 ||False               ||False               ", 
        "MAC Labels          ||2088                ||28692               ||64                  ||True                ||False               ", 
        "NFS mount           ||0                   ||0                   ||752                 ||False               ||False               ", 
        "NFS node            ||0                   ||0                   ||752                 ||False               ||False               ", 
        "NFS req             ||0                   ||0                   ||336                 ||True                ||False               ", 
        "NFSV3 diroff        ||0                   ||0                   ||240                 ||False               ||False               ", 
        "NFSV3 srvdesc       ||0                   ||0                   ||344                 ||False               ||False               ", 
        "Reserved VM map     ||27                  ||1512                ||80                  ||False               ||True                ", 
        "entries             ||                    ||                    ||                    ||                    ||                    ", 
        "Transaction         ||1                   ||72                  ||104                 ||False               ||False               ", 
        "VM map copies       ||0                   ||1146                ||88                  ||False               ||False               ", 
        "VM map entries      ||10636               ||113428              ||80                  ||False               ||False               ", 
        "aiowq               ||0                   ||0                   ||176                 ||False               ||False               ", 
        "alarms              ||1                   ||0                   ||80                  ||False               ||False               ", 
        "audit_mac_label_zone||0                   ||38                  ||1024                ||False               ||False               ", 
        "audit_zone          ||0                   ||65                  ||1512                ||False               ||False               ", 
        "bridge_rtnode       ||0                   ||0                   ||64                  ||True                ||False               ", 
        "buf headers         ||0                   ||0                   ||240                 ||False               ||False               ", 
        "buf.1024            ||0                   ||0                   ||1024                ||False               ||False               ", 
        "buf.2048            ||0                   ||0                   ||2048                ||False               ||False               ", 
        "buf.4096            ||3                   ||156                 ||4096                ||False               ||False               ", 
        "buf.512             ||1                   ||546                 ||512                 ||False               ||False               ", 
        "buf.8192            ||2617                ||3865                ||8192                ||False               ||False               ", 
        "classq_sfb          ||0                   ||0                   ||264                 ||False               ||False               ", 
        "classq_sfb_bins     ||0                   ||0                   ||2576                ||False               ||False               ", 
        "classq_sfb_fcl      ||0                   ||0                   ||768                 ||False               ||False               ", 
        "cluster_read        ||643                 ||4                   ||40                  ||True                ||False               ", 
        "cluster_write       ||134                 ||314                 ||248                 ||False               ||False               ", 
        "compressor_pager    ||4720                ||741                 ||56                  ||True                ||False               ", 
        "compressor_segment  ||548                 ||34                  ||144                 ||False               ||False               ", 
        "cred                ||227                 ||325                 ||144                 ||False               ||False               ", 
        "decmpfs_cnode       ||2966                ||10                  ||56                  ||True                ||False               ", 
        "device node pager   ||18                  ||12                  ||56                  ||True                ||False               ", 
        "structures          ||                    ||                    ||                    ||                    ||                    ", 
        "divzone             ||0                   ||0                   ||488                 ||False               ||False               ", 
        "dtrace.dtrace_probe_||3                   ||0                   ||128                 ||False               ||False               ", 
        "t                   ||                    ||                    ||                    ||                    ||                    ", 
        "fadv_zone           ||0                   ||0                   ||16                  ||True                ||False               ", 
        "file desc           ||107                 ||132                 ||88                  ||False               ||False               ", 
        "fileglob            ||845                 ||25898               ||88                  ||False               ||False               ", 
        "fileproc            ||1019                ||35413               ||24                  ||True                ||False               ", 
        "flow_divert_group   ||0                   ||1                   ||64                  ||True                ||False               ", 
        "flow_divert_pcb     ||0                   ||0                   ||144                 ||False               ||False               ", 
        "fs-event-buf        ||0                   ||1790                ||80                  ||False               ||True                ", 
        "host_notify         ||74                  ||125                 ||24                  ||True                ||False               ", 
        "if_llreach          ||1                   ||1                   ||120                 ||False               ||False               ", 
        "ifmultiaddr         ||20                  ||1                   ||96                  ||False               ||False               ", 
        "ifnet               ||4                   ||0                   ||2728                ||False               ||False               ", 
        "ifnet_fc_zone       ||0                   ||0                   ||40                  ||True                ||False               ", 
        "ifnet_filter        ||0                   ||0                   ||96                  ||False               ||False               ", 
        "ifnet_proto         ||6                   ||4                   ||88                  ||False               ||False               ", 
        "ifnet_proto_hash    ||4                   ||0                   ||32                  ||True                ||False               ", 
        "ifnet_tcpstat       ||4                   ||0                   ||128                 ||False               ||False               ", 
        "ifnet_udpstat       ||4                   ||0                   ||80                  ||False               ||False               ", 
        "igmp_ifinfo         ||4                   ||0                   ||160                 ||False               ||False               ", 
        "in6_ifaddr          ||3                   ||0                   ||336                 ||True                ||False               ", 
        "in6_msource         ||0                   ||0                   ||48                  ||True                ||False               ", 
        "in6_multi           ||9                   ||0                   ||216                 ||False               ||False               ", 
        "in6_multi_mship     ||23                  ||0                   ||24                  ||True                ||False               ", 
        "in_ifaddr           ||2                   ||0                   ||224                 ||False               ||False               ", 
        "in_msource          ||0                   ||0                   ||32                  ||True                ||False               ", 
        "in_multi            ||4                   ||0                   ||216                 ||False               ||False               ", 
        "ip6_moptions        ||2                   ||20                  ||64                  ||True                ||False               ", 
        "ip6_msource         ||0                   ||0                   ||56                  ||True                ||False               ", 
        "ip_moptions         ||2                   ||16                  ||72                  ||False               ||False               ", 
        "ip_msource          ||0                   ||0                   ||40                  ||True                ||False               ", 
        "ipc kmsgs           ||289                 ||373                 ||256                 ||False               ||False               ", 
        "ipc port sets       ||462                 ||319                 ||88                  ||False               ||False               ", 
        "ipc ports           ||6286                ||18438               ||160                 ||False               ||False               ", 
        "ipc spaces          ||110                 ||132                 ||48                  ||True                ||False               ", 
        "kalloc.1024         ||739                 ||261906              ||1024                ||False               ||False               ", 
        "kalloc.128          ||9615                ||212288              ||128                 ||False               ||False               ", 
        "kalloc.16           ||14301               ||875996              ||16                  ||True                ||False               ", 
        "kalloc.2048         ||144                 ||65492               ||2048                ||False               ||False               ", 
        "kalloc.256          ||2507                ||66848               ||256                 ||False               ||False               ", 
        "kalloc.32           ||11285               ||621706              ||32                  ||True                ||False               ", 
        "kalloc.4096         ||189                 ||6905                ||4096                ||False               ||False               ", 
        "kalloc.512          ||7128                ||45099               ||512                 ||False               ||False               ", 
        "kalloc.64           ||26871               ||975861              ||64                  ||True                ||False               ", 
        "kalloc.8192         ||330                 ||11913               ||8192                ||False               ||False               ", 
        "kerneventpcb        ||7                   ||3                   ||56                  ||True                ||False               ", 
        "knote zone          ||1558                ||2288                ||152                 ||False               ||False               ", 
        "kqueue              ||154                 ||92                  ||184                 ||False               ||False               ", 
        "ksyn_waitq_element  ||0                   ||48                  ||48                  ||True                ||False               ", 
        "zone                ||                    ||                    ||                    ||                    ||                    ", 
        "ksyn_waitqueue zone ||24                  ||4532                ||264                 ||False               ||False               ", 
        "llinfo_arp          ||1                   ||2                   ||56                  ||True                ||False               ", 
        "llinfo_nd6          ||3                   ||0                   ||80                  ||False               ||False               ", 
        "mac_audit_data_zone ||0                   ||0                   ||1024                ||False               ||False               ", 
        "maps                ||122                 ||1881                ||240                 ||False               ||False               ", 
        "mbuf                ||0                   ||0                   ||256                 ||False               ||False               ", 
        "mbuf clust          ||0                   ||0                   ||2048                ||False               ||False               ", 
        "mcache              ||19                  ||0                   ||520                 ||False               ||False               ", 
        "mcache.audit        ||0                   ||0                   ||360                 ||False               ||False               ", 
        "mcache.bkt_1        ||1                   ||1                   ||32                  ||True                ||False               ", 
        "mcache.bkt_143      ||0                   ||0                   ||1168                ||False               ||False               ", 
        "mcache.bkt_15       ||0                   ||0                   ||144                 ||False               ||False               ", 
        "mcache.bkt_165      ||0                   ||0                   ||1344                ||True                ||False               ", 
        "mcache.bkt_3        ||1                   ||1                   ||48                  ||True                ||False               ", 
        "mcache.bkt_31       ||2                   ||1                   ||272                 ||False               ||False               ", 
        "mcache.bkt_47       ||1                   ||1                   ||400                 ||False               ||False               ", 
        "mcache.bkt_63       ||0                   ||0                   ||528                 ||False               ||False               ", 
        "mcache.bkt_7        ||2                   ||1                   ||80                  ||False               ||False               ", 
        "mcache.bkt_95       ||0                   ||0                   ||784                 ||False               ||False               ", 
        "mcache.mext_ref     ||392                 ||0                   ||24                  ||True                ||False               ", 
        "mem_obj_control     ||9194                ||1145                ||16                  ||True                ||False               ", 
        "mk_timer            ||261                 ||198                 ||136                 ||False               ||False               ", 
        "mld_ifinfo          ||4                   ||0                   ||152                 ||False               ||False               ", 
        "mount               ||5                   ||0                   ||2560                ||False               ||False               ", 
        "namecache           ||9109                ||0                   ||96                  ||False               ||False               ", 
        "namei               ||0                   ||28096               ||1024                ||False               ||False               ", 
        "nd6_dad             ||0                   ||1                   ||72                  ||False               ||False               ", 
        "nd6_defrouter       ||0                   ||0                   ||112                 ||False               ||False               ", 
        "nd6_pfxrouter       ||0                   ||0                   ||24                  ||True                ||False               ", 
        "nd6_prefix          ||2                   ||0                   ||224                 ||False               ||False               ", 
        "nd6_prproxy_prelist ||0                   ||0                   ||56                  ||True                ||False               ", 
        "nd6_prproxy_solsrc  ||0                   ||0                   ||40                  ||True                ||False               ", 
        "nd6_prproxy_soltgt  ||0                   ||0                   ||72                  ||False               ||False               ", 
        "ofile tabl          ||11                  ||39                  ||232                 ||False               ||False               ", 
        "pagetable anchors   ||112                 ||366                 ||4096                ||False               ||False               ", 
        "pfappstatepl        ||0                   ||0                   ||32                  ||True                ||False               ", 
        "pffrag              ||0                   ||0                   ||96                  ||False               ||False               ", 
        "pffrcache           ||0                   ||0                   ||96                  ||False               ||False               ", 
        "pffrcent            ||0                   ||0                   ||24                  ||True                ||False               ", 
        "pffrent             ||0                   ||0                   ||48                  ||True                ||False               ", 
        "pfiaddrpl           ||0                   ||0                   ||120                 ||False               ||False               ", 
        "pfosfp              ||407                 ||0                   ||40                  ||True                ||False               ", 
        "pfosfpen            ||696                 ||0                   ||112                 ||False               ||False               ", 
        "pfpooladdrpl        ||0                   ||0                   ||88                  ||False               ||False               ", 
        "pfrkentry           ||0                   ||0                   ||216                 ||False               ||False               ", 
        "pfrkentry2          ||0                   ||0                   ||216                 ||False               ||False               ", 
        "pfrktable           ||0                   ||0                   ||1288                ||True                ||False               ", 
        "pfrulepl            ||7                   ||0                   ||1040                ||False               ||False               ", 
        "pfsrctrpl           ||0                   ||0                   ||152                 ||False               ||False               ", 
        "pfstatekeypl        ||0                   ||0                   ||152                 ||False               ||False               ", 
        "pfstatepl           ||0                   ||0                   ||312                 ||False               ||False               ", 
        "pfstscr             ||0                   ||0                   ||40                  ||True                ||False               ", 
        "pgrp                ||107                 ||78                  ||72                  ||False               ||False               ", 
        "pipe garbage zone   ||0                   ||0                   ||24                  ||True                ||False               ", 
        "pipe zone           ||12                  ||34                  ||176                 ||False               ||False               ", 
        "pktsched_qfq        ||0                   ||0                   ||88                  ||False               ||False               ", 
        "pktsched_qfq_cl     ||0                   ||0                   ||160                 ||False               ||False               ", 
        "pktsched_tcq        ||0                   ||0                   ||64                  ||True                ||False               ", 
        "pktsched_tcq_cl     ||0                   ||0                   ||120                 ||False               ||False               ", 
        "plimit              ||20                  ||3                   ||152                 ||False               ||False               ", 
        "pmap                ||112                 ||366                 ||312                 ||False               ||False               ", 
        "pmc.big zone        ||0                   ||0                   ||184                 ||False               ||False               ", 
        "pmc.small zone      ||0                   ||0                   ||104                 ||False               ||False               ", 
        "proc                ||107                 ||132                 ||1192                ||False               ||False               ", 
        "pstats              ||107                 ||132                 ||456                 ||False               ||False               ", 
        "pv_list             ||83098               ||0                   ||48                  ||False               ||False               ", 
        "ripzone             ||1                   ||0                   ||488                 ||False               ||False               ", 
        "rtentry             ||22                  ||16                  ||320                 ||False               ||False               ", 
        "sack_hole zone      ||0                   ||0                   ||32                  ||False               ||False               ", 
        "semaphores          ||364                 ||5879                ||80                  ||False               ||False               ", 
        "session             ||74                  ||49                  ||352                 ||False               ||False               ", 
        "sigacts             ||107                 ||132                 ||720                 ||False               ||False               ", 
        "socache zone        ||5                   ||0                   ||2024                ||True                ||False               ", 
        "sockaddr_entry      ||0                   ||12                  ||32                  ||True                ||False               ", 
        "sockaddr_list       ||0                   ||12                  ||24                  ||True                ||False               ", 
        "socket              ||277                 ||902                 ||952                 ||False               ||False               ", 
        "specinfo            ||292                 ||216                 ||72                  ||False               ||False               ", 
        "tasks               ||108                 ||132                 ||960                 ||False               ||False               ", 
        "tcp_bwmeas_zone     ||0                   ||0                   ||32                  ||True                ||False               ", 
        "tcp_reass_zone      ||0                   ||0                   ||40                  ||True                ||False               ", 
        "tcpcb               ||1                   ||3                   ||1088                ||False               ||False               ", 
        "thread_call         ||692                 ||1232                ||112                 ||False               ||False               ", 
        "threads             ||437                 ||2004                ||1104                ||False               ||False               ", 
        "ttys                ||0                   ||0                   ||472                 ||False               ||False               ", 
        "ubc_info zone       ||4449                ||392                 ||88                  ||False               ||False               ", 
        "udpcb               ||16                  ||178                 ||488                 ||False               ||False               ", 
        "unpzone             ||246                 ||588                 ||200                 ||False               ||False               ", 
        "uthreads            ||438                 ||2004                ||680                 ||False               ||False               ", 
        "vm object hash      ||9194                ||1145                ||40                  ||True                ||False               ", 
        "entries             ||                    ||                    ||                    ||                    ||                    ", 
        "vm objects          ||11067               ||54043               ||224                 ||False               ||False               ", 
        "vm pages            ||97636               ||49979               ||72                  ||False               ||True                ", 
        "vnode pager         ||4449                ||392                 ||40                  ||True                ||False               ", 
        "structures          ||                    ||                    ||                    ||                    ||                    ", 
        "vnodes              ||9216                ||0                   ||240                 ||False               ||False               ", 
        "wait queue links    ||4186                ||40784               ||72                  ||False               ||False               ", 
        "wait queue sets     ||154                 ||92                  ||64                  ||True                ||False               ", 
        "wait queues         ||1                   ||0                   ||32                  ||True                ||False               ", 
        "x86 fpsave state    ||361                 ||1947                ||512                 ||False               ||False               ", 
        "x86_64 debug state  ||0                   ||0                   ||64                  ||True                ||False               ", 
        "x86_64 saved state  ||438                 ||2004                ||240                 ||False               ||False               ", 
        "zombie              ||0                   ||0                   ||144                 ||False               ||False               ", 
        "zones               ||185                 ||-1                  ||288                 ||False               ||False               "
    ], 
    "options": {
        "--name_resolution_strategies": [
            "Module", 
            "Symbol"
        ], 
        "executable": "rekall ", 
        "--filename": "/Users/adamsh/Projects/test/osx10.9.5/vmem.e01", 
        "commandline": "zones", 
        "--renderer": "test", 
        "test_class": "TestListZones", 
        "tempdir": "/var/folders/00/1pjr0000h01000cxqpysvccm006t70/T/tmplpabav/TestListZonesThread-1", 
        "executed_command": "rekall  --renderer 'test' --filename '/Users/adamsh/Projects/test/osx10.9.5/vmem.e01' --name_resolution_strategies 'Module' 'Symbol' - zones", 
        "testdir": "/Users/adamsh/Projects/test/osx10.9.5"
    }
}