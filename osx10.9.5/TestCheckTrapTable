#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /home/scudette/projects/rekall-test/osx10.9.5/output/TestCheckTrapTable /home/scudette/projects/rekall-test/osx10.9.5/TestCheckTrapTable
elif [ "$1" == "meld" ]; then
   meld /home/scudette/projects/rekall-test/osx10.9.5/output/TestCheckTrapTable /home/scudette/projects/rekall-test/osx10.9.5/TestCheckTrapTable
elif [ "$1" == "diff" ]; then
   diff /home/scudette/projects/rekall-test/osx10.9.5/output/TestCheckTrapTable /home/scudette/projects/rekall-test/osx10.9.5/TestCheckTrapTable
elif [ "$1" == "run" ]; then
   rekall  --cache_dir '/home/scudette/projects/rekall-test/osx10.9.5/../profile_cache/' --format 'test' --filename '/home/scudette/projects/rekall-test/osx10.9.5/vmem.e01' --name_resolution_strategies 'Module' 'Symbol' - check_trap_table
else
   less /home/scudette/projects/rekall-test/osx10.9.5/output/TestCheckTrapTable
fi
exit 0
{
    "errors": {}, 
    "logging": "", 
    "time_used": 3.8585569858551025, 
    "return_code": 0, 
    "failures": {
        "testCase (__main__.TestCheckTrapTable)": "Traceback (most recent call last):\n  File \"/home/scudette/rekall/rekall/testlib.py\", line 235, in run\n    testMethod()\n  File \"/home/scudette/rekall/rekall/testlib.py\", line 285, in testCase\n    self.assertEqual(previous, current)\nAssertionError: 130 != 102\n"
    }, 
    "output": [
        "    Index     ||   Address    ||    Target    ||Symbol", 
        "--------------||--------------||--------------||------", 
        "           0x0||0xff800945ba80||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "           0x2||0xff800945baa0||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "           0x4||0xff800945bac0||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "           0x6||0xff800945bae0||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "           0x8||0xff800945bb00||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "           0xa||0xff800945bb20||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "           0xc||0xff800945bb40||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "           0xe||0xff800945bb60||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x10||0xff800945bb80||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x12||0xff800945bba0||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x14||0xff800945bbc0||0xff8008e1d070||__kernel__!__kernelrpc_mach_vm_allocate_trap", 
        "          0x15||0xff800945bbd0||0x000000000005||Unknown", 
        "          0x16||0xff800945bbe0||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x18||0xff800945bc00||0xff8008e1d100||__kernel__!__kernelrpc_mach_vm_deallocate_trap", 
        "          0x19||0xff800945bc10||0x000000000005||Unknown", 
        "          0x1a||0xff800945bc20||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x1c||0xff800945bc40||0xff8008e1d160||__kernel__!__kernelrpc_mach_vm_protect_trap", 
        "          0x1d||0xff800945bc50||0x000000000007||Unknown", 
        "          0x1e||0xff800945bc60||0xff8008e1d1d0||__kernel__!__kernelrpc_mach_vm_map_trap", 
        "          0x1f||0xff800945bc70||0x000000000008||Unknown", 
        "          0x20||0xff800945bc80||0xff8008e1d2a0||__kernel__!__kernelrpc_mach_port_allocate_trap", 
        "          0x21||0xff800945bc90||0x000000000003||Unknown", 
        "          0x22||0xff800945bca0||0xff8008e1d320||__kernel__!__kernelrpc_mach_port_destroy_trap", 
        "          0x23||0xff800945bcb0||0x000000000002||Unknown", 
        "          0x24||0xff800945bcc0||0xff8008e1d380||__kernel__!__kernelrpc_mach_port_deallocate_trap", 
        "          0x25||0xff800945bcd0||0x000000000002||Unknown", 
        "          0x26||0xff800945bce0||0xff8008e1d3e0||__kernel__!__kernelrpc_mach_port_mod_refs_trap", 
        "          0x27||0xff800945bcf0||0x000000000004||Unknown", 
        "          0x28||0xff800945bd00||0xff8008e1d450||__kernel__!__kernelrpc_mach_port_move_member_trap", 
        "          0x29||0xff800945bd10||0x000000000003||Unknown", 
        "          0x2a||0xff800945bd20||0xff8008e1d4c0||__kernel__!__kernelrpc_mach_port_insert_right_trap", 
        "          0x2b||0xff800945bd30||0x000000000004||Unknown", 
        "          0x2c||0xff800945bd40||0xff8008e1d550||__kernel__!__kernelrpc_mach_port_insert_member_trap", 
        "          0x2d||0xff800945bd50||0x000000000003||Unknown", 
        "          0x2e||0xff800945bd60||0xff8008e1d5c0||__kernel__!__kernelrpc_mach_port_extract_member_trap", 
        "          0x2f||0xff800945bd70||0x000000000003||Unknown", 
        "          0x30||0xff800945bd80||0xff8008e1d630||__kernel__!__kernelrpc_mach_port_construct_trap", 
        "          0x31||0xff800945bd90||0x000000000005||Unknown", 
        "          0x32||0xff800945bda0||0xff8008e1d6d0||__kernel__!__kernelrpc_mach_port_destruct_trap", 
        "          0x33||0xff800945bdb0||0x000000000005||Unknown", 
        "          0x34||0xff800945bdc0||0xff8008e28c10||__kernel__!_mach_reply_port", 
        "          0x36||0xff800945bde0||0xff8008e28be0||__kernel__!_thread_self_trap", 
        "          0x38||0xff800945be00||0xff8008e28ba0||__kernel__!_task_self_trap", 
        "          0x3a||0xff800945be20||0xff8008e25ef0||__kernel__!_host_self_trap", 
        "          0x3c||0xff800945be40||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x3e||0xff800945be60||0xff8008e1e140||__kernel__!_mach_msg_trap", 
        "          0x3f||0xff800945be70||0x000000000007||Unknown", 
        "          0x40||0xff800945be80||0xff8008e1df50||__kernel__!_mach_msg_overwrite_trap", 
        "          0x41||0xff800945be90||0x000000000008||Unknown", 
        "          0x42||0xff800945bea0||0xff8008e3b420||__kernel__!_semaphore_signal_trap", 
        "          0x43||0xff800945beb0||0x000000000001||Unknown", 
        "          0x44||0xff800945bec0||0xff8008e3b4d0||__kernel__!_semaphore_signal_all_trap", 
        "          0x45||0xff800945bed0||0x000000000001||Unknown", 
        "          0x46||0xff800945bee0||0xff8008e3b380||__kernel__!_semaphore_signal_thread_trap", 
        "          0x47||0xff800945bef0||0x000000000002||Unknown", 
        "          0x48||0xff800945bf00||0xff8008e3b900||__kernel__!_semaphore_wait_trap", 
        "          0x49||0xff800945bf10||0x000000000001||Unknown", 
        "          0x4a||0xff800945bf20||0xff8008e3bb10||__kernel__!_semaphore_wait_signal_trap", 
        "          0x4b||0xff800945bf30||0x000000000002||Unknown", 
        "          0x4c||0xff800945bf40||0xff8008e3ba30||__kernel__!_semaphore_timedwait_trap", 
        "          0x4d||0xff800945bf50||0x000000000003||Unknown", 
        "          0x4e||0xff800945bf60||0xff8008e3bc30||__kernel__!_semaphore_timedwait_signal_trap", 
        "          0x4f||0xff800945bf70||0x000000000004||Unknown", 
        "          0x50||0xff800945bf80||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x52||0xff800945bfa0||0xff8008e1d740||__kernel__!__kernelrpc_mach_port_guard_trap", 
        "          0x53||0xff800945bfb0||0x000000000005||Unknown", 
        "          0x54||0xff800945bfc0||0xff8008e1d7b0||__kernel__!__kernelrpc_mach_port_unguard_trap", 
        "          0x55||0xff800945bfd0||0x000000000004||Unknown", 
        "          0x56||0xff800945bfe0||0xff80091d5880||__kernel__!_map_fd", 
        "          0x57||0xff800945bff0||0x000000000005||Unknown", 
        "          0x58||0xff800945c000||0xff800923b850||__kernel__!_task_name_for_pid", 
        "          0x59||0xff800945c010||0x000000000003||Unknown", 
        "          0x5a||0xff800945c020||0xff800923b450||__kernel__!_task_for_pid", 
        "          0x5b||0xff800945c030||0x000000000003||Unknown", 
        "          0x5c||0xff800945c040||0xff800923b320||__kernel__!_pid_for_task", 
        "          0x5d||0xff800945c050||0x000000000002||Unknown", 
        "          0x5e||0xff800945c060||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x60||0xff800945c080||0xff800923cc10||__kernel__!_macx_swapon", 
        "          0x61||0xff800945c090||0x000000000005||Unknown", 
        "          0x62||0xff800945c0a0||0xff800923d060||__kernel__!_macx_swapoff", 
        "          0x63||0xff800945c0b0||0x000000000003||Unknown", 
        "          0x64||0xff800945c0c0||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x66||0xff800945c0e0||0xff800923cbd0||__kernel__!_macx_triggers", 
        "          0x67||0xff800945c0f0||0x000000000004||Unknown", 
        "          0x68||0xff800945c100||0xff800923cae0||__kernel__!_macx_backing_store_suspend", 
        "          0x69||0xff800945c110||0x000000000001||Unknown", 
        "          0x6a||0xff800945c120||0xff800923ca70||__kernel__!_macx_backing_store_recovery", 
        "          0x6b||0xff800945c130||0x000000000001||Unknown", 
        "          0x6c||0xff800945c140||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x6e||0xff800945c160||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x70||0xff800945c180||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x72||0xff800945c1a0||0xff8008e3c7b0||__kernel__!_kern_invalid", 
        "          0x74||0xff800945c1c0||0xff8008e3bd70||__kernel__!_pfz_exit", 
        "          0x76||0xff800945c1e0||0xff8008e3be60||__kernel__!_swtch_pri", 
        "          0x78||0xff800945c200||0xff8008e3bd80||__kernel__!_swtch", 
        "          0x7a||0xff800945c220||0xff8008e3c0b0||__kernel__!_thread_switch", 
        "          0x7b||0xff800945c230||0x000000000003||Unknown", 
        "          0x7c||0xff800945c240||0xff8008e22c00||__kernel__!_clock_sleep_trap", 
        "          0x7d||0xff800945c250||0x000000000005||Unknown", 
        "          0x7e||0xff800945c260||0xff8008e3c7b0||__kernel__!_kern_invalid"
    ], 
    "options": {
        "--name_resolution_strategies": [
            "Module", 
            "Symbol"
        ], 
        "executable": "rekall ", 
        "--filename": "/home/scudette/projects/rekall-test/osx10.9.5/vmem.e01", 
        "--format": "test", 
        "commandline": "check_trap_table", 
        "pid": 232, 
        "test_class": "TestCheckTrapTable", 
        "--cache_dir": "/home/scudette/projects/rekall-test/osx10.9.5/../profile_cache/", 
        "tempdir": "/tmp/tmp35zBLA/TestCheckTrapTableThread-2", 
        "executed_command": "rekall  --cache_dir '/home/scudette/projects/rekall-test/osx10.9.5/../profile_cache/' --format 'test' --filename '/home/scudette/projects/rekall-test/osx10.9.5/vmem.e01' --name_resolution_strategies 'Module' 'Symbol' - check_trap_table", 
        "testdir": "/home/scudette/projects/rekall-test/osx10.9.5"
    }
}