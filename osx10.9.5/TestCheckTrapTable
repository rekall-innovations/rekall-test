#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestCheckTrapTable /Users/adamsh/Projects/rekall-test/osx10.9.5/TestCheckTrapTable
elif [ "$1" == "meld" ]; then
   meld /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestCheckTrapTable /Users/adamsh/Projects/rekall-test/osx10.9.5/TestCheckTrapTable
elif [ "$1" == "diff" ]; then
   diff /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestCheckTrapTable /Users/adamsh/Projects/rekall-test/osx10.9.5/TestCheckTrapTable
elif [ "$1" == "run" ]; then
   rekall  --renderer 'test' --filename '/Users/adamsh/Projects/rekall-test/osx10.9.5/vmem.e01' --name_resolution_strategies 'Module,Symbol' - check_trap_table
else
   less /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestCheckTrapTable
fi
exit 0
{
    "errors": {}, 
    "time_used": 8.197297096252441, 
    "return_code": 0, 
    "failures": {
        "testCase (__main__.TestCheckTrapTable)": "Traceback (most recent call last):\n  File \"/Users/adamsh/Projects/rekall/rekall/testlib.py\", line 221, in run\n    testMethod()\n  File \"/Users/adamsh/Projects/rekall/rekall/testlib.py\", line 271, in testCase\n    self.assertEqual(previous, current)\nAssertionError: u'           0x0||0xff800ee5ba80||0xff800e83c7b0||Unknown                        [truncated]... != u'           0x0||0xff800945ba80||0xff8008e3c7b0||Unknown                        [truncated]...\n-            0x0||0xff800ee5ba80||0xff800e83c7b0||Unknown                       \n?                        ^^               -\n+            0x0||0xff800945ba80||0xff8008e3c7b0||Unknown                       \n?                        ^^              +\n\n"
    }, 
    "output": [
        "    Index     ||   Address    ||    Target    ||            Symbol            ", 
        "--------------||--------------||--------------||------------------------------", 
        "           0x0||0xff800945ba80||0xff8008e3c7b0||Unknown                       ", 
        "           0x1||0xff800945ba90||-             ||Unknown                       ", 
        "           0x2||0xff800945baa0||0xff8008e3c7b0||Unknown                       ", 
        "           0x3||0xff800945bab0||-             ||Unknown                       ", 
        "           0x4||0xff800945bac0||0xff8008e3c7b0||Unknown                       ", 
        "           0x5||0xff800945bad0||-             ||Unknown                       ", 
        "           0x6||0xff800945bae0||0xff8008e3c7b0||Unknown                       ", 
        "           0x7||0xff800945baf0||-             ||Unknown                       ", 
        "           0x8||0xff800945bb00||0xff8008e3c7b0||Unknown                       ", 
        "           0x9||0xff800945bb10||-             ||Unknown                       ", 
        "           0xa||0xff800945bb20||0xff8008e3c7b0||Unknown                       ", 
        "           0xb||0xff800945bb30||-             ||Unknown                       ", 
        "           0xc||0xff800945bb40||0xff8008e3c7b0||Unknown                       ", 
        "           0xd||0xff800945bb50||-             ||Unknown                       ", 
        "           0xe||0xff800945bb60||0xff8008e3c7b0||Unknown                       ", 
        "           0xf||0xff800945bb70||-             ||Unknown                       ", 
        "          0x10||0xff800945bb80||0xff8008e3c7b0||Unknown                       ", 
        "          0x11||0xff800945bb90||-             ||Unknown                       ", 
        "          0x12||0xff800945bba0||0xff8008e3c7b0||Unknown                       ", 
        "          0x13||0xff800945bbb0||-             ||Unknown                       ", 
        "          0x14||0xff800945bbc0||0xff8008e1d070||Unknown                       ", 
        "          0x15||0xff800945bbd0||0x000000000005||Unknown                       ", 
        "          0x16||0xff800945bbe0||0xff8008e3c7b0||Unknown                       ", 
        "          0x17||0xff800945bbf0||-             ||Unknown                       ", 
        "          0x18||0xff800945bc00||0xff8008e1d100||Unknown                       ", 
        "          0x19||0xff800945bc10||0x000000000005||Unknown                       ", 
        "          0x1a||0xff800945bc20||0xff8008e3c7b0||Unknown                       ", 
        "          0x1b||0xff800945bc30||-             ||Unknown                       ", 
        "          0x1c||0xff800945bc40||0xff8008e1d160||Unknown                       ", 
        "          0x1d||0xff800945bc50||0x000000000007||Unknown                       ", 
        "          0x1e||0xff800945bc60||0xff8008e1d1d0||Unknown                       ", 
        "          0x1f||0xff800945bc70||0x000000000008||Unknown                       ", 
        "          0x20||0xff800945bc80||0xff8008e1d2a0||Unknown                       ", 
        "          0x21||0xff800945bc90||0x000000000003||Unknown                       ", 
        "          0x22||0xff800945bca0||0xff8008e1d320||Unknown                       ", 
        "          0x23||0xff800945bcb0||0x000000000002||Unknown                       ", 
        "          0x24||0xff800945bcc0||0xff8008e1d380||Unknown                       ", 
        "          0x25||0xff800945bcd0||0x000000000002||Unknown                       ", 
        "          0x26||0xff800945bce0||0xff8008e1d3e0||Unknown                       ", 
        "          0x27||0xff800945bcf0||0x000000000004||Unknown                       ", 
        "          0x28||0xff800945bd00||0xff8008e1d450||Unknown                       ", 
        "          0x29||0xff800945bd10||0x000000000003||Unknown                       ", 
        "          0x2a||0xff800945bd20||0xff8008e1d4c0||Unknown                       ", 
        "          0x2b||0xff800945bd30||0x000000000004||Unknown                       ", 
        "          0x2c||0xff800945bd40||0xff8008e1d550||Unknown                       ", 
        "          0x2d||0xff800945bd50||0x000000000003||Unknown                       ", 
        "          0x2e||0xff800945bd60||0xff8008e1d5c0||Unknown                       ", 
        "          0x2f||0xff800945bd70||0x000000000003||Unknown                       ", 
        "          0x30||0xff800945bd80||0xff8008e1d630||Unknown                       ", 
        "          0x31||0xff800945bd90||0x000000000005||Unknown                       ", 
        "          0x32||0xff800945bda0||0xff8008e1d6d0||Unknown                       ", 
        "          0x33||0xff800945bdb0||0x000000000005||Unknown                       ", 
        "          0x34||0xff800945bdc0||0xff8008e28c10||Unknown                       ", 
        "          0x35||0xff800945bdd0||-             ||Unknown                       ", 
        "          0x36||0xff800945bde0||0xff8008e28be0||Unknown                       ", 
        "          0x37||0xff800945bdf0||-             ||Unknown                       ", 
        "          0x38||0xff800945be00||0xff8008e28ba0||Unknown                       ", 
        "          0x39||0xff800945be10||-             ||Unknown                       ", 
        "          0x3a||0xff800945be20||0xff8008e25ef0||Unknown                       ", 
        "          0x3b||0xff800945be30||-             ||Unknown                       ", 
        "          0x3c||0xff800945be40||0xff8008e3c7b0||Unknown                       ", 
        "          0x3d||0xff800945be50||-             ||Unknown                       ", 
        "          0x3e||0xff800945be60||0xff8008e1e140||Unknown                       ", 
        "          0x3f||0xff800945be70||0x000000000007||Unknown                       ", 
        "          0x40||0xff800945be80||0xff8008e1df50||Unknown                       ", 
        "          0x41||0xff800945be90||0x000000000008||Unknown                       ", 
        "          0x42||0xff800945bea0||0xff8008e3b420||Unknown                       ", 
        "          0x43||0xff800945beb0||0x000000000001||Unknown                       ", 
        "          0x44||0xff800945bec0||0xff8008e3b4d0||Unknown                       ", 
        "          0x45||0xff800945bed0||0x000000000001||Unknown                       ", 
        "          0x46||0xff800945bee0||0xff8008e3b380||Unknown                       ", 
        "          0x47||0xff800945bef0||0x000000000002||Unknown                       ", 
        "          0x48||0xff800945bf00||0xff8008e3b900||Unknown                       ", 
        "          0x49||0xff800945bf10||0x000000000001||Unknown                       ", 
        "          0x4a||0xff800945bf20||0xff8008e3bb10||Unknown                       ", 
        "          0x4b||0xff800945bf30||0x000000000002||Unknown                       ", 
        "          0x4c||0xff800945bf40||0xff8008e3ba30||Unknown                       ", 
        "          0x4d||0xff800945bf50||0x000000000003||Unknown                       ", 
        "          0x4e||0xff800945bf60||0xff8008e3bc30||Unknown                       ", 
        "          0x4f||0xff800945bf70||0x000000000004||Unknown                       ", 
        "          0x50||0xff800945bf80||0xff8008e3c7b0||Unknown                       ", 
        "          0x51||0xff800945bf90||-             ||Unknown                       ", 
        "          0x52||0xff800945bfa0||0xff8008e1d740||Unknown                       ", 
        "          0x53||0xff800945bfb0||0x000000000005||Unknown                       ", 
        "          0x54||0xff800945bfc0||0xff8008e1d7b0||Unknown                       ", 
        "          0x55||0xff800945bfd0||0x000000000004||Unknown                       ", 
        "          0x56||0xff800945bfe0||0xff80091d5880||Unknown                       ", 
        "          0x57||0xff800945bff0||0x000000000005||Unknown                       ", 
        "          0x58||0xff800945c000||0xff800923b850||Unknown                       ", 
        "          0x59||0xff800945c010||0x000000000003||Unknown                       ", 
        "          0x5a||0xff800945c020||0xff800923b450||Unknown                       ", 
        "          0x5b||0xff800945c030||0x000000000003||Unknown                       ", 
        "          0x5c||0xff800945c040||0xff800923b320||Unknown                       ", 
        "          0x5d||0xff800945c050||0x000000000002||Unknown                       ", 
        "          0x5e||0xff800945c060||0xff8008e3c7b0||Unknown                       ", 
        "          0x5f||0xff800945c070||-             ||Unknown                       ", 
        "          0x60||0xff800945c080||0xff800923cc10||Unknown                       ", 
        "          0x61||0xff800945c090||0x000000000005||Unknown                       ", 
        "          0x62||0xff800945c0a0||0xff800923d060||Unknown                       ", 
        "          0x63||0xff800945c0b0||0x000000000003||Unknown                       ", 
        "          0x64||0xff800945c0c0||0xff8008e3c7b0||Unknown                       ", 
        "          0x65||0xff800945c0d0||-             ||Unknown                       ", 
        "          0x66||0xff800945c0e0||0xff800923cbd0||Unknown                       ", 
        "          0x67||0xff800945c0f0||0x000000000004||Unknown                       ", 
        "          0x68||0xff800945c100||0xff800923cae0||Unknown                       ", 
        "          0x69||0xff800945c110||0x000000000001||Unknown                       ", 
        "          0x6a||0xff800945c120||0xff800923ca70||Unknown                       ", 
        "          0x6b||0xff800945c130||0x000000000001||Unknown                       ", 
        "          0x6c||0xff800945c140||0xff8008e3c7b0||Unknown                       ", 
        "          0x6d||0xff800945c150||-             ||Unknown                       ", 
        "          0x6e||0xff800945c160||0xff8008e3c7b0||Unknown                       ", 
        "          0x6f||0xff800945c170||-             ||Unknown                       ", 
        "          0x70||0xff800945c180||0xff8008e3c7b0||Unknown                       ", 
        "          0x71||0xff800945c190||-             ||Unknown                       ", 
        "          0x72||0xff800945c1a0||0xff8008e3c7b0||Unknown                       ", 
        "          0x73||0xff800945c1b0||-             ||Unknown                       ", 
        "          0x74||0xff800945c1c0||0xff8008e3bd70||Unknown                       ", 
        "          0x75||0xff800945c1d0||-             ||Unknown                       ", 
        "          0x76||0xff800945c1e0||0xff8008e3be60||Unknown                       ", 
        "          0x77||0xff800945c1f0||-             ||Unknown                       ", 
        "          0x78||0xff800945c200||0xff8008e3bd80||Unknown                       ", 
        "          0x79||0xff800945c210||-             ||Unknown                       ", 
        "          0x7a||0xff800945c220||0xff8008e3c0b0||Unknown                       ", 
        "          0x7b||0xff800945c230||0x000000000003||Unknown                       ", 
        "          0x7c||0xff800945c240||0xff8008e22c00||Unknown                       ", 
        "          0x7d||0xff800945c250||0x000000000005||Unknown                       ", 
        "          0x7e||0xff800945c260||0xff8008e3c7b0||Unknown                       ", 
        "          0x7f||0xff800945c270||-             ||Unknown                       "
    ], 
    "options": {
        "--name_resolution_strategies": "Module,Symbol", 
        "executable": "rekall ", 
        "--filename": "/Users/adamsh/Projects/rekall-test/osx10.9.5/vmem.e01", 
        "commandline": "check_trap_table", 
        "--renderer": "test", 
        "test_class": "TestCheckTrapTable", 
        "tempdir": "/var/folders/yc/4zng19655k37kyxgskb3vvf0006t70/T/tmpB0dT24/TestCheckTrapTableThread-5", 
        "executed_command": "rekall  --renderer 'test' --filename '/Users/adamsh/Projects/rekall-test/osx10.9.5/vmem.e01' --name_resolution_strategies 'Module,Symbol' - check_trap_table", 
        "testdir": "/Users/adamsh/Projects/rekall-test/osx10.9.5"
    }
}