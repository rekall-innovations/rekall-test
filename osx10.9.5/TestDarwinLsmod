#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestDarwinLsmod /Users/adamsh/Projects/rekall-test/osx10.9.5/TestDarwinLsmod
elif [ "$1" == "meld" ]; then
   meld /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestDarwinLsmod /Users/adamsh/Projects/rekall-test/osx10.9.5/TestDarwinLsmod
elif [ "$1" == "diff" ]; then
   diff /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestDarwinLsmod /Users/adamsh/Projects/rekall-test/osx10.9.5/TestDarwinLsmod
elif [ "$1" == "run" ]; then
   rekall  --renderer 'test' --filename '/Users/adamsh/Projects/rekall-test/osx10.9.5/vmem.e01' --name_resolution_strategies 'Module,Symbol' - lsmod
else
   less /Users/adamsh/Projects/rekall-test/osx10.9.5/output/TestDarwinLsmod
fi
exit 0
{
    "errors": {}, 
    "time_used": 8.4197678565979, 
    "return_code": 0, 
    "failures": {
        "testCase (__main__.TestDarwinLsmod)": "Traceback (most recent call last):\n  File \"/Users/adamsh/Projects/rekall/rekall/testlib.py\", line 221, in run\n    testMethod()\n  File \"/Users/adamsh/Projects/rekall/rekall/testlib.py\", line 271, in testCase\n    self.assertEqual(previous, current)\nAssertionError: u'0xff800e800000||0x000001d5f000||      -1||      13.4.0||__kernel__' != u'0xff8008e00000||0x000001d5f000||      -1||      13.4.0||__kernel__'\n- 0xff800e800000||0x000001d5f000||      -1||      13.4.0||__kernel__\n?         -\n+ 0xff8008e00000||0x000001d5f000||      -1||      13.4.0||__kernel__\n?        +\n\n"
    }, 
    "output": [
        "   Address    ||     Size     ||  Refs  ||  Version   ||Name", 
        "--------------||--------------||--------||------------||----", 
        "0xff8008e00000||0x000001d5f000||      -1||      13.4.0||__kernel__", 
        "0xff7f8a01d000||0x000000008000||       0||        1.60||com.apple.driver.AudioAUUC", 
        "0xff7f8a402000||0x000000009000||       0||     1.9.5d0||com.apple.driver.AppleHWSensor", 
        "0xff7f8a678000||0x000000019000||       0||   100.14.34||com.apple.driver.AGPM", 
        "0xff7f8a672000||0x000000006000||       1||      3.6.22||com.apple.AppleGraphicsDeviceControl", 
        "0xff7f89fc9000||0x00000000b000||       0||         3.0||com.apple.filesystems.autofs", 
        "0xff7f89fc4000||0x000000005000||       1||         1.0||com.apple.kext.triggers", 
        "0xff7f8a596000||0x0000000bf000||       0||     2.6.3f4||com.apple.driver.AppleHDA", 
        "0xff7f8a4c0000||0x0000000cd000||       1||     2.6.3f4||com.apple.driver.DspFuncLib", 
        "0xff7f8a491000||0x00000002f000||       1||       1.0.0||com.apple.vecLib.kext", 
        "0xff7f89fe6000||0x00000002f000||       3||    1.9.7fc2||com.apple.iokit.IOAudioFamily", 
        "0xff7f89fd4000||0x000000012000||       2||        1.14||com.apple.kext.OSvKernDSPLib", 
        "0xff7f89899000||0x00000000b000||       0||     1.0.0d1||com.apple.iokit.IOUserEthernet", 
        "0xff7f89bb3000||0x000000013000||       0||        91.1||com.apple.iokit.IOSurface", 
        "0xff7f89d91000||0x00000000e000||       0||     4.2.7f3||com.apple.iokit.IOBluetoothSerialManager", 
        "0xff7f89d80000||0x00000000e000||       1||      10.0.7||com.apple.iokit.IOSerialFamily", 
        "0xff7f89da5000||0x00000009d000||       0||     4.2.7f3||com.apple.iokit.IOBluetoothFamily", 
        "0xff7f89ed1000||0x000000006000||       0||       7.0.0||com.apple.Dont_Steal_Mac_OS_X", 
        "0xff7f8a40b000||0x000000005000||       0||           1||com.apple.driver.AppleHWAccess", 
        "0xff7f8a477000||0x00000001a000||       1||     2.6.3f4||com.apple.driver.AppleHDAController", 
        "0xff7f8a464000||0x00000000c000||       2||     2.6.3f4||com.apple.iokit.IOHDAFamily", 
        "0xff7f89c72000||0x000000015000||       0||       1.0.0||com.apple.driver.ACPI_SMC_PlatformPlugin", 
        "0xff7f89c5d000||0x000000013000||       2||       3.1.8||com.apple.driver.AppleSMC", 
        "0xff7f89c49000||0x000000012000||       1||       1.0.0||com.apple.driver.IOPlatformPluginLegacy", 
        "0xff7f8a381000||0x000000005000||       0||       1.7.0||com.apple.driver.AppleLPC", 
        "0xff7f89c3f000||0x00000000a000||       4||     5.7.1d6||com.apple.driver.IOPlatformPluginFamily", 
        "0xff7f8a19b000||0x000000009000||       0||      3.5.13||com.apple.driver.AppleUpstreamUserClient", 
        "0xff7f8a347000||0x000000014000||       0||       1.2.5||com.apple.driver.AppleMCCSControl", 
        "0xff7f8a336000||0x00000000e000||       1||    1.0.12d1||com.apple.driver.AppleSMBusController", 
        "0xff7f89bc8000||0x000000004000||       1||         1.1||com.apple.iokit.IOSMBusFamily", 
        "0xff7f89ce4000||0x000000010000||       2||       2.4.1||com.apple.iokit.IONDRVSupport", 
        "0xff7f89ca1000||0x000000038000||       7||       2.4.1||com.apple.iokit.IOGraphicsFamily", 
        "0xff7f89a01000||0x000000009000||       0||     660.4.0||com.apple.iokit.IOUSBHIDDriver", 
        "0xff7f89a0a000||0x000000007000||       0||     656.4.1||com.apple.driver.AppleUSBComposite", 
        "0xff7f89c07000||0x00000001a000||       0||       3.6.7||com.apple.iokit.IOSCSIMultimediaCommandsDevice", 
        "0xff7f89bfb000||0x000000009000||       1||         1.7||com.apple.iokit.IOBDStorageFamily", 
        "0xff7f89bed000||0x00000000b000||       2||       1.7.1||com.apple.iokit.IODVDStorageFamily", 
        "0xff7f89bdc000||0x00000000e000||       3||       1.7.1||com.apple.iokit.IOCDStorageFamily", 
        "0xff7f8a146000||0x000000005000||       0||         404||com.apple.driver.XsanFilter", 
        "0xff7f89e9f000||0x00000000d000||       0||       2.6.1||com.apple.iokit.IOAHCISerialATAPI", 
        "0xff7f8947d000||0x00000002b000||       2||       3.6.7||com.apple.iokit.IOSCSIArchitectureModelFamily", 
        "0xff7f89a6f000||0x00000001f000||       0||     683.4.0||com.apple.driver.AppleUSBHub", 
        "0xff7f89927000||0x000000003000||       0||     660.4.2||com.apple.iokit.IOUSBUserClient", 
        "0xff7f89eac000||0x000000021000||       0||       2.6.0||com.apple.iokit.IOAHCIBlockStorage", 
        "0xff7f8a6a0000||0x000000005000||       0||     1.0.0d1||com.apple.AppleFSCompression.AppleFSCompressionTypeDataless", 
        "0xff7f8a699000||0x000000007000||       0||     1.0.0d1||com.apple.AppleFSCompression.AppleFSCompressionTypeLZVN", 
        "0xff7f8a693000||0x000000006000||       0||     1.0.0d1||com.apple.AppleFSCompression.AppleFSCompressionTypeZlib", 
        "0xff7f89fb9000||0x00000000b000||       0||          35||com.apple.BootCache", 
        "0xff7f8a6ae000||0x00000000a000||       0||         2.0||com.apple.driver.AppleEFINVRAM", 
        "0xff7f89a55000||0x000000013000||       0||     656.4.1||com.apple.driver.AppleUSBOHCI", 
        "0xff7f898a6000||0x000000061000||       6||     686.4.1||com.apple.iokit.IOUSBFamily", 
        "0xff7f8a6d3000||0x000000021000||       0||       3.0.5||com.apple.driver.AppleAHCIPort", 
        "0xff7f89e86000||0x000000016000||       3||       2.6.5||com.apple.iokit.IOAHCIFamily", 
        "0xff7f89c89000||0x000000018000||       0||     3.1.4b1||com.apple.driver.AppleIntel8254XEthernet", 
        "0xff7f89865000||0x00000002d000||       2||         3.2||com.apple.iokit.IONetworkingFamily", 
        "0xff7f8a6a9000||0x000000005000||       1||         2.0||com.apple.driver.AppleEFIRuntime", 
        "0xff7f8a763000||0x000000007000||       0||         2.0||com.apple.driver.AppleACPIButtons", 
        "0xff7f8997c000||0x000000072000||       2||       2.0.0||com.apple.iokit.IOHIDFamily", 
        "0xff7f8a42f000||0x000000005000||       0||         1.8||com.apple.driver.AppleHPET", 
        "0xff7f8a2d9000||0x00000000a000||       0||         2.0||com.apple.driver.AppleRTC", 
        "0xff7f8a2ad000||0x000000006000||       0||         2.1||com.apple.driver.AppleSMBIOS", 
        "0xff7f8a6ce000||0x000000005000||       0||         1.7||com.apple.driver.AppleAPIC", 
        "0xff7f8a76a000||0x00000000a000||       0||         153||com.apple.nke.applicationfirewall", 
        "0xff7f89745000||0x000000008000||       0||           3||com.apple.security.quarantine", 
        "0xff7f89731000||0x000000014000||       1||    278.11.1||com.apple.security.sandbox", 
        "0xff7f8972c000||0x000000005000||       2||     1.0.0d1||com.apple.kext.AppleMatch", 
        "0xff7f89729000||0x000000003000||       0||           7||com.apple.security.TMSafetyNet", 
        "0xff7f8a389000||0x000000014000||       0||           2||com.apple.driver.AppleKeyStore", 
        "0xff7f89cf4000||0x000000019000||       0||       371.1||com.apple.driver.DiskImages", 
        "0xff7f893ed000||0x000000025000||       7||         1.9||com.apple.iokit.IOStorageFamily", 
        "0xff7f89c25000||0x00000000f000||       1||          23||com.apple.iokit.IOReportFamily", 
        "0xff7f89971000||0x00000000b000||       1||       28.30||com.apple.driver.AppleFDEKeyStore", 
        "0xff7f8a6fa000||0x000000059000||       1||         2.0||com.apple.driver.AppleACPIPlatform", 
        "0xff7f894bf000||0x00000002b000||      15||         2.9||com.apple.iokit.IOPCIFamily", 
        "0xff7f89c36000||0x000000009000||      12||         1.4||com.apple.iokit.IOACPIFamily", 
        "0xff7f8992a000||0x000000047000||       2||         1.0||com.apple.kec.corecrypto", 
        "0xff7f8974d000||0x00000000b000||       0||           1||com.apple.kec.pthread", 
        "0x000000000000||0x000000000000||      43||      13.4.0||com.apple.kpi.unsupported", 
        "0x000000000000||0x000000000000||      35||      13.4.0||com.apple.kpi.private", 
        "0x000000000000||0x000000000000||      67||      13.4.0||com.apple.kpi.mach", 
        "0x000000000000||0x000000000000||      76||      13.4.0||com.apple.kpi.libkern", 
        "0x000000000000||0x000000000000||      71||      13.4.0||com.apple.kpi.iokit", 
        "0x000000000000||0x000000000000||       7||      13.4.0||com.apple.kpi.dsep", 
        "0x000000000000||0x000000000000||      56||      13.4.0||com.apple.kpi.bsd"
    ], 
    "options": {
        "--name_resolution_strategies": "Module,Symbol", 
        "executable": "rekall ", 
        "--filename": "/Users/adamsh/Projects/rekall-test/osx10.9.5/vmem.e01", 
        "commandline": "lsmod", 
        "--renderer": "test", 
        "test_class": "TestDarwinLsmod", 
        "tempdir": "/var/folders/yc/4zng19655k37kyxgskb3vvf0006t70/T/tmpB0dT24/TestDarwinLsmodThread-3", 
        "executed_command": "rekall  --renderer 'test' --filename '/Users/adamsh/Projects/rekall-test/osx10.9.5/vmem.e01' --name_resolution_strategies 'Module,Symbol' - lsmod", 
        "testdir": "/Users/adamsh/Projects/rekall-test/osx10.9.5"
    }
}