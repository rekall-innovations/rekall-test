#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /Users/scudette/projects/rekall-test/linux-3.2.0-PAE/output/TestLinVadDump /Users/scudette/projects/rekall-test/linux-3.2.0-PAE/TestLinVadDump
elif [ "$1" == "meld" ]; then
   meld /Users/scudette/projects/rekall-test/linux-3.2.0-PAE/output/TestLinVadDump /Users/scudette/projects/rekall-test/linux-3.2.0-PAE/TestLinVadDump
elif [ "$1" == "diff" ]; then
   diff /Users/scudette/projects/rekall-test/linux-3.2.0-PAE/output/TestLinVadDump /Users/scudette/projects/rekall-test/linux-3.2.0-PAE/TestLinVadDump
elif [ "$1" == "run" ]; then
   rekall  -v --cache_dir '/Users/scudette/projects/rekall-test/linux-3.2.0-PAE/../profile_cache/' --format 'test' --filename '/Users/scudette/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01' - vaddump --proc_regex bash --dump_dir /var/folders/y8/670pn1dx55x01z5fs_6r2gnh003jp1/T/tmp6EjvdN/TestLinVadDumpThread-8
else
   less /Users/scudette/projects/rekall-test/linux-3.2.0-PAE/output/TestLinVadDump
fi
exit 0
{
    "errors": {}, 
    "logging": [
        "DEBUG:rekall.1:Logging level set to 10", 
        "DEBUG:rekall.1:Voting round with base: None", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: No base address space provided", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ", 
        "DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Must stack on another address space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMemAddressSpace: No base address space provided", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating EWFAddressSpace: No base address space provided", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Must stack on another address space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Must stack on another address space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: No base address space provided", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: No base address space provided", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ", 
        "DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Must stack on another address space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Must be layered on another address space.", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Unable to open AFF4 volume", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pmem.MacPmemAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating MacPmemAddressSpace: MacPmem would declare a YML device at /Users/scudette/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01_info", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ", 
        "DEBUG:rekall.1:Succeeded instantiating FileAddressSpace", 
        "DEBUG:rekall.1:Voting round with base: FileAddressSpace", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0x9465645", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ", 
        "DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ", 
        "DEBUG:rekall.1:Succeeded instantiating EWFAddressSpace", 
        "DEBUG:rekall.1:Voting round with base: EWFAddressSpace", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0x0", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ", 
        "DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating EWFAddressSpace: EWF signature not present", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ", 
        "DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ", 
        "DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Header signature invalid", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Invalid Lime header signature", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Must stack on another address space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pmem.MacPmemAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating MacPmemAddressSpace: Must be mapped directly over a raw device.", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating FileAddressSpace: Must be first Address Space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.mmap_address_space.MmapFileAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating MmapFileAddressSpace: Must be first Address Space", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.amd64.VTxPagedMemory'> ", 
        "DEBUG:rekall.1:Failed instantiating VTxPagedMemory: No more EPTs specified", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.GlobalOffsetAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating GlobalOffsetAddressSpace: File offset not specified.", 
        "DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pagefile.PagefilePhysicalAddressSpace'> ", 
        "DEBUG:rekall.1:Failed instantiating PagefilePhysicalAddressSpace: Pagefile not specified", 
        "INFO:rekall.1:Autodetected physical address space EWFAddressSpace", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/sessions/v1.0/sessions/index.gz", 
        "DEBUG:rekall.1:Decoded in 0.0227360725403 sec.", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/sessions/v1.0/sessions/30efaa5505e006094da27a98ebf9f6126e98d23a/profile.gz", 
        "DEBUG:rekall.1:Decoded in 0.000112771987915 sec.", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/sessions/v1.0/sessions/30efaa5505e006094da27a98ebf9f6126e98d23a/image_fingerprint.gz", 
        "DEBUG:rekall.1:Decoded in 0.00906419754028 sec.", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/sessions/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Decoded in 0.000274181365967 sec.", 
        "INFO:rekall.1:Detected fingerprinted image 30efaa5505e006094da27a98ebf9f6126e98d23a", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/sessions/v1.0/sessions/30efaa5505e006094da27a98ebf9f6126e98d23a/profile.gz", 
        "DEBUG:rekall.1:Decoded in 9.79900360107e-05 sec.", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-profiles/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Opened url https://raw.githubusercontent.com/google/rekall-profiles/master/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Opened url http://profiles.rekall-forensic.com/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/inventory.gz", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/v1.0/Debian/3.2.0-4-686-pae.gz", 
        "INFO:rekall.1:Loaded profile Debian/3.2.0-4-686-pae from Local Cache Directory:/Users/scudette/projects/rekall-test/profile_cache (in 0.863549947739 sec)", 
        "DEBUG:rekall.1:Running plugin (vaddump) with args (()) kwargs ({'profile': None, 'proc_regex': 'bash', 'task': None, 'pid': None, 'task_head': None, 'phys_task': None, 'dump_dir': '/var/folders/y8/670pn1dx55x01z5fs_6r2gnh003jp1/T/tmp6EjvdN/TestLinVadDumpThread-8', 'method': ['InitTask']})", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/sessions/v1.0/sessions/30efaa5505e006094da27a98ebf9f6126e98d23a/dtb.gz", 
        "DEBUG:rekall.1:Decoded in 0.00011682510376 sec.", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/sessions/v1.0/sessions/30efaa5505e006094da27a98ebf9f6126e98d23a/default_address_space.gz", 
        "DEBUG:rekall.1:Decoded in 0.00906801223755 sec.", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/sessions/v1.0/sessions/30efaa5505e006094da27a98ebf9f6126e98d23a/pslist_cache.gz", 
        "DEBUG:rekall.1:Decoded in 0.000247001647949 sec.", 
        "DEBUG:rekall.1:Listed 62 processes using InitTask", 
        "DEBUG:rekall.1:Opened local file /Users/scudette/projects/rekall-test/profile_cache/sessions/v1.0/sessions/30efaa5505e006094da27a98ebf9f6126e98d23a/image_fingerprint.gz", 
        "DEBUG:rekall.1:Decoded in 0.000243902206421 sec.", 
        "DEBUG:rekall.1:Flushed profile_obj in 0.00111317634583"
    ], 
    "time_used": 3.3264172077178955, 
    "return_code": 0, 
    "failures": {
        "testCase (rekall.plugins.linux.proc_maps.TestLinVadDump)": "Traceback (most recent call last):\n  File \"/Users/scudette/projects/rekall/rekall-core/rekall/testlib.py\", line 234, in run\n    testMethod()\n  File \"/Users/scudette/projects/rekall/rekall-core/rekall/testlib.py\", line 331, in testCase\n    self.assertEqual(self.baseline['hashes'], self.current['hashes'])\nAssertionError: {u'bash.2362.08048000-08129000.dmp': u'e4e170c9ff2eb142f3c061dd849a9ac3', u'bash [truncated]... != {'bash.2362.08048000-08129000.dmp': 'e4e170c9ff2eb142f3c061dd849a9ac3', 'bash.23 [truncated]...\nDiff is 4962 characters long. Set self.maxDiff to None to see it.\n"
    }, 
    "output": [
        "Pid: 2362  ", 
        "Writing bash, pid 2362 to bash.2362.08048000-08129000.dmp", 
        "Writing bash, pid 2362 to bash.2362.08129000-0812a000.dmp", 
        "Writing bash, pid 2362 to bash.2362.0812a000-0812f000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b73da000-b73e1000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b73e1000-b73eb000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b73eb000-b73ec000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b73ec000-b73ed000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b73ed000-b73f6000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b73f6000-b73f7000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b73f7000-b73f8000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b73f8000-b740b000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b740b000-b740c000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b740c000-b740d000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b740f000-b7415000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b7415000-b7416000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b7416000-b7417000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b7417000-b758e000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b758f000-b76eb000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b76eb000-b76ec000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b76ec000-b76ee000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b76ee000-b76ef000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b76f3000-b76f5000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b76f5000-b76f6000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b76f6000-b76f7000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b76f7000-b7714000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b7714000-b7716000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b7716000-b7717000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b771f000-b773b000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b773b000-b773c000.dmp", 
        "Writing bash, pid 2362 to bash.2362.b773c000-b773d000.dmp"
    ], 
    "hashes": {
        "bash.2362.08048000-08129000.dmp": "e4e170c9ff2eb142f3c061dd849a9ac3", 
        "bash.2362.b73ed000-b73f6000.dmp": "bb7df04e1b0a2570657527a7e108ae23", 
        "bash.2362.b76f5000-b76f6000.dmp": "a6b3c2e0823f5d3befbebd4f0f558f6a", 
        "bash.2362.b758f000-b76eb000.dmp": "9af02dc3467255fb57620fd809142407", 
        "bash.2362.b73eb000-b73ec000.dmp": "8b0be3cb9a21bbd6e749f496cff7467e", 
        "bash.2362.b73f8000-b740b000.dmp": "fcd6bcb56c1689fcef28b57c22475bad", 
        "bash.2362.b73f6000-b73f7000.dmp": "4b2942255da51698c470fc6caad231be", 
        "bash.2362.0812a000-0812f000.dmp": "e435e8f870caca7ac8d91c5bc8629a6b", 
        "bash.2362.b7417000-b758e000.dmp": "6030004d9defac4e6fc9a67c2235a85d", 
        "bash.2362.b773c000-b773d000.dmp": "bfeafdd5e4cb9ec557f361977646c139", 
        "bash.2362.b76ee000-b76ef000.dmp": "7738f9b56de1a3559cb6ecf467a05200", 
        "bash.2362.b740f000-b7415000.dmp": "2e5cc3b5fa4a222f2c1eb884ccfe8f1e", 
        "bash.2362.b76f6000-b76f7000.dmp": "95c725dd0d449d38d8dfed97699885ed", 
        "bash.2362.b73da000-b73e1000.dmp": "ce092df358ddf5093028829bc1e008da", 
        "bash.2362.b76f7000-b7714000.dmp": "4e79968f8c5b68d242b46249399bdbcd", 
        "bash.2362.b76f3000-b76f5000.dmp": "6b67c01b0b6dc3e07b630c575a41580d", 
        "bash.2362.b73f7000-b73f8000.dmp": "e2fe1c33765238d85faafe0aaed2aa2b", 
        "bash.2362.b76eb000-b76ec000.dmp": "d41d8cd98f00b204e9800998ecf8427e", 
        "bash.2362.b740c000-b740d000.dmp": "be8247fb19230ca53b4cf5cd7433e03d", 
        "bash.2362.b7416000-b7417000.dmp": "f6950c54bc17815e28bde23f940df2a6", 
        "bash.2362.b7714000-b7716000.dmp": "22ccec5dc1df0fac412df7861a6ed3d6", 
        "bash.2362.b771f000-b773b000.dmp": "b5567bc83318d9761aa120c48082674b", 
        "bash.2362.b7415000-b7416000.dmp": "6be8779aa9969be07bf3640320b9300f", 
        "bash.2362.08129000-0812a000.dmp": "87077d71ceb358a10bdbfac92dd3c397", 
        "bash.2362.b76ec000-b76ee000.dmp": "347fd900b4f42da4fb21274820f1c9e5", 
        "bash.2362.b73ec000-b73ed000.dmp": "e06abd0640ea0cc43289f6de7a638488", 
        "bash.2362.b7716000-b7717000.dmp": "eceab13a0e19429ff28287fb225c0d41", 
        "bash.2362.b740b000-b740c000.dmp": "516227bab80f6b2184fe7fa7b63dc3bd", 
        "bash.2362.b773b000-b773c000.dmp": "8c3e156852af86f57623b1dfc4d57e8c", 
        "bash.2362.b73e1000-b73eb000.dmp": "18747fcb2508eeec79415b32f63f3654"
    }, 
    "options": {
        "executable": "rekall ", 
        "--filename": "/Users/scudette/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01", 
        "--format": "test", 
        "commandline": "vaddump --proc_regex %(proc_name)s --dump_dir %(tempdir)s", 
        "proc_name": "bash", 
        "pid": 2362, 
        "test_class": "TestLinVadDump", 
        "--cache_dir": "/Users/scudette/projects/rekall-test/linux-3.2.0-PAE/../profile_cache/", 
        "tempdir": "/var/folders/y8/670pn1dx55x01z5fs_6r2gnh003jp1/T/tmp6EjvdN/TestLinVadDumpThread-8", 
        "executed_command": "rekall  -v --cache_dir '/Users/scudette/projects/rekall-test/linux-3.2.0-PAE/../profile_cache/' --format 'test' --filename '/Users/scudette/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01' - vaddump --proc_regex bash --dump_dir /var/folders/y8/670pn1dx55x01z5fs_6r2gnh003jp1/T/tmp6EjvdN/TestLinVadDumpThread-8", 
        "testdir": "/Users/scudette/projects/rekall-test/linux-3.2.0-PAE"
    }
}