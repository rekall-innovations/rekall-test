#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /home/scudette/projects/rekall-test/linux-3.2.0-PAE/output/TestLinuxPsxView /home/scudette/projects/rekall-test/linux-3.2.0-PAE/TestLinuxPsxView
elif [ "$1" == "meld" ]; then
   meld /home/scudette/projects/rekall-test/linux-3.2.0-PAE/output/TestLinuxPsxView /home/scudette/projects/rekall-test/linux-3.2.0-PAE/TestLinuxPsxView
elif [ "$1" == "diff" ]; then
   diff /home/scudette/projects/rekall-test/linux-3.2.0-PAE/output/TestLinuxPsxView /home/scudette/projects/rekall-test/linux-3.2.0-PAE/TestLinuxPsxView
elif [ "$1" == "run" ]; then
   rekall  -v --cache 'memory' --cache_dir '/home/scudette/projects/rekall-test/linux-3.2.0-PAE/../profile_cache/' --format 'test' --filename '/home/scudette/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01' - psxview
else
   less /home/scudette/projects/rekall-test/linux-3.2.0-PAE/output/TestLinuxPsxView
fi
exit 0
{
    "failours": {
        "testCase (__main__.TestLinuxPsxView)": {
            "testCase (__main__.TestLinuxPsxView)": "Traceback (most recent call last):\n  File \"/home/scudette/rekall/rekall-core/rekall/testlib.py\", line 252, in run\n    testMethod()\n  File \"/home/scudette/rekall/rekall-core/rekall/testlib.py\", line 302, in testCase\n    self.assertListEqual(previous, current)\n  File \"/home/scudette/rekall/rekall-core/rekall/testlib.py\", line 227, in assertListEqual\n    self.assertEqual(x, y)\nAssertionError: u'0xf5498080||getty               ||        2360||True    ||False       ' != u'0xf5498080||getty               ||        2360||True    ||True        '\n- 0xf5498080||getty               ||        2360||True    ||False       \n?                                                           ^^^^\n+ 0xf5498080||getty               ||        2360||True    ||True        \n?                                                           ^^^        +\n\n"
        }
    }, 
    "errors": {
        "testCase (__main__.TestLinuxPsxView)": {}
    }, 
    "logging": [
        "2016-05-17 09:49:28,648:DEBUG:rekall.1:Logging level set to 10", 
        "2016-05-17 09:49:28,649:DEBUG:rekall.1:Voting round with base: None", 
        "2016-05-17 09:49:28,650:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ", 
        "2016-05-17 09:49:28,650:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: No base address space provided", 
        "2016-05-17 09:49:28,650:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ", 
        "2016-05-17 09:49:28,650:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Must stack on another address space", 
        "2016-05-17 09:49:28,650:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ", 
        "2016-05-17 09:49:28,650:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: No base address space provided", 
        "2016-05-17 09:49:28,651:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ", 
        "2016-05-17 09:49:28,651:DEBUG:rekall.1:Failed instantiating EWFAddressSpace: No base address space provided", 
        "2016-05-17 09:49:28,651:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ", 
        "2016-05-17 09:49:28,652:DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Must stack on another address space", 
        "2016-05-17 09:49:28,652:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ", 
        "2016-05-17 09:49:28,652:DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Must stack on another address space", 
        "2016-05-17 09:49:28,652:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ", 
        "2016-05-17 09:49:28,652:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: No base address space provided", 
        "2016-05-17 09:49:28,652:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ", 
        "2016-05-17 09:49:28,652:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: No base address space provided", 
        "2016-05-17 09:49:28,653:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ", 
        "2016-05-17 09:49:28,653:DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Must stack on another address space", 
        "2016-05-17 09:49:28,653:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ", 
        "2016-05-17 09:49:28,653:DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Must be layered on another address space.", 
        "2016-05-17 09:49:28,653:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ", 
        "2016-05-17 09:49:28,655:DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Unable to open AFF4 volume", 
        "2016-05-17 09:49:28,655:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pmem.MacPmemAddressSpace'> ", 
        "2016-05-17 09:49:28,656:DEBUG:rekall.1:Failed instantiating MacPmemAddressSpace: MacPmem would declare a YML device at /home/scudette/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01_info", 
        "2016-05-17 09:49:28,656:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ", 
        "2016-05-17 09:49:28,656:DEBUG:rekall.1:Succeeded instantiating FileAddressSpace", 
        "2016-05-17 09:49:28,656:DEBUG:rekall.1:Voting round with base: FileAddressSpace", 
        "2016-05-17 09:49:28,656:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ", 
        "2016-05-17 09:49:28,658:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0x9465645", 
        "2016-05-17 09:49:28,658:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ", 
        "2016-05-17 09:49:28,662:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid", 
        "2016-05-17 09:49:28,662:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ", 
        "2016-05-17 09:49:28,662:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.", 
        "2016-05-17 09:49:28,662:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ", 
        "2016-05-17 09:49:28,672:DEBUG:rekall.1:Succeeded instantiating EWFAddressSpace", 
        "2016-05-17 09:49:28,672:DEBUG:rekall.1:Voting round with base: EWFAddressSpace", 
        "2016-05-17 09:49:28,672:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ", 
        "2016-05-17 09:49:28,675:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0x0", 
        "2016-05-17 09:49:28,675:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ", 
        "2016-05-17 09:49:28,675:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid", 
        "2016-05-17 09:49:28,675:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ", 
        "2016-05-17 09:49:28,675:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.", 
        "2016-05-17 09:49:28,675:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ", 
        "2016-05-17 09:49:28,676:DEBUG:rekall.1:Failed instantiating EWFAddressSpace: EWF signature not present", 
        "2016-05-17 09:49:28,676:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ", 
        "2016-05-17 09:49:28,676:DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Header signature invalid", 
        "2016-05-17 09:49:28,676:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ", 
        "2016-05-17 09:49:28,676:DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Header signature invalid", 
        "2016-05-17 09:49:28,677:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ", 
        "2016-05-17 09:49:28,677:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: Header signature invalid", 
        "2016-05-17 09:49:28,677:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ", 
        "2016-05-17 09:49:28,677:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: Header signature invalid", 
        "2016-05-17 09:49:28,677:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ", 
        "2016-05-17 09:49:28,677:DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Header signature invalid", 
        "2016-05-17 09:49:28,678:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ", 
        "2016-05-17 09:49:28,678:DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Invalid Lime header signature", 
        "2016-05-17 09:49:28,678:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ", 
        "2016-05-17 09:49:28,678:DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Must stack on another address space", 
        "2016-05-17 09:49:28,678:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pmem.MacPmemAddressSpace'> ", 
        "2016-05-17 09:49:28,679:DEBUG:rekall.1:Failed instantiating MacPmemAddressSpace: Must be mapped directly over a raw device.", 
        "2016-05-17 09:49:28,679:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ", 
        "2016-05-17 09:49:28,679:DEBUG:rekall.1:Failed instantiating FileAddressSpace: Must be first Address Space", 
        "2016-05-17 09:49:28,679:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.mmap_address_space.MmapFileAddressSpace'> ", 
        "2016-05-17 09:49:28,679:DEBUG:rekall.1:Failed instantiating MmapFileAddressSpace: Must be first Address Space", 
        "2016-05-17 09:49:28,679:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.amd64.VTxPagedMemory'> ", 
        "2016-05-17 09:49:28,681:DEBUG:rekall.1:Failed instantiating VTxPagedMemory: No more EPTs specified", 
        "2016-05-17 09:49:28,681:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.GlobalOffsetAddressSpace'> ", 
        "2016-05-17 09:49:28,681:DEBUG:rekall.1:Failed instantiating GlobalOffsetAddressSpace: File offset not specified.", 
        "2016-05-17 09:49:28,681:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pagefile.PagefilePhysicalAddressSpace'> ", 
        "2016-05-17 09:49:28,681:DEBUG:rekall.1:Failed instantiating PagefilePhysicalAddressSpace: Pagefile not specified", 
        "2016-05-17 09:49:28,682:INFO:rekall.1:Autodetected physical address space EWFAddressSpace", 
        "2016-05-17 09:49:28,682:DEBUG:rekall.1:Will detect profile using these Detectors: linux_index,nt_index,osx,pe,windows_kernel_file,rsds,ntfs,linux", 
        "2016-05-17 09:49:28,683:DEBUG:rekall.1:Opened local file /home/scudette/projects/rekall-profiles/v1.0/inventory.gz", 
        "2016-05-17 09:49:28,700:DEBUG:rekall.1:Opened local file /home/scudette/projects/rekall-test/profile_cache/v1.0/inventory.gz", 
        "2016-05-17 09:49:28,701:DEBUG:rekall.1:Opened local file /home/scudette/projects/rekall-test/profile_cache/v1.0/Linux/index.gz", 
        "2016-05-17 09:49:28,727:INFO:rekall.1:Loaded profile Linux/index from Local Cache Directory:/home/scudette/projects/rekall-test/profile_cache (in 0.0255918502808 sec)", 
        "2016-05-17 09:49:28,727:DEBUG:rekall.1:Opened local file /home/scudette/projects/rekall-test/profile_cache/v1.0/nt/eprocess_index.gz", 
        "2016-05-17 09:49:28,796:INFO:rekall.1:Loaded profile nt/eprocess_index from Local Cache Directory:/home/scudette/projects/rekall-test/profile_cache (in 0.0690631866455 sec)", 
        "2016-05-17 09:49:28,797:DEBUG:rekall.1:Opened local file /home/scudette/projects/rekall-test/profile_cache/v1.0/nt/index.gz", 
        "2016-05-17 09:49:28,976:INFO:rekall.1:Loaded profile nt/index from Local Cache Directory:/home/scudette/projects/rekall-test/profile_cache (in 0.179044961929 sec)", 
        "2016-05-17 09:49:28,976:DEBUG:rekall.1:Opened local file /home/scudette/projects/rekall-test/profile_cache/v1.0/OSX/index.gz", 
        "2016-05-17 09:49:28,977:INFO:rekall.1:Loaded profile OSX/index from Local Cache Directory:/home/scudette/projects/rekall-test/profile_cache (in 0.000933170318604 sec)", 
        "2016-05-17 09:49:28,978:DEBUG:rekall.1:Opened local file /home/scudette/projects/rekall-test/profile_cache/v1.0/pe.gz", 
        "2016-05-17 09:49:29,001:INFO:rekall.1:Loaded profile pe from Local Cache Directory:/home/scudette/projects/rekall-test/profile_cache (in 0.0239279270172 sec)", 
        "2016-05-17 09:49:29,002:DEBUG:rekall.1:Trying method pe, offset 0", 
        "2016-05-17 09:49:29,005:DEBUG:rekall.1:Trying method windows_kernel_file, offset 0", 
        "2016-05-17 09:49:29,006:DEBUG:rekall.1:Trying method rsds, offset 0", 
        "2016-05-17 09:49:29,006:DEBUG:rekall.1:Trying method linux_index, offset 0", 
        "2016-05-17 09:49:29,006:DEBUG:rekall.1:LinuxIndexDetector:DetectFromHit(0) = None", 
        "2016-05-17 09:49:29,007:DEBUG:rekall.1:Trying method nt_index, offset 0", 
        "2016-05-17 09:49:29,007:DEBUG:rekall.1:Trying method ntfs, offset 0", 
        "2016-05-17 09:49:29,007:DEBUG:rekall.1:Opened local file /home/scudette/projects/rekall-test/profile_cache/v1.0/ntfs.gz", 
        "2016-05-17 09:49:29,010:INFO:rekall.1:Loaded profile ntfs from Local Cache Directory:/home/scudette/projects/rekall-test/profile_cache (in 0.00251388549805 sec)", 
        "2016-05-17 09:49:29,410:DEBUG:rekall.1:Opened local file /home/scudette/projects/rekall-test/profile_cache/v1.0/Debian/3.2.0-4-686-pae.gz", 
        "2016-05-17 09:49:30,138:INFO:rekall.1:Loaded profile Debian/3.2.0-4-686-pae from Local Cache Directory:/home/scudette/projects/rekall-test/profile_cache (in 0.728739976883 sec)", 
        "2016-05-17 09:49:30,139:INFO:rekall.1:Detected Debian/3.2.0-4-686-pae: Linux version 3.2.0-4-686-pae", 
        "2016-05-17 09:49:30,141:DEBUG:rekall.1:Calculating page offset...", 
        "2016-05-17 09:49:30,141:INFO:rekall.1:Found slide 0x0", 
        "2016-05-17 09:49:30,141:DEBUG:rekall.1:Calculating page offset...", 
        "2016-05-17 09:49:30,144:DEBUG:rekall.1:Detection method linux worked at offset 0x12cb06c", 
        "2016-05-17 09:49:30,148:DEBUG:rekall.1:Running plugin (psxview) with args (()) kwargs ({'profile': None, 'pids': None, 'task': None, 'proc_regex': None, 'method': ['InitTask', 'PidHashTable']})"
    ], 
    "time_used": 4.445467948913574, 
    "return_code": 0, 
    "output": [
        "Offset(V) ||        Name        ||    PID     ||InitTask||PidHashTable", 
        "----------||--------------------||------------||--------||------------", 
        "0xf6057900||init                ||           1||True    ||True        ", 
        "0xf60574e0||kthreadd            ||           2||True    ||True        ", 
        "0xf60570c0||ksoftirqd/0         ||           3||True    ||True        ", 
        "0xf6056ca0||kworker/0:0         ||           4||True    ||True        ", 
        "0xf6056880||kworker/u:0         ||           5||True    ||True        ", 
        "0xf6056460||migration/0         ||           6||True    ||True        ", 
        "0xf6056040||watchdog/0          ||           7||True    ||True        ", 
        "0xf6067920||migration/1         ||           8||True    ||True        ", 
        "0xf6067500||kworker/1:0         ||           9||True    ||True        ", 
        "0xf60670e0||ksoftirqd/1         ||          10||True    ||True        ", 
        "0xf6066cc0||kworker/0:1         ||          11||True    ||True        ", 
        "0xf6066480||watchdog/1          ||          12||True    ||True        ", 
        "0xf6066060||cpuset              ||          13||True    ||True        ", 
        "0xf609b940||khelper             ||          14||True    ||True        ", 
        "0xf609b520||kdevtmpfs           ||          15||True    ||True        ", 
        "0xf609b100||netns               ||          16||True    ||True        ", 
        "0xf609ace0||sync_supers         ||          17||True    ||True        ", 
        "0xf609a8c0||bdi-default         ||          18||True    ||True        ", 
        "0xf609a4a0||kintegrityd         ||          19||True    ||True        ", 
        "0xf609a080||kblockd             ||          20||True    ||True        ", 
        "0xf614d960||kworker/1:1         ||          21||True    ||True        ", 
        "0xf614d540||khungtaskd          ||          22||True    ||True        ", 
        "0xf614d120||kswapd0             ||          23||True    ||True        ", 
        "0xf614cd00||ksmd                ||          24||True    ||True        ", 
        "0xf614c8e0||khugepaged          ||          25||True    ||True        ", 
        "0xf614c4c0||fsnotify_mark       ||          26||True    ||True        ", 
        "0xf614c0a0||crypto              ||          27||True    ||True        ", 
        "0xf70735c0||khubd               ||         105||True    ||True        ", 
        "0xf70380e0||ata_sff             ||         106||True    ||True        ", 
        "0xf7067aa0||scsi_eh_0           ||         111||True    ||True        ", 
        "0xf71ca1c0||scsi_eh_1           ||         112||True    ||True        ", 
        "0xf71ca5e0||kworker/u:1         ||         113||True    ||True        ", 
        "0xf7066a20||kworker/u:2         ||         117||True    ||True        ", 
        "0xf7066e40||kworker/1:2         ||         131||True    ||True        ", 
        "0xf7072960||jbd2/vda1-8         ||         148||True    ||True        ", 
        "0xf7067680||ext4-dio-unwrit     ||         149||True    ||True        ", 
        "0xf7154180||udevd               ||         292||True    ||True        ", 
        "0xf5917700||udevd               ||         381||True    ||True        ", 
        "0xf5805720||udevd               ||         392||True    ||True        ", 
        "0xf71051e0||kpsmoused           ||         397||True    ||True        ", 
        "0xf71549c0||vballoon            ||         423||True    ||True        ", 
        "0xf7154de0||hd-audio0           ||         443||True    ||True        ", 
        "0xf5916680||rpcbind             ||        1574||True    ||True        ", 
        "0xf5916ec0||rpc.statd           ||        1605||True    ||True        ", 
        "0xf5af4f60||rpciod              ||        1610||True    ||True        ", 
        "0xf63df140||nfsiod              ||        1620||True    ||True        ", 
        "0xf591e6c0||rpc.idmapd          ||        1630||True    ||True        ", 
        "0xf7105600||dhclient            ||        1694||True    ||True        ", 
        "0xf5b87920||rsyslogd            ||        1879||True    ||True        ", 
        "0xf703ed60||rs:main Q:Reg       ||        1886||False   ||True        ", 
        "0xf59bcb00||rsyslogd            ||        1887||False   ||True        ", 
        "0xf5afcb20||rsyslogd            ||        1888||False   ||True        ", 
        "0xf7155200||atd                 ||        1981||True    ||True        ", 
        "0xf5afc2e0||cron                ||        2037||True    ||True        ", 
        "0xf5af4b40||sshd                ||        2088||True    ||True        ", 
        "0xf5af4300||acpid               ||        2201||True    ||True        ", 
        "0xf5afd360||exim4               ||        2328||True    ||True        ", 
        "0xf5805b40||login               ||        2355||True    ||True        ", 
        "0xf591ef00||getty               ||        2356||True    ||True        ", 
        "0xf703f5a0||getty               ||        2357||True    ||True        ", 
        "0xf5499100||getty               ||        2358||True    ||True        ", 
        "0xf703f180||getty               ||        2359||True    ||True        ", 
        "0xf5498080||getty               ||        2360||True    ||True        ", 
        "0xf5917b20||flush-254:0         ||        2361||True    ||True        ", 
        "0xf5836640||bash                ||        2362||True    ||True        "
    ], 
    "options": {
        "executable": "rekall ", 
        "--filename": "/home/scudette/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01", 
        "--format": "test", 
        "commandline": "psxview", 
        "test_class": "TestLinuxPsxView", 
        "--cache_dir": "/home/scudette/projects/rekall-test/linux-3.2.0-PAE/../profile_cache/", 
        "--cache": "memory", 
        "tempdir": "/tmp/tmpa_JXhA/TestLinuxPsxViewThread-1", 
        "executed_command": "rekall  -v --cache 'memory' --cache_dir '/home/scudette/projects/rekall-test/linux-3.2.0-PAE/../profile_cache/' --format 'test' --filename '/home/scudette/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01' - psxview", 
        "pids": 2362, 
        "testdir": "/home/scudette/projects/rekall-test/linux-3.2.0-PAE"
    }
}