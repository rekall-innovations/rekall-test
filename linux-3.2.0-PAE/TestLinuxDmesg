#!/bin/bash
if [ "$1" == "ok" ]; then
   cp /home/mic/projects/rekall-test/linux-3.2.0-PAE/output/TestLinuxDmesg /home/mic/projects/rekall-test/linux-3.2.0-PAE/TestLinuxDmesg
elif [ "$1" == "meld" ]; then
   meld /home/mic/projects/rekall-test/linux-3.2.0-PAE/output/TestLinuxDmesg /home/mic/projects/rekall-test/linux-3.2.0-PAE/TestLinuxDmesg
elif [ "$1" == "diff" ]; then
   diff /home/mic/projects/rekall-test/linux-3.2.0-PAE/output/TestLinuxDmesg /home/mic/projects/rekall-test/linux-3.2.0-PAE/TestLinuxDmesg
elif [ "$1" == "run" ]; then
   rekall  -v --filename '/home/mic/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01' --cache 'memory' --cache_dir '/home/mic/projects/rekall-test/linux-3.2.0-PAE/../profile_cache/' --format 'test' - dmesg
else
   less /home/mic/projects/rekall-test/linux-3.2.0-PAE/output/TestLinuxDmesg
fi
exit 0
{
    "errors": {
        "TestLinuxDmesg testCase": {}
    },
    "executed_command": "rekall  -v --filename '/home/mic/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01' --cache 'memory' --cache_dir '/home/mic/projects/rekall-test/linux-3.2.0-PAE/../profile_cache/' --format 'test' - dmesg",
    "failures": {
        "TestLinuxDmesg testCase": {
            "TestLinuxDmesg testCase": {
                "failure_info": [
                    "--- \n",
                    "+++ \n",
                    "@@ -1,7 +1,7 @@\n",
                    " timestamp    ||facility||level||                                    message",
                    " ----------------||--------||-----||--------------------------------------------------------------------------------",
                    "-2314885531.81   ||48      ||LOG_E||] Initializing cgroup subsys cpuset",
                    "-||        ||MERG ||<6>[    0.000000] Initializing cgroup subsys cpu",
                    "+2314885531.81028||48      ||LOG_E||] Initializing cgroup subsys cpuset",
                    "+1               ||        ||MERG ||<6>[    0.000000] Initializing cgroup subsys cpu",
                    " ||        ||     ||<5>[    0.000000] Linux version 3.2.0-4-686-pae (debian-kernel@lists.debian.org)",
                    " ||        ||     ||(gcc version 4.6.3 (Debian 4.6.3-14) ) #1 SMP Debian 3.2.51-1",
                    " ||        ||     ||<6>[    0.000000] BIOS-provided physical RAM map:"
                ],
                "msg": "Traceback (most recent call last):\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 302, in run\n    testMethod()\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 366, in testCase\n    self.assertListEqual(sorted(previous), sorted(current))\n  File \"/home/mic/rekall/rekall-core/rekall/testlib.py\", line 277, in assertListEqual\n    self.assertEqual(x, y)\nAssertionError: '2314885531.81   ||48      ||LOG_E||] Init[25 chars]uset' != '1               ||        ||MERG ||<6>[  [38 chars] cpu'\n- 2314885531.81   ||48      ||LOG_E||] Initializing cgroup subsys cpuset\n+ 1               ||        ||MERG ||<6>[    0.000000] Initializing cgroup subsys cpu\n\n"
            }
        }
    },
    "logging": [
        "2017-10-23 15:31:52,169:DEBUG:rekall.1:Logging level set to 10",
        "2017-10-23 15:31:52,171:DEBUG:rekall.1:Voting round with base: None",
        "2017-10-23 15:31:52,171:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ",
        "2017-10-23 15:31:52,172:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: No base address space provided",
        "2017-10-23 15:31:52,172:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ",
        "2017-10-23 15:31:52,172:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: No base address space provided",
        "2017-10-23 15:31:52,172:DEBUG:rekall.1:Trying <class 'rekall.plugins.response.common.APIDummyPhysicalAddressSpace'> ",
        "2017-10-23 15:31:52,172:DEBUG:rekall.1:Failed instantiating APIDummyPhysicalAddressSpace: Instantiation failed for unspecified reason",
        "2017-10-23 15:31:52,172:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ",
        "2017-10-23 15:31:52,172:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Must stack on another address space",
        "2017-10-23 15:31:52,172:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ",
        "2017-10-23 15:31:52,173:DEBUG:rekall.1:Failed instantiating EWFAddressSpace: No base address space provided",
        "2017-10-23 15:31:52,173:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ",
        "2017-10-23 15:31:52,173:DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Must stack on another address space",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Must stack on another address space",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: No base address space provided",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: No base address space provided",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Must stack on another address space",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Must be layered on another address space.",
        "2017-10-23 15:31:52,174:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ",
        "2017-10-23 15:31:52,176:DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Unable to open AFF4 volume: No physical memory categories found.",
        "2017-10-23 15:31:52,176:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ",
        "2017-10-23 15:31:52,177:DEBUG:rekall.1:Succeeded instantiating FileAddressSpace",
        "2017-10-23 15:31:52,177:DEBUG:rekall.1:Voting round with base: FileAddressSpace",
        "2017-10-23 15:31:52,177:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ",
        "2017-10-23 15:31:52,180:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0x9465645",
        "2017-10-23 15:31:52,180:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ",
        "2017-10-23 15:31:52,180:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.",
        "2017-10-23 15:31:52,180:DEBUG:rekall.1:Trying <class 'rekall.plugins.response.common.APIDummyPhysicalAddressSpace'> ",
        "2017-10-23 15:31:52,180:DEBUG:rekall.1:Failed instantiating APIDummyPhysicalAddressSpace: Instantiation failed for unspecified reason",
        "2017-10-23 15:31:52,180:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ",
        "2017-10-23 15:31:52,180:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid",
        "2017-10-23 15:31:52,180:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ",
        "2017-10-23 15:31:52,190:DEBUG:rekall.1:Succeeded instantiating EWFAddressSpace",
        "2017-10-23 15:31:52,190:DEBUG:rekall.1:Voting round with base: EWFAddressSpace",
        "2017-10-23 15:31:52,190:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMSSAddressSpace'> ",
        "2017-10-23 15:31:52,192:DEBUG:rekall.1:Failed instantiating VMSSAddressSpace: Invalid VMware signature: 0x0",
        "2017-10-23 15:31:52,192:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.vmem.VMemAddressSpace'> ",
        "2017-10-23 15:31:52,192:DEBUG:rekall.1:Failed instantiating VMemAddressSpace: Only VMEM files supported.",
        "2017-10-23 15:31:52,192:DEBUG:rekall.1:Trying <class 'rekall.plugins.response.common.APIDummyPhysicalAddressSpace'> ",
        "2017-10-23 15:31:52,192:DEBUG:rekall.1:Failed instantiating APIDummyPhysicalAddressSpace: Instantiation failed for unspecified reason",
        "2017-10-23 15:31:52,192:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.macho.MACHOCoreDump'> ",
        "2017-10-23 15:31:52,192:DEBUG:rekall.1:Failed instantiating MACHOCoreDump: Header signature invalid",
        "2017-10-23 15:31:52,193:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.ewf.EWFAddressSpace'> ",
        "2017-10-23 15:31:52,193:DEBUG:rekall.1:Failed instantiating EWFAddressSpace: EWF signature not present",
        "2017-10-23 15:31:52,193:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashBMP'> ",
        "2017-10-23 15:31:52,193:DEBUG:rekall.1:Failed instantiating WindowsCrashBMP: Header signature invalid",
        "2017-10-23 15:31:52,193:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.KCoreAddressSpace'> ",
        "2017-10-23 15:31:52,193:DEBUG:rekall.1:Failed instantiating KCoreAddressSpace: Header signature invalid",
        "2017-10-23 15:31:52,193:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace32'> ",
        "2017-10-23 15:31:52,193:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace32: Header signature invalid",
        "2017-10-23 15:31:52,193:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.crash.WindowsCrashDumpSpace64'> ",
        "2017-10-23 15:31:52,194:DEBUG:rekall.1:Failed instantiating WindowsCrashDumpSpace64: Header signature invalid",
        "2017-10-23 15:31:52,194:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.elfcore.Elf64CoreDump'> ",
        "2017-10-23 15:31:52,194:DEBUG:rekall.1:Failed instantiating Elf64CoreDump: Header signature invalid",
        "2017-10-23 15:31:52,194:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.lime.LimeAddressSpace'> ",
        "2017-10-23 15:31:52,194:DEBUG:rekall.1:Failed instantiating LimeAddressSpace: Invalid Lime header signature",
        "2017-10-23 15:31:52,194:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.aff4.AFF4AddressSpace'> ",
        "2017-10-23 15:31:52,253:DEBUG:rekall.1:Failed instantiating AFF4AddressSpace: Must stack on another address space",
        "2017-10-23 15:31:52,253:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.FileAddressSpace'> ",
        "2017-10-23 15:31:52,253:DEBUG:rekall.1:Failed instantiating FileAddressSpace: Must be first Address Space",
        "2017-10-23 15:31:52,253:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.amd64.VTxPagedMemory'> ",
        "2017-10-23 15:31:52,254:DEBUG:rekall.1:Failed instantiating VTxPagedMemory: No more EPTs specified",
        "2017-10-23 15:31:52,254:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.mmap_address_space.MmapFileAddressSpace'> ",
        "2017-10-23 15:31:52,254:DEBUG:rekall.1:Failed instantiating MmapFileAddressSpace: Must be first Address Space",
        "2017-10-23 15:31:52,254:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.standard.GlobalOffsetAddressSpace'> ",
        "2017-10-23 15:31:52,254:DEBUG:rekall.1:Failed instantiating GlobalOffsetAddressSpace: File offset not specified.",
        "2017-10-23 15:31:52,254:DEBUG:rekall.1:Trying <class 'rekall.plugins.addrspaces.pagefile.PagefilePhysicalAddressSpace'> ",
        "2017-10-23 15:31:52,255:DEBUG:rekall.1:Failed instantiating PagefilePhysicalAddressSpace: Pagefile not specified",
        "2017-10-23 15:31:52,255:INFO:rekall.1:Autodetected physical address space EWFAddressSpace",
        "2017-10-23 15:31:52,255:DEBUG:rekall.1:Will detect profile using these Detectors: rsds,linux_index,windows_kernel_file,nt_index,linux,pe,osx,ntfs,tsk",
        "2017-10-23 15:31:52,414:DEBUG:rekall.1:Opened url https://github.com/google/rekall-profiles/raw/master/v1.0/inventory.gz",
        "2017-10-23 15:31:52,509:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/inventory.gz",
        "2017-10-23 15:31:52,538:DEBUG:rekall.1:Opened url http://profiles.rekall-forensic.com/v1.0/inventory.gz",
        "2017-10-23 15:31:52,605:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/inventory.gz",
        "2017-10-23 15:31:52,606:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/pe.gz",
        "2017-10-23 15:31:52,615:INFO:rekall.1:Loaded profile pe from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.008991718292236328 sec)",
        "2017-10-23 15:31:52,615:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/Linux/index.gz",
        "2017-10-23 15:31:52,624:INFO:rekall.1:Loaded profile Linux/index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.009231090545654297 sec)",
        "2017-10-23 15:31:52,625:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/nt/eprocess_index.gz",
        "2017-10-23 15:31:52,643:INFO:rekall.1:Loaded profile nt/eprocess_index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.01842474937438965 sec)",
        "2017-10-23 15:31:52,644:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/nt/index.gz",
        "2017-10-23 15:31:52,768:INFO:rekall.1:Loaded profile nt/index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.1248786449432373 sec)",
        "2017-10-23 15:31:52,769:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/OSX/index.gz",
        "2017-10-23 15:31:52,770:INFO:rekall.1:Loaded profile OSX/index from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.0008070468902587891 sec)",
        "2017-10-23 15:31:52,770:DEBUG:rekall.1:Trying method windows_kernel_file, offset 0",
        "2017-10-23 15:31:52,770:DEBUG:rekall.1:Trying method pe, offset 0",
        "2017-10-23 15:31:52,772:DEBUG:rekall.1:Trying method rsds, offset 0",
        "2017-10-23 15:31:52,773:DEBUG:rekall.1:Trying method linux_index, offset 0",
        "2017-10-23 15:31:52,773:DEBUG:rekall.1:LinuxIndexDetector:DetectFromHit(0) = None",
        "2017-10-23 15:31:52,773:DEBUG:rekall.1:Trying method nt_index, offset 0",
        "2017-10-23 15:31:52,773:DEBUG:rekall.1:Trying method ntfs, offset 0",
        "2017-10-23 15:31:52,773:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/ntfs.gz",
        "2017-10-23 15:31:52,775:INFO:rekall.1:Loaded profile ntfs from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.0015156269073486328 sec)",
        "2017-10-23 15:31:52,779:DEBUG:rekall.1:Trying method tsk, offset 0",
        "2017-10-23 15:31:54,348:DEBUG:rekall.1:Opened local file /home/mic/projects/rekall-test/profile_cache/v1.0/Debian/3.2.0-4-686-pae.gz",
        "2017-10-23 15:31:54,817:INFO:rekall.1:Loaded profile Debian/3.2.0-4-686-pae from Local Cache Directory:/home/mic/projects/rekall-test/profile_cache (in 0.46927833557128906 sec)",
        "2017-10-23 15:31:54,817:INFO:rekall.1:Detected Debian/3.2.0-4-686-pae: b'Linux version 3.2.0-4-686-pae'",
        "2017-10-23 15:31:54,818:DEBUG:rekall.1:Calculating page offset...",
        "2017-10-23 15:31:54,819:DEBUG:rekall.1:Page offset is c0000000",
        "2017-10-23 15:31:54,819:INFO:rekall.1:Found slide 0x0",
        "2017-10-23 15:31:54,820:DEBUG:rekall.1:Detection method linux worked at offset 0x12cb06c",
        "2017-10-23 15:31:54,823:DEBUG:rekall.1:Running plugin (dmesg) with args (()) kwargs ({'verbosity': 1, 'profile': None})"
    ],
    "options": {
        "--cache": "memory",
        "--cache_dir": "/home/mic/projects/rekall-test/linux-3.2.0-PAE/../profile_cache/",
        "--filename": "/home/mic/projects/rekall-test/linux-3.2.0-PAE/Linux-3.2.0-4-686-pae.E01",
        "--format": "test",
        "commandline": "dmesg",
        "debug": false,
        "executable": "rekall ",
        "pids": 2362,
        "tempdir": "/tmp/tmpsvuz76ag/TestLinuxDmesgThread-1",
        "test_class": "TestLinuxDmesg",
        "testdir": "/home/mic/projects/rekall-test/linux-3.2.0-PAE"
    },
    "output": [
        "   timestamp    ||facility||level||                                    message                                     ",
        "----------------||--------||-----||--------------------------------------------------------------------------------",
        "2314885531.81028||48      ||LOG_E||] Initializing cgroup subsys cpuset                                             ",
        "1               ||        ||MERG ||<6>[    0.000000] Initializing cgroup subsys cpu                                ",
        "                ||        ||     ||<5>[    0.000000] Linux version 3.2.0-4-686-pae (debian-kernel@lists.debian.org)",
        "                ||        ||     ||(gcc version 4.6.3 (Debian 4.6.3-14) ) #1 SMP Debian 3.2.51-1                   ",
        "                ||        ||     ||<6>[    0.000000] BIOS-provided physical RAM map:                               ",
        "                ||        ||     ||<6>[    0.000000]  BIOS-e820: 0000000000000000 - 000000000009fc00 (usable)      ",
        "                ||        ||     ||<6>[    0.000000]  BIOS-e820: 000000000009fc00 - 00000000000a0000 (reserved)    ",
        "                ||        ||     ||<6>[    0.000000]  BIOS-e820: 00000000000f0000 - 0000000000100000 (reserved)    ",
        "                ||        ||     ||<6>[    0.000000]  BIOS-e820: 0000000000100000 - 000000003fffe000 (usable)      ",
        "                ||        ||     ||<6>[    0.000000]  BIOS-e820: 000000003fffe000 - 0000000040000000 (reserved)    ",
        "                ||        ||     ||<6>[    0.000000]  BIOS-e820: 00000000feffc000 - 00000000ff000000 (reserved)    ",
        "                ||        ||     ||<6>[    0.000000]  BIOS-e820: 00000000fffc0000 - 0000000100000000 (reserved)    ",
        "                ||        ||     ||<5>[    0.000000] Notice: NX (Execute Disable) protection missing in CPU!       ",
        "                ||        ||     ||<6>[    0.000000] SMBIOS 2.4 present.                                           ",
        "                ||        ||     ||<7>[    0.000000] DMI: Bochs Bochs, BIOS Bochs 01/01/2011                       ",
        "                ||        ||     ||<7>[    0.000000] e820 update range: 0000000000000000 - 0000000000010000        ",
        "                ||        ||     ||(usable) ==> (reserved)                                                         ",
        "                ||        ||     ||<7>[    0.000000] e820 remove range: 00000000000a0000 - 0000000000100000        ",
        "                ||        ||     ||(usable)                                                                        ",
        "                ||        ||     ||<6>[    0.000000]                                                               "
    ],
    "return_code": 0,
    "time_used": 5.748286962509155
}